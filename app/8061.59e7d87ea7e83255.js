"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8061],{8061(Tt,F,h){h.d(F,{RestorationPageModule:()=>Et});var M=h(2200),v=h(4341),m=h(7343),O=h(8132),p=h(467),w=h(152),j=h(4718),y=h(5083),R=h(5415),t=h(3664),g=h(2615),k=h(5921),S=h(3205),N=h(6358),E=h(918),T=h(9187),I=h(7643);const D=()=>({standalone:!0});function G(i,s){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const r=t.XpG();t.R7$(),t.SpI(" (edited: ",r.getEditedDateTime(),")")}}function $(i,s){1&i&&t.nrm(0,"ion-icon",45)}function z(i,s){if(1&i){const r=t.RV6();t.j41(0,"div",8),t.bIt("click",function(){g.eBV(r);const n=t.XpG();return g.Njj(!n.viewMode&&n.editZone())}),t.nrm(1,"ion-icon",46),t.j41(2,"span",10),t.EFF(3),t.k0s()()}if(2&i){let r;const e=t.XpG();t.R7$(3),t.JRh(e.getZoneName(null==(r=e.restorationForm.get("zoneNumber"))?null:r.value))}}function A(i,s){if(1&i){const r=t.RV6();t.j41(0,"div",8),t.bIt("click",function(){g.eBV(r);const n=t.XpG();return g.Njj(!n.viewMode&&n.editQuad())}),t.nrm(1,"ion-icon",47),t.j41(2,"span",10),t.EFF(3),t.k0s()()}if(2&i){let r;const e=t.XpG();t.R7$(3),t.SpI("Quad ",e.getQuadDisplay(null==(r=e.restorationForm.get("quadNumber"))?null:r.value))}}function V(i,s){if(1&i){const r=t.RV6();t.j41(0,"span",48),t.bIt("click",function(){g.eBV(r);const n=t.XpG();return g.Njj(n.editLocationAdmin())}),t.EFF(1," Edit location "),t.k0s()}}function X(i,s){1&i&&(t.j41(0,"ion-error",49),t.EFF(1," Site is required "),t.k0s())}function Y(i,s){if(1&i){const r=t.RV6();t.j41(0,"div",50)(1,"ion-button",51),t.bIt("click",function(){g.eBV(r);const n=t.XpG();return g.Njj(n.enableEditMode())}),t.nrm(2,"ion-icon",52),t.EFF(3," Edit This Entry "),t.k0s()()}}function q(i,s){1&i&&(t.j41(0,"div",53),t.nrm(1,"ion-icon",54),t.j41(2,"span"),t.EFF(3,"Editing Entry - Changes will replace the original submission"),t.k0s()())}function B(i,s){if(1&i&&(t.j41(0,"ion-card-subtitle"),t.EFF(1),t.k0s()),2&i){const r=t.XpG(2);t.R7$(),t.SpI(" Check-in #",r.currentSequenceNumber," for ongoing project ")}}function U(i,s){1&i&&(t.j41(0,"ion-note",64),t.nrm(1,"ion-icon",65),t.EFF(2," Restoration activity will be marked as closed and removed from the active restoration monitoring list. "),t.k0s())}function H(i,s){if(1&i){const r=t.RV6();t.j41(0,"ion-card",55)(1,"ion-card-header")(2,"ion-card-title"),t.EFF(3,"Project Status"),t.k0s(),t.DNE(4,B,2,1,"ion-card-subtitle",5),t.k0s(),t.j41(5,"ion-card-content")(6,"ion-item",20),t.nrm(7,"ion-icon",56),t.j41(8,"ion-label",57)(9,"h3",58),t.EFF(10,"Keep monitoring activity ongoing"),t.k0s(),t.j41(11,"p"),t.EFF(12,"Allow future check-ins for the restoration of this specific location."),t.k0s(),t.j41(13,"p",59),t.EFF(14,"(Toggle off to close monitoring activity for this specific location.)"),t.k0s()(),t.j41(15,"div",60)(16,"strong",61),t.EFF(17),t.k0s(),t.j41(18,"ion-toggle",62),t.mxI("ngModelChange",function(n){g.eBV(r);const o=t.XpG();return t.DH7(o.isProjectOngoing,n)||(o.isProjectOngoing=n),g.Njj(n)}),t.k0s()()(),t.DNE(19,U,3,0,"ion-note",63),t.k0s()()}if(2&i){const r=t.XpG();t.R7$(4),t.Y8G("ngIf",r.isUpdatingProject),t.R7$(12),t.xc7("color",r.isProjectOngoing?"#2d8659":"#e76f51"),t.R7$(),t.SpI(" ",r.isProjectOngoing?"Ongoing":"Closed"," "),t.R7$(),t.R50("ngModel",r.isProjectOngoing),t.Y8G("ngModelOptions",t.lJ4(7,D)),t.R7$(),t.Y8G("ngIf",!r.isProjectOngoing)}}function Q(i,s){if(1&i&&(t.j41(0,"div",73)(1,"span",74),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",75),t.EFF(4),t.k0s()()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(4),t.JRh(e.lastReportData.seedCollection[r]||0)}}function J(i,s){if(1&i){const r=t.RV6();t.j41(0,"ion-button",76),t.bIt("click",function(){g.eBV(r);const n=t.XpG().index,o=t.XpG();return g.Njj(o.decrementValue("seedCollection",n))}),t.nrm(1,"ion-icon",77),t.k0s()}}function Z(i,s){if(1&i&&t.nrm(0,"input",78),2&i){const r=t.XpG().index;t.Y8G("formControlName",r)}}function L(i,s){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(),t.JRh(e.seedCollection.at(r).value)}}function W(i,s){if(1&i){const r=t.RV6();t.j41(0,"ion-button",76),t.bIt("click",function(){g.eBV(r);const n=t.XpG().index,o=t.XpG();return g.Njj(o.incrementValue("seedCollection",n))}),t.nrm(1,"ion-icon",79),t.k0s()}}function K(i,s){if(1&i){const r=t.RV6();t.j41(0,"div",66)(1,"ion-item")(2,"div",67)(3,"ion-label")(4,"h3"),t.EFF(5),t.k0s(),t.j41(6,"p")(7,"em"),t.EFF(8),t.k0s()()(),t.j41(9,"ion-icon",68),t.bIt("click",function(n){const o=g.eBV(r).$implicit,a=t.XpG();return g.Njj(a.showMangroveInfo(n,o))}),t.k0s()(),t.j41(10,"div",69),t.DNE(11,Q,5,1,"div",29),t.j41(12,"div",70),t.DNE(13,J,2,0,"ion-button",71)(14,Z,1,1,"input",72)(15,L,2,1,"span",5)(16,W,2,0,"ion-button",71),t.k0s()()()()}if(2&i){const r=s.$implicit,e=t.XpG();t.R7$(5),t.JRh(r.scientificName),t.R7$(3),t.JRh(r.commonName),t.R7$(3),t.Y8G("ngIf",e.isUpdatingProject&&e.lastReportData),t.R7$(2),t.Y8G("ngIf",!e.viewMode),t.R7$(),t.Y8G("ngIf",!e.viewMode),t.R7$(),t.Y8G("ngIf",e.viewMode),t.R7$(),t.Y8G("ngIf",!e.viewMode)}}function tt(i,s){if(1&i&&(t.j41(0,"div",73)(1,"span",74),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",75),t.EFF(4),t.k0s()()),2&i){const r=t.XpG();t.R7$(4),t.JRh(r.lastSeedCollectionTotal)}}function et(i,s){if(1&i&&(t.j41(0,"div",73)(1,"span",74),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",75),t.EFF(4),t.k0s()()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(4),t.JRh(e.lastReportData.seedsSowed[r]||0)}}function nt(i,s){if(1&i){const r=t.RV6();t.j41(0,"ion-button",76),t.bIt("click",function(){g.eBV(r);const n=t.XpG().index,o=t.XpG();return g.Njj(o.decrementValue("seedsSowed",n))}),t.nrm(1,"ion-icon",77),t.k0s()}}function ot(i,s){if(1&i&&t.nrm(0,"input",78),2&i){const r=t.XpG().index;t.Y8G("formControlName",r)}}function it(i,s){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(),t.JRh(e.seedsSowed.at(r).value)}}function rt(i,s){if(1&i){const r=t.RV6();t.j41(0,"ion-button",76),t.bIt("click",function(){g.eBV(r);const n=t.XpG().index,o=t.XpG();return g.Njj(o.incrementValue("seedsSowed",n))}),t.nrm(1,"ion-icon",79),t.k0s()}}function at(i,s){if(1&i&&(t.j41(0,"div",66)(1,"ion-item")(2,"div",67)(3,"ion-label")(4,"h3"),t.EFF(5),t.k0s(),t.j41(6,"p")(7,"em"),t.EFF(8),t.k0s()()()(),t.j41(9,"div",69),t.DNE(10,et,5,1,"div",29),t.j41(11,"div",70),t.DNE(12,nt,2,0,"ion-button",71)(13,ot,1,1,"input",72)(14,it,2,1,"span",5)(15,rt,2,0,"ion-button",71),t.k0s()()()()),2&i){const r=s.$implicit,e=t.XpG();t.R7$(5),t.JRh(r.scientificName),t.R7$(3),t.JRh(r.commonName),t.R7$(2),t.Y8G("ngIf",e.isUpdatingProject&&e.lastReportData),t.R7$(2),t.Y8G("ngIf",!e.viewMode),t.R7$(),t.Y8G("ngIf",!e.viewMode),t.R7$(),t.Y8G("ngIf",e.viewMode),t.R7$(),t.Y8G("ngIf",!e.viewMode)}}function st(i,s){if(1&i&&(t.j41(0,"div",73)(1,"span",74),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",75),t.EFF(4),t.k0s()()),2&i){const r=t.XpG();t.R7$(4),t.JRh(r.lastSeedsSowedTotal)}}function ct(i,s){if(1&i&&(t.j41(0,"div",73)(1,"span",74),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",75),t.EFF(4),t.k0s()()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(4),t.SpI("",e.lastReportData.averageHeight[r]||0," cm")}}function lt(i,s){if(1&i){const r=t.RV6();t.j41(0,"div",66)(1,"ion-item")(2,"div",67)(3,"ion-label")(4,"h3"),t.EFF(5),t.k0s(),t.j41(6,"p")(7,"em"),t.EFF(8),t.k0s()()(),t.j41(9,"ion-icon",68),t.bIt("click",function(n){const o=g.eBV(r).$implicit,a=t.XpG();return g.Njj(a.showMangroveInfo(n,o))}),t.k0s()(),t.j41(10,"div",80),t.DNE(11,ct,5,1,"div",29),t.j41(12,"ion-input",81),t.bIt("ionChange",function(){const n=g.eBV(r).index,o=t.XpG();return g.Njj(o.onHeightChange(n))}),t.j41(13,"span",36),t.EFF(14,"cm"),t.k0s()()()()()}if(2&i){const r=s.$implicit,e=s.index,n=t.XpG();t.R7$(5),t.JRh(r.scientificName),t.R7$(3),t.JRh(r.commonName),t.R7$(3),t.Y8G("ngIf",n.isUpdatingProject&&n.lastReportData),t.R7$(),t.Y8G("formControl",n.averageHeight.at(e))("readonly",n.viewMode)}}function dt(i,s){if(1&i&&(t.j41(0,"div",73)(1,"span",74),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",75),t.EFF(4),t.k0s()()),2&i){const r=t.XpG();t.R7$(4),t.SpI("",r.lastAverageHeightOverall," cm")}}function gt(i,s){if(1&i&&(t.j41(0,"div",73)(1,"span",74),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",75),t.EFF(4),t.k0s()()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(4),t.JRh(e.lastReportData.mortality[r]||0)}}function ut(i,s){if(1&i){const r=t.RV6();t.j41(0,"ion-button",76),t.bIt("click",function(){g.eBV(r);const n=t.XpG().index,o=t.XpG();return g.Njj(o.decrementValue("mortality",n))}),t.nrm(1,"ion-icon",77),t.k0s()}}function mt(i,s){if(1&i&&t.nrm(0,"input",78),2&i){const r=t.XpG().index;t.Y8G("formControlName",r)}}function pt(i,s){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(),t.JRh(e.mortality.at(r).value)}}function ft(i,s){if(1&i){const r=t.RV6();t.j41(0,"ion-button",76),t.bIt("click",function(){g.eBV(r);const n=t.XpG().index,o=t.XpG();return g.Njj(o.incrementValue("mortality",n))}),t.nrm(1,"ion-icon",79),t.k0s()}}function _t(i,s){if(1&i&&(t.j41(0,"div",66)(1,"ion-item")(2,"div",67)(3,"ion-label")(4,"h3"),t.EFF(5),t.k0s(),t.j41(6,"p")(7,"em"),t.EFF(8),t.k0s()()()(),t.j41(9,"div",69),t.DNE(10,gt,5,1,"div",29),t.j41(11,"div",70),t.DNE(12,ut,2,0,"ion-button",71)(13,mt,1,1,"input",72)(14,pt,2,1,"span",5)(15,ft,2,0,"ion-button",71),t.k0s()()()()),2&i){const r=s.$implicit,e=t.XpG();t.R7$(5),t.JRh(r.scientificName),t.R7$(3),t.JRh(r.commonName),t.R7$(2),t.Y8G("ngIf",e.isUpdatingProject&&e.lastReportData),t.R7$(2),t.Y8G("ngIf",!e.viewMode),t.R7$(),t.Y8G("ngIf",!e.viewMode),t.R7$(),t.Y8G("ngIf",e.viewMode),t.R7$(),t.Y8G("ngIf",!e.viewMode)}}function ht(i,s){if(1&i&&(t.j41(0,"div",73)(1,"span",74),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",75),t.EFF(4),t.k0s()()),2&i){const r=t.XpG();t.R7$(4),t.JRh(r.lastMortalityTotal)}}function vt(i,s){if(1&i&&(t.j41(0,"div",73)(1,"span",74),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",75),t.EFF(4),t.k0s()()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(4),t.JRh(e.lastReportData.outplanting[r]||0)}}function bt(i,s){if(1&i){const r=t.RV6();t.j41(0,"ion-button",76),t.bIt("click",function(){g.eBV(r);const n=t.XpG().index,o=t.XpG();return g.Njj(o.decrementValue("outplanting",n))}),t.nrm(1,"ion-icon",77),t.k0s()}}function Pt(i,s){if(1&i&&t.nrm(0,"input",78),2&i){const r=t.XpG().index;t.Y8G("formControlName",r)}}function Ct(i,s){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(),t.JRh(e.outplanting.at(r).value)}}function Mt(i,s){if(1&i){const r=t.RV6();t.j41(0,"ion-button",76),t.bIt("click",function(){g.eBV(r);const n=t.XpG().index,o=t.XpG();return g.Njj(o.incrementValue("outplanting",n))}),t.nrm(1,"ion-icon",79),t.k0s()}}function xt(i,s){if(1&i&&(t.j41(0,"div",66)(1,"ion-item")(2,"div",67)(3,"ion-label")(4,"h3"),t.EFF(5),t.k0s(),t.j41(6,"p")(7,"em"),t.EFF(8),t.k0s()()()(),t.j41(9,"div",69),t.DNE(10,vt,5,1,"div",29),t.j41(11,"div",70),t.DNE(12,bt,2,0,"ion-button",71)(13,Pt,1,1,"input",72)(14,Ct,2,1,"span",5)(15,Mt,2,0,"ion-button",71),t.k0s()()()()),2&i){const r=s.$implicit,e=t.XpG();t.R7$(5),t.JRh(r.scientificName),t.R7$(3),t.JRh(r.commonName),t.R7$(2),t.Y8G("ngIf",e.isUpdatingProject&&e.lastReportData),t.R7$(2),t.Y8G("ngIf",!e.viewMode),t.R7$(),t.Y8G("ngIf",!e.viewMode),t.R7$(),t.Y8G("ngIf",e.viewMode),t.R7$(),t.Y8G("ngIf",!e.viewMode)}}function Ot(i,s){if(1&i&&(t.j41(0,"div",73)(1,"span",74),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",75),t.EFF(4),t.k0s()()),2&i){const r=t.XpG();t.R7$(4),t.JRh(r.lastOutplantingTotal)}}function yt(i,s){if(1&i){const r=t.RV6();t.j41(0,"div",82)(1,"ion-button",83),t.nrm(2,"ion-icon",84),t.EFF(3," Submit Restoration Monitoring "),t.k0s(),t.j41(4,"ion-button",85),t.bIt("click",function(){g.eBV(r);const n=t.XpG();return g.Njj(n.saveDraft())}),t.nrm(5,"ion-icon",86),t.EFF(6," Save Draft "),t.k0s(),t.j41(7,"ion-button",87),t.bIt("click",function(){g.eBV(r);const n=t.XpG();return g.Njj(n.discardForm())}),t.nrm(8,"ion-icon",88),t.EFF(9," Discard "),t.k0s()()}if(2&i){const r=t.XpG();t.R7$(),t.Y8G("disabled",!r.restorationForm.valid)}}function Rt(i,s){if(1&i){const r=t.RV6();t.j41(0,"div",89)(1,"ion-button",90),t.bIt("click",function(){g.eBV(r);const n=t.XpG();return g.Njj(n.deleteEntry())}),t.nrm(2,"ion-icon",88),t.EFF(3," Delete Entry "),t.k0s()()}}function kt(i,s){if(1&i){const r=t.RV6();t.j41(0,"span",17),t.bIt("click",function(){const n=g.eBV(r).index,o=t.XpG(2);return g.Njj(o.goTo(n))}),t.k0s()}if(2&i){const r=s.index,e=t.XpG(2);t.AVh("active",r===e.currentIndex)}}function Ft(i,s){if(1&i){const r=t.RV6();t.j41(0,"div",11)(1,"button",12),t.bIt("click",function(){g.eBV(r);const n=t.XpG();return g.Njj(n.previous())}),t.nrm(2,"ion-icon",13),t.k0s(),t.j41(3,"div",14),t.DNE(4,kt,1,2,"span",15),t.k0s(),t.j41(5,"button",12),t.bIt("click",function(){g.eBV(r);const n=t.XpG();return g.Njj(n.next())}),t.nrm(6,"ion-icon",16),t.k0s()()}if(2&i){const r=t.XpG();t.R7$(4),t.Y8G("ngForOf",r.getImages())}}let wt=(()=>{var i;class s{forceDeleteDraftFile(e){var n=this;return(0,p.A)(function*(){for(let o=0;o<3;o++)try{yield n.sharedDataService.deleteJsonFile(e),console.log(`Draft file force deleted successfully (attempt ${o+1})`);break}catch(a){if(console.error(`Error force deleting draft file (attempt ${o+1}):`,a),2===o)try{yield n.sharedDataService.writeJsonFile(e,null),console.log("Draft file cleared with null write")}catch(c){console.error("Failed to clear draft file with null write:",c)}yield new Promise(c=>setTimeout(c,100))}})()}constructor(e,n,o,a,c,l,u,d,f,_,b){this.formBuilder=e,this.alertController=n,this.loadingController=o,this.router=a,this.route=c,this.modalController=l,this.auth=u,this.restorationSyncService=d,this.sharedDataService=f,this.entryDeletionService=_,this.siteSyncService=b,this.progress=0,this.restorationPhoto=null,this.currentDateTime="",this.viewMode=!1,this.currentUser=null,this.currentReportId="",this.loadedReport=null,this.autosaveSub=null,this.isDiscarded=!1,this.isSubmitted=!1,this.isSubmitting=!1,this.isEditMode=!1,this.originalSubmittedBy="",this.isProjectOngoing=!0,this.isUpdatingProject=!1,this.currentProjectKey=null,this.currentSequenceNumber=1,this.parentReportId=null,this.lastReportData=null,this.mangroveSpecies=[{scientificName:"Mangliye Rouz",commonName:"Red Mangrove",latinName:"Rhizophora mucronata",imagePath:["assets/mangroves/Red-Man.webp","assets/mangroves/Red mangrove1.webp","assets/mangroves/Red mangrove2.webp"]},{scientificName:"Mangliye Blan",commonName:"White Mangrove",latinName:"Avicennia marina",imagePath:["assets/mangroves/White-Man.webp","assets/mangroves/White mangrove1.webp","assets/mangroves/White mangrove2.webp"]},{scientificName:"Mangliye Zonn",commonName:"Yellow Mangrove",latinName:"Ceriops tagal",imagePath:["assets/mangroves/Yellow-Man.webp","assets/mangroves/Yellow mangrove1.webp","assets/mangroves/Yellow mangrove2.webp"]},{scientificName:"Mangliye Pti Fey",commonName:"Black Mangrove",latinName:"Lumnitzera racemosa",imagePath:["assets/mangroves/Black-Man.webp","assets/mangroves/Black mangrove.webp"]},{scientificName:"Mangliye Lat",commonName:"Oriental Mangrove",latinName:"Bruguiera gymnorrhiza",imagePath:["assets/mangroves/Oriental-Man.webp","assets/mangroves/Oriental mangrove1.webp","assets/mangroves/Oriental mangrove2.webp"]},{scientificName:"Mangliye Fler",commonName:"Apple Mangrove",latinName:"Sonneratia alba",imagePath:["assets/mangroves/Apple-Man.webp","assets/mangroves/Apple mangrove.webp"]},{scientificName:"Mangliye Pasyans",commonName:"Puzzlenut Mangrove",latinName:"Xylocarpus granatum",imagePath:["assets/mangroves/Puzzlenut-Man.webp","assets/mangroves/Puzzlenut mangrove.webp"]}],this.availableLocations=[{name:"Ramsar",hasZones:!0,hasQuads:!0,zones:["1","2","3","4","5","6"],quads:Array.from({length:30},(P,C)=>`quad${C+1}`),zoneQuadMap:{1:[1,2,3],2:[13,14,15,16,17,18,20,21,22,23,25,27,28,29],3:[19,26],4:[4,5],5:[6,7,11,12,24,30],6:[8,9,10]}},{name:"Grand Anse",hasZones:!0,hasQuads:!0,zones:["1","2","3","4"],quads:Array.from({length:22},(P,C)=>`ga${C+1}`),zoneQuadMap:{1:[1,2,3,4],2:[5,6,7,8,9,10,21,22],3:[11,12,13,14,15,16,17,18],4:[19,20]}},{name:"Caiman",hasZones:!1,hasQuads:!0,zones:[],quads:["quad1","quad2","quad3","quad4","quad5"]},{name:"Canopy",hasZones:!1,hasQuads:!0,zones:[],quads:["quad1","quad2","quad3","quad4"]},{name:"Petit Barbarons",hasZones:!0,hasQuads:!1,zones:["1","2","3","4"],quads:[]},{name:"Kempinski",hasZones:!1,hasQuads:!1,zones:[],quads:[]},{name:"Roche Caiman",hasZones:!1,hasQuads:!1,zones:[],quads:[]}]}ngOnInit(){var e=this;return(0,p.A)(function*(){e.currentUser=e.auth.getCurrentUser(),e.initializeForm(),e.setCurrentDateTime(),yield e.loadDynamicSites();const n=e.route.snapshot.queryParams;if("true"!==n.viewMode||!n.reportId)return"true"===n.editMode&&n.reportId?(yield e.loadReportForViewing(n.reportId),void e.enableEditMode()):(n.projectKey&&(yield e.loadProjectForContinuation(n.projectKey),e.isUpdatingProject=!0),e.route.queryParams.subscribe(o=>{o.location&&e.restorationForm.patchValue({site:o.location}),o.zone&&e.restorationForm.patchValue({zoneNumber:o.zone}),o.quad&&e.restorationForm.patchValue({quadNumber:o.quad})}),"true"!==n.fresh&&(yield e.restoreDraftIfAny(),e.setCurrentDateTime()),e.currentReportId||(e.currentReportId=e.restorationSyncService.generateReportId()),e.subscribeToFormChanges(),void(navigator.onLine&&e.restorationSyncService.processPendingQueue().catch(o=>{console.error("RestorationPage: processPendingQueue failed:",o)})));yield e.loadReportForViewing(n.reportId)})()}ngOnDestroy(){this.autosaveSub&&(this.autosaveSub.unsubscribe(),this.autosaveSub=null),this.isSubmitted||this.saveDraftOnExit().catch(e=>console.error("RestorationPage: saveDraftOnExit failed:",e))}setCurrentDateTime(e){if(this.restorationForm){const d=this.restorationForm.get("date")?.value,f=this.restorationForm.get("observationTime")?.value;if(d&&f){const[_,b,P]=d.split("-"),[C,x]=f.split(":");return void(this.currentDateTime=`${P}/${b}/${_}  \u2022  ${C}:${x}`)}}if(e){const d=this.extractDateTimeFromReportId(e);if(d)return void(this.currentDateTime=d)}const n=new Date,o=String(n.getDate()).padStart(2,"0"),a=String(n.getMonth()+1).padStart(2,"0"),c=n.getFullYear(),l=String(n.getHours()).padStart(2,"0"),u=String(n.getMinutes()).padStart(2,"0");this.currentDateTime=`${o}/${a}/${c}  \u2022  ${l}:${u}`}extractDateTimeFromReportId(e){const n=e.match(/(\d{2})(\d{2})(\d{4})_(\d{2})(\d{2})(\d{2})/);if(n){const[,o,a,c,l,u]=n;return`${o}/${a}/${c}  \u2022  ${l}:${u}`}return null}getCurrentDate(){return(new Date).toISOString().split("T")[0]}editSite(){var e=this;return(0,p.A)(function*(){yield(yield e.alertController.create({header:"Site Location",inputs:[{name:"site",type:"text",placeholder:"Enter site location",value:e.restorationForm.get("site")?.value||""}],buttons:[{text:"Cancel",role:"cancel"},{text:"Save",handler:o=>{e.restorationForm.patchValue({site:o.site})}}]})).present()})()}editZone(){var e=this;return(0,p.A)(function*(){yield(yield e.alertController.create({header:"Zone Number",inputs:[{name:"zoneNumber",type:"text",placeholder:"Enter zone number",value:e.restorationForm.get("zoneNumber")?.value||""}],buttons:[{text:"Cancel",role:"cancel"},{text:"Save",handler:o=>{e.restorationForm.patchValue({zoneNumber:o.zoneNumber})}}]})).present()})()}editQuad(){var e=this;return(0,p.A)(function*(){yield(yield e.alertController.create({header:"Quad Number",inputs:[{name:"quadNumber",type:"text",placeholder:"Enter quad number",value:e.restorationForm.get("quadNumber")?.value||""}],buttons:[{text:"Cancel",role:"cancel"},{text:"Save",handler:o=>{e.restorationForm.patchValue({quadNumber:o.quadNumber})}}]})).present()})()}getZoneName(e){return e?`Zone ${e}`:""}getQuadDisplay(e){if(!e)return"";const n=e.match(/\d+/);return n?n[0]:""}locationHasZones(){const e=this.restorationForm.get("site")?.value;return!!e&&["Ramsar","Grand Anse","Petit Barbarons"].includes(e)}locationHasQuads(){const e=this.restorationForm.get("site")?.value;return!!e&&["Ramsar","Grand Anse","Caiman","Canopy"].includes(e)}editLocationAdmin(){var e=this;return(0,p.A)(function*(){if(!e.currentUser||e.currentUser.level<4)return;const n=yield e.selectLocationStep();if(!n)return;const o=e.availableLocations.find(l=>l.name===n);let a="";if(o?.hasZones&&o.zones.length>0){const l=yield e.selectZoneStep(o);if(null===l)return;a=l}let c="";if(o?.hasQuads&&o.quads.length>0){const l=yield e.selectQuadStep(o,a);if(null===l)return;c=l}e.restorationForm.patchValue({site:n,zoneNumber:a,quadNumber:c}),e.isEditMode&&e.restorationForm.markAsDirty()})()}selectLocationStep(){var e=this;return new Promise(function(){var n=(0,p.A)(function*(o){const a=e.restorationForm.get("site")?.value||"",c=e.availableLocations.map(u=>({name:"location",type:"radio",label:u.name,value:u.name,checked:u.name===a}));yield(yield e.alertController.create({header:"Select Location",cssClass:"location-edit-alert",inputs:c,buttons:[{text:"Cancel",role:"cancel",handler:()=>o(null)},{text:"Next",handler:u=>o(u)}]})).present()});return function(o){return n.apply(this,arguments)}}())}selectZoneStep(e){var n=this;return new Promise(function(){var o=(0,p.A)(function*(a){const c=n.restorationForm.get("zoneNumber")?.value||"",l=e.zones.map(d=>({name:"zone",type:"radio",label:`Zone ${d}`,value:d,checked:d===c}));yield(yield n.alertController.create({header:"Select Zone",subHeader:e.name,cssClass:"location-edit-alert",inputs:l,buttons:[{text:"Cancel",role:"cancel",handler:()=>a(null)},{text:"Next",handler:d=>a(d)}]})).present()});return function(a){return o.apply(this,arguments)}}())}selectQuadStep(e,n){var o=this;return new Promise(function(){var a=(0,p.A)(function*(c){const l=o.restorationForm.get("quadNumber")?.value||"";let u=e.quads;if(n&&e.zoneQuadMap&&e.zoneQuadMap[n]){const _=e.zoneQuadMap[n];u=e.quads.filter(b=>{const P=parseInt(o.getQuadDisplay(b));return _.includes(P)})}const d=u.map(_=>({name:"quad",type:"radio",label:`Quad ${o.getQuadDisplay(_)}`,value:_,checked:o.getQuadDisplay(_)===l||_===l}));yield(yield o.alertController.create({header:"Select Quad",subHeader:e.name,cssClass:"location-edit-alert",inputs:d,buttons:[{text:"Cancel",role:"cancel",handler:()=>c(null)},{text:"Save",handler:_=>c(_)}]})).present()});return function(c){return a.apply(this,arguments)}}())}loadDynamicSites(){var e=this;return(0,p.A)(function*(){try{(yield e.siteSyncService.getAllSites()).forEach(o=>{e.availableLocations.some(a=>a.name===o.name)||e.availableLocations.push({name:o.name,hasZones:o.zones&&o.zones.length>0||!1,hasQuads:o.sample_points&&o.sample_points.length>0||!1,zones:o.zones?o.zones.map(a=>a.name?.replace("Zone ","")||a.id):[],quads:o.sample_points?o.sample_points.map(a=>a.id||a.label):[]})})}catch(n){console.error("Error loading dynamic sites:",n)}})()}initializeForm(){const e=this.getCurrentDate(),n=new Date,o=`${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`;this.restorationForm=this.formBuilder.group({site:["",v.k0.required],zoneNumber:[""],quadNumber:[""],date:[e,v.k0.required],observationTime:[o],outplanting:this.formBuilder.array(this.mangroveSpecies.map(()=>[null])),seedCollection:this.formBuilder.array(this.mangroveSpecies.map(()=>[null])),seedsSowed:this.formBuilder.array(this.mangroveSpecies.map(()=>[null])),averageHeight:this.formBuilder.array(this.mangroveSpecies.map(()=>[null])),mortality:this.formBuilder.array(this.mangroveSpecies.map(()=>[null])),notes:[""]}),this.updateProgress()}get outplanting(){return this.restorationForm.get("outplanting")}get seedCollection(){return this.restorationForm.get("seedCollection")}get seedsSowed(){return this.restorationForm.get("seedsSowed")}get averageHeight(){return this.restorationForm.get("averageHeight")}get mortality(){return this.restorationForm.get("mortality")}get outplantingTotal(){return this.outplanting.value.reduce((e,n)=>e+(Number(n)||0),0)}get seedCollectionTotal(){return this.seedCollection.value.reduce((e,n)=>e+(Number(n)||0),0)}get seedsSowedTotal(){return this.seedsSowed.value.reduce((e,n)=>e+(Number(n)||0),0)}get averageHeightOverall(){const e=this.averageHeight.value.filter(o=>o>0);return 0===e.length?"0.0":(e.reduce((o,a)=>o+(Number(a)||0),0)/e.length).toFixed(1)}get mortalityTotal(){return this.mortality.value.reduce((e,n)=>e+(Number(n)||0),0)}get lastSeedCollectionTotal(){return this.lastReportData?.seedCollection.reduce((e,n)=>e+(n||0),0)||0}get lastSeedsSowedTotal(){return this.lastReportData?.seedsSowed.reduce((e,n)=>e+(n||0),0)||0}get lastAverageHeightOverall(){if(!this.lastReportData)return"0.0";const e=this.lastReportData.averageHeight.filter(o=>o>0);return 0===e.length?"0.0":(e.reduce((o,a)=>o+(a||0),0)/e.length).toFixed(1)}get lastMortalityTotal(){return this.lastReportData?.mortality.reduce((e,n)=>e+(n||0),0)||0}get lastOutplantingTotal(){return this.lastReportData?.outplanting.reduce((e,n)=>e+(n||0),0)||0}updateProgress(){const e=this.restorationForm.value;let n=0,o=2;e.site&&n++,e.date&&n++,this.outplantingTotal>0&&(n++,o++),this.seedCollectionTotal>0&&(n++,o++),this.seedsSowedTotal>0&&(n++,o++),this.averageHeight.value.some(c=>c>0)&&(n++,o++),this.mortalityTotal>0&&(n++,o++),e.notes&&(n++,o++),this.progress=o>0?n/o:0}subscribeToFormChanges(){this.autosaveSub&&this.autosaveSub.unsubscribe(),this.autosaveSub=this.restorationForm.valueChanges.pipe((0,w.B)(750)).subscribe(()=>{this.isSubmitted||(this.updateProgress(),this.saveDraftOnExit().catch(e=>console.error("RestorationPage: autosave failed:",e)))})}incrementValue(e,n,o=1){const a=this.restorationForm.get(e);if(a&&a.at(n)){const c=a.at(n).value||0;a.at(n).setValue(Number((c+o).toFixed(1)))}}decrementValue(e,n,o=1){const a=this.restorationForm.get(e);if(a&&a.at(n)){const c=a.at(n).value||0;c>0&&a.at(n).setValue(Math.max(0,Number((c-o).toFixed(1))))}}onHeightChange(e){const n=this.averageHeight.at(e).value;if(null!=n){const o=Number(n);!isNaN(o)&&o>=0?this.averageHeight.at(e).setValue(Number(o.toFixed(1))):this.averageHeight.at(e).setValue(0)}}onSubmit(){var e=this;return(0,p.A)(function*(){if(e.isSubmitting)return;if(e.isSubmitting=!0,e.restorationForm.markAllAsTouched(),!e.restorationForm.valid)return e.isSubmitting=!1,void(yield(yield e.alertController.create({header:"Incomplete Form",message:"Please fill in all required fields (Site and Date).",buttons:["OK"]})).present());e.isSubmitted=!0,e.autosaveSub&&(e.autosaveSub.unsubscribe(),e.autosaveSub=null);const n=yield e.loadingController.create({message:"Submitting restoration monitoring data..."});yield n.present();try{const o={...e.restorationForm.value,outplantingTotal:e.outplantingTotal,seedCollectionTotal:e.seedCollectionTotal,seedsSowedTotal:e.seedsSowedTotal,averageHeightOverall:e.averageHeightOverall,mortalityTotal:e.mortalityTotal};o.status={incomplete:!1,sent:!0,pending:!1};let a=e.currentProjectKey;if(!a){const f=o.site||"Unknown",_=o.zoneNumber||"",b=o.quadNumber||"";a=`REST${Array.from({length:3},()=>String.fromCharCode(65+Math.floor(26*Math.random()))).join("")}_${f.replace(/[^a-zA-Z0-9]/g,"_")}${_?"_Zone"+_:""}${b?"_Quad"+b:""}`}const c={formValue:o,coordinates:null,photos:[],project_key:a,sequence_number:e.currentSequenceNumber,parent_report_id:e.parentReportId||void 0,is_ongoing:e.isProjectOngoing,existingReportId:e.currentReportId||void 0};e.isEditMode&&(c.originalSubmittedBy=e.originalSubmittedBy);const l=yield e.restorationSyncService.submitFinal(c);yield n.dismiss();try{e.autosaveSub&&(e.autosaveSub.unsubscribe(),e.autosaveSub=null),yield new Promise(x=>setTimeout(x,1e3));const f=e.restorationForm.value;yield e.restorationSyncService.clearDraft(f);const _=(f?.location||"unknown").replace(/[^a-zA-Z0-9]/g,"_"),b=f?.zoneNumber||"",P=f?.quadNumber||"";let C=`restoration_draft_${_}`;b&&(C+=`_zone${b}`),P&&(C+=`_quad${P}`),yield e.forceDeleteDraftFile(`${C}.json`),e.isSubmitted=!0,console.log("RestorationPage: Draft cleared and form reset successfully")}catch(f){console.error("RestorationPage: Failed to clear draft:",f)}const u=e.isEditMode?l.queued?"Updated data saved locally and queued for upload when online.":"Restoration data updated successfully!":l.queued?"Restoration data saved locally and queued for upload when online.":"Restoration monitoring data submitted successfully!";yield(yield e.alertController.create({header:"Success",message:u,buttons:[{text:"OK",handler:()=>{e.router.navigate(["/health"])}}]})).present()}catch(o){yield n.dismiss(),console.error("Error submitting monitoring data:",o),yield(yield e.alertController.create({header:"Error",message:"Failed to submit restoration monitoring data. Please try again.",buttons:["OK"]})).present()}})()}discardForm(){var e=this;return(0,p.A)(function*(){var o;yield(yield e.alertController.create({header:"Discard Form",message:"Are you sure you want to discard this form? All entered data will be lost.",buttons:[{text:"Cancel",role:"cancel"},{text:"Discard",role:"destructive",handler:(o=(0,p.A)(function*(){e.isDiscarded=!0,e.autosaveSub&&(e.autosaveSub.unsubscribe(),e.autosaveSub=null),yield new Promise(f=>setTimeout(f,1e3));const a=e.restorationForm.value;yield e.restorationSyncService.clearDraft(a);const c=(a?.location||"unknown").replace(/[^a-zA-Z0-9]/g,"_"),l=a?.zoneNumber||"",u=a?.quadNumber||"";let d=`restoration_draft_${c}`;l&&(d+=`_zone${l}`),u&&(d+=`_quad${u}`),yield e.forceDeleteDraftFile(`${d}.json`),yield new Promise(f=>setTimeout(f,200)),e.initializeForm(),e.router.navigate(["/health"])}),function(){return o.apply(this,arguments)})}]})).present()})()}restoreDraftIfAny(){var e=this;return(0,p.A)(function*(){const n=e.route.snapshot.queryParams,o={location:n.location||e.restorationForm.get("location")?.value,zoneNumber:n.zone||e.restorationForm.get("zoneNumber")?.value,quadNumber:n.quad||e.restorationForm.get("quadNumber")?.value},a=yield e.restorationSyncService.loadDraft(o);if(a)try{a.reportId&&(e.currentReportId=a.reportId),a.form&&e.restorationForm.patchValue(a.form),e.updateProgress()}catch(c){console.error("RestorationPage: failed to restore draft:",c)}})()}saveDraft(){var e=this;return(0,p.A)(function*(){var o;e.restorationForm&&(yield(yield e.alertController.create({header:"Save Draft",message:"Are you sure you want to save this form as a draft? You can return to complete it later.",buttons:[{text:"Cancel",role:"cancel"},{text:"Save Draft",handler:(o=(0,p.A)(function*(){try{yield e.saveDraftOnExit(),yield(yield e.alertController.create({header:"Draft Saved",message:"Your form has been saved as a draft. You can access it from the health page.",buttons:[{text:"OK",handler:()=>{e.router.navigate(["/health"])}}]})).present()}catch(a){console.error("Failed to save draft:",a),yield(yield e.alertController.create({header:"Save Failed",message:"Failed to save the draft. Please try again.",buttons:["OK"]})).present()}}),function(){return o.apply(this,arguments)})}]})).present())})()}saveDraftOnExit(){var e=this;return(0,p.A)(function*(){if(!e.restorationForm||e.viewMode||e.isDiscarded||e.isSubmitted)return;const n=e.restorationForm.value;(n?.site||e.outplantingTotal>0||e.seedCollectionTotal>0||e.seedsSowedTotal>0)&&(yield e.restorationSyncService.saveDraft({reportId:e.currentReportId,form:{...n,outplantingTotal:e.outplantingTotal,seedCollectionTotal:e.seedCollectionTotal,seedsSowedTotal:e.seedsSowedTotal,averageHeightOverall:e.averageHeightOverall,mortalityTotal:e.mortalityTotal},coordinates:null,photos:[]}))})()}showMangroveInfo(e,n){var o=this;return(0,p.A)(function*(){if(e.stopPropagation(),y.Ii.isNativePlatform())try{yield R.Z.lock({orientation:"portrait"})}catch{}const a=yield o.modalController.create({component:jt,componentProps:{species:n},cssClass:"fullheight-info-modal"});a.onDidDismiss().then((0,p.A)(function*(){if(y.Ii.isNativePlatform())try{yield R.Z.unlock()}catch{}})),yield a.present()})()}setViewMode(e){this.viewMode=e,e?this.restorationForm.disable():this.restorationForm.enable()}enableEditMode(){!this.currentUser||this.currentUser.level<4||(this.isEditMode=!0,this.viewMode=!1,this.restorationForm.enable(),this.originalSubmittedBy=this.loadedReport?.submittedBy||"")}getEditedDateTime(){if(!this.loadedReport)return null;let e=this.loadedReport.editedAt||null;if(!e){const d=this.loadedReport.updatedAt,f=this.loadedReport.createdAt;d&&f&&d!==f&&Math.abs(new Date(d).getTime()-new Date(f).getTime())>5e3&&(e=d)}if(!e)return null;const n=new Date(e);return isNaN(n.getTime())?null:`${n.getDate().toString().padStart(2,"0")}/${(n.getMonth()+1).toString().padStart(2,"0")}/${n.getFullYear()} ${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`}loadProjectForContinuation(e){var n=this;return(0,p.A)(function*(){try{const a=(yield n.restorationSyncService.getAllReports()).filter(u=>u.report.project_key===e||u.report.reportId===e);if(0===a.length)return void console.error("RestorationPage: No reports found for project:",e);const l=a.reduce((u,d)=>(d.report.sequence_number||1)>(u.report.sequence_number||1)?d:u).report;console.log("RestorationPage: Loading project for continuation:",l),n.currentProjectKey=e,n.currentSequenceNumber=(l.sequence_number||1)+1,n.parentReportId=l.reportId,n.isProjectOngoing=!1!==l.is_ongoing,n.lastReportData={outplanting:l.form.outplanting||n.mangroveSpecies.map(()=>null),seedCollection:l.form.seedCollection||n.mangroveSpecies.map(()=>null),seedsSowed:l.form.seedsSowed||n.mangroveSpecies.map(()=>null),averageHeight:l.form.averageHeight||n.mangroveSpecies.map(()=>null),mortality:l.form.mortality||n.mangroveSpecies.map(()=>null),notes:l.form.notes||"",date:l.form.date||""},n.restorationForm.patchValue({site:l.form.site||"",date:n.getCurrentDate(),zoneNumber:l.form.zoneNumber||"",quadNumber:l.form.quadNumber||"",notes:""})}catch(o){console.error("RestorationPage: Error loading project for continuation:",o)}})()}loadReportForViewing(e){var n=this;return(0,p.A)(function*(){try{const o=yield n.restorationSyncService.getAllReports();console.log("RestorationPage: All reports:",o);const a=o.find(l=>l.report.reportId===e);if(!a)return console.error("RestorationPage: Report not found for viewing:",e),yield(yield n.alertController.create({header:"Report Not Found",message:"The requested report could not be found.",buttons:["OK"]})).present(),void n.router.navigate(["/health"]);const c=a.report;if(console.log("RestorationPage: Loading report for viewing:",c),n.loadedReport=c,n.restorationForm.patchValue({site:c.form.site||"",date:c.form.date||"",observationTime:c.form.observationTime||"",zoneNumber:c.form.zoneNumber||"",quadNumber:c.form.quadNumber||"",notes:c.form.notes||""}),c.form.outplanting&&Array.isArray(c.form.outplanting)){const l=n.restorationForm.get("outplanting");c.form.outplanting.forEach((u,d)=>{l.at(d)&&l.at(d).patchValue(void 0!==u?u:null)})}if(c.form.seedCollection&&Array.isArray(c.form.seedCollection)){const l=n.restorationForm.get("seedCollection");c.form.seedCollection.forEach((u,d)=>{l.at(d)&&l.at(d).patchValue(void 0!==u?u:null)})}if(c.form.seedsSowed&&Array.isArray(c.form.seedsSowed)){const l=n.restorationForm.get("seedsSowed");c.form.seedsSowed.forEach((u,d)=>{l.at(d)&&l.at(d).patchValue(void 0!==u?u:null)})}if(c.form.averageHeight&&Array.isArray(c.form.averageHeight)){const l=n.restorationForm.get("averageHeight");c.form.averageHeight.forEach((u,d)=>{l.at(d)&&l.at(d).patchValue(void 0!==u?u:null)})}if(c.form.mortality&&Array.isArray(c.form.mortality)){const l=n.restorationForm.get("mortality");c.form.mortality.forEach((u,d)=>{l.at(d)&&l.at(d).patchValue(void 0!==u?u:null)})}n.currentReportId=e,n.setCurrentDateTime(e),n.updateProgress(),n.setViewMode(!0)}catch(o){console.error("RestorationPage: Error loading report for viewing:",o),yield(yield n.alertController.create({header:"Error",message:"Failed to load the report.",buttons:["OK"]})).present(),n.router.navigate(["/health"])}})()}deleteEntry(){var e=this;return(0,p.A)(function*(){const n=e.auth.getCurrentUser();var a;!n||n.level<4?yield(yield e.alertController.create({header:"Permission Denied",message:"Only Level 4 users can delete entries.",buttons:["OK"]})).present():yield(yield e.alertController.create({header:"Delete Entry",message:"Are you sure you want to permanently delete this entry? This will remove it from the database and back it up to deleted files storage. This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:(a=(0,p.A)(function*(){yield e.performDeletion()}),function(){return a.apply(this,arguments)})}]})).present()})()}performDeletion(){var e=this;return(0,p.A)(function*(){const n=yield e.loadingController.create({message:"Deleting entry..."});yield n.present();try{const o=e.auth.getCurrentUser();yield e.entryDeletionService.deleteEntry({reportId:e.currentReportId,formType:"restoration",tableName:"restoration_reports",deletedBy:o?.username||"Unknown",deletedByEmail:o?.email||"",originalSubmittedBy:e.loadedReport?.submittedBy,originalSubmittedAt:e.loadedReport?.createdAt}),yield n.dismiss(),yield(yield e.alertController.create({header:"Success",message:"Entry has been deleted and backed up successfully.",buttons:[{text:"OK",handler:()=>{e.router.navigate(["/health"])}}]})).present()}catch(o){yield n.dismiss(),console.error("Error deleting entry:",o),yield(yield e.alertController.create({header:"Error",message:"Failed to delete entry. Please try again.",buttons:["OK"]})).present()}})()}static#t=i=()=>(this.\u0275fac=function(n){return new(n||s)(t.rXU(v.ok),t.rXU(m.hG),t.rXU(m.Xi),t.rXU(k.Ix),t.rXU(k.nX),t.rXU(m.W3),t.rXU(S.N),t.rXU(N.T),t.rXU(E.H),t.rXU(T.C),t.rXU(I.k))},this.\u0275cmp=t.VBU({type:s,selectors:[["app-restoration"]],standalone:!1,decls:129,vars:33,consts:[[1,"restoration-green"],["slot","start"],["defaultHref","/health"],[1,"restoration-green","compact-toolbar"],[1,"date-time-text"],[4,"ngIf"],[1,"restoration-green","metadata-toolbar"],[1,"metadata-container"],[1,"metadata-item",3,"click"],["name","location",1,"metadata-icon"],[1,"metadata-label"],["name","alert-circle","class","status-icon required",4,"ngIf"],["class","metadata-item",3,"click",4,"ngIf"],["class","edit-location-link",3,"click",4,"ngIf"],["style","padding: 0 16px; font-size: 0.75rem; color: #e76f51;",4,"ngIf"],["color","light",3,"value"],[1,"progress-text"],[3,"ngSubmit","formGroup"],["class","edit-mode-banner",4,"ngIf"],["class","edit-mode-banner editing",4,"ngIf"],["lines","none"],[1,"info-note"],["name","information-circle",2,"color","#2d8659"],["class","status-card",4,"ngIf"],[1,"seed-collection-header"],["formArrayName","seedCollection",1,"species-list"],["class","species-row",4,"ngFor","ngForOf"],[1,"total-row"],[1,"total-value-section"],["class","last-value",4,"ngIf"],["readonly","",1,"total-input",3,"value"],[1,"sowing-header"],[1,"section-label"],["formArrayName","seedsSowed",1,"species-list"],[1,"growth-header"],["formArrayName","averageHeight",1,"species-list"],["slot","end"],[1,"mortality-header"],["formArrayName","mortality",1,"species-list"],[1,"outplanting-header"],["formArrayName","outplanting",1,"species-list"],["position","stacked"],["formControlName","notes","rows","4","placeholder","Enter any observations about growth patterns, environmental conditions, or issues encountered"],["class","form-buttons",4,"ngIf"],["class","button-container",4,"ngIf"],["name","alert-circle",1,"status-icon","required"],["name","grid",1,"metadata-icon"],["name","apps",1,"metadata-icon"],[1,"edit-location-link",3,"click"],[2,"padding","0 16px","font-size","0.75rem","color","#e76f51"],[1,"edit-mode-banner"],["expand","block","color","warning",3,"click"],["name","create-outline","slot","start"],[1,"edit-mode-banner","editing"],["name","create-outline"],[1,"status-card"],["name","leaf-outline","slot","start",1,"toggle-icon"],[2,"min-width","70%","margin-right","15px"],[2,"width","100%"],[2,"margin-top","12px"],[2,"display","flex","flex-direction","column","align-items","center","flex-shrink","0","margin-right","15px"],[2,"font-size","0.8rem","margin-bottom","4px"],[1,"restoration-toggle",2,"--handle-border-radius","50%","--track-border-radius","15px","width","50px",3,"ngModelChange","ngModel","ngModelOptions"],["class","status-note warning",4,"ngIf"],[1,"status-note","warning"],["name","information-circle-outline"],[1,"species-row"],[1,"species-info"],["name","information-circle-outline","color","medium",1,"info-icon",3,"click"],[1,"value-section"],[1,"tally-control"],["size","small","fill","clear",3,"click",4,"ngIf"],["type","number","min","0","class","tally-input","placeholder","0",3,"formControlName",4,"ngIf"],[1,"last-value"],[1,"last-label"],[1,"last-number"],["size","small","fill","clear",3,"click"],["name","remove"],["type","number","min","0","placeholder","0",1,"tally-input",3,"formControlName"],["name","add"],[1,"value-section","height-section"],["type","number","step","0.1","min","0","placeholder","0.0",1,"height-input-simple",3,"ionChange","formControl","readonly"],[1,"form-buttons"],["expand","block","type","submit",1,"submit-button",3,"disabled"],["name","checkmark-circle","slot","start"],["expand","block","fill","outline","color","medium",1,"save-draft-button",3,"click"],["name","save-outline","slot","start"],["expand","block","fill","outline",1,"discard-button",3,"click"],["name","trash-outline","slot","start"],[1,"button-container"],["expand","block","color","danger",1,"delete-button",3,"click"]],template:function(n,o){if(1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-back-button",2),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"Restoration Monitoring"),t.k0s()(),t.j41(6,"ion-toolbar",3)(7,"ion-text",4),t.EFF(8),t.DNE(9,G,2,1,"span",5),t.k0s()(),t.j41(10,"ion-toolbar",6)(11,"div",7)(12,"div",8),t.bIt("click",function(){return!o.viewMode&&o.editSite()}),t.nrm(13,"ion-icon",9),t.j41(14,"span",10),t.EFF(15),t.k0s(),t.DNE(16,$,1,0,"ion-icon",11),t.k0s(),t.DNE(17,z,4,1,"div",12)(18,A,4,1,"div",12)(19,V,2,0,"span",13),t.k0s(),t.DNE(20,X,2,0,"ion-error",14),t.k0s(),t.j41(21,"ion-toolbar",3),t.nrm(22,"ion-progress-bar",15),t.j41(23,"ion-text",16),t.EFF(24),t.k0s()()(),t.j41(25,"ion-content")(26,"form",17),t.bIt("ngSubmit",function(){return o.onSubmit()}),t.DNE(27,Y,4,0,"div",18)(28,q,4,0,"div",19),t.j41(29,"ion-card")(30,"ion-card-content")(31,"ion-item",20)(32,"ion-label",21),t.nrm(33,"ion-icon",22),t.EFF(34," Minimum monitoring frequency: every two weeks "),t.k0s()()()(),t.DNE(35,H,20,8,"ion-card",23),t.j41(36,"ion-card")(37,"ion-card-header",24)(38,"ion-card-title"),t.EFF(39,"Seed Collection"),t.k0s(),t.j41(40,"ion-card-subtitle"),t.EFF(41,"Number of Species Collected"),t.k0s()(),t.j41(42,"ion-card-content")(43,"div",25),t.DNE(44,K,17,7,"div",26),t.k0s(),t.j41(45,"ion-item",27)(46,"ion-label")(47,"strong"),t.EFF(48,"Total"),t.k0s()(),t.j41(49,"div",28),t.DNE(50,tt,5,1,"div",29),t.nrm(51,"ion-input",30),t.k0s()()()(),t.j41(52,"ion-card")(53,"ion-card-header",31)(54,"ion-card-title"),t.EFF(55,"Sowing"),t.k0s()(),t.j41(56,"ion-card-content")(57,"ion-label",32),t.EFF(58,"Number of Seeds Sowed per Species"),t.k0s(),t.j41(59,"div",33),t.DNE(60,at,16,7,"div",26),t.k0s(),t.j41(61,"ion-item",27)(62,"ion-label")(63,"strong"),t.EFF(64,"Total"),t.k0s()(),t.j41(65,"div",28),t.DNE(66,st,5,1,"div",29),t.nrm(67,"ion-input",30),t.k0s()()()(),t.j41(68,"ion-card")(69,"ion-card-header",34)(70,"ion-card-title"),t.EFF(71,"Growth Monitoring"),t.k0s(),t.j41(72,"ion-card-subtitle"),t.EFF(73,"Average Height per Species (cm)"),t.k0s()(),t.j41(74,"ion-card-content")(75,"div",35),t.DNE(76,lt,15,5,"div",26),t.k0s(),t.j41(77,"ion-item",27)(78,"ion-label")(79,"strong"),t.EFF(80,"Average Overall"),t.k0s()(),t.j41(81,"div",28),t.DNE(82,dt,5,1,"div",29),t.j41(83,"ion-input",30)(84,"span",36),t.EFF(85,"cm"),t.k0s()()()()()(),t.j41(86,"ion-card")(87,"ion-card-header",37)(88,"ion-card-title"),t.EFF(89,"Mortality per Species"),t.k0s(),t.j41(90,"ion-card-subtitle"),t.EFF(91,"Number of Dead/Failed Individuals"),t.k0s()(),t.j41(92,"ion-card-content")(93,"div",38),t.DNE(94,_t,16,7,"div",26),t.k0s(),t.j41(95,"ion-item",27)(96,"ion-label")(97,"strong"),t.EFF(98,"Total"),t.k0s()(),t.j41(99,"div",28),t.DNE(100,ht,5,1,"div",29),t.nrm(101,"ion-input",30),t.k0s()()()(),t.j41(102,"ion-card")(103,"ion-card-header",39)(104,"ion-card-title"),t.EFF(105,"Outplanting"),t.k0s(),t.j41(106,"ion-card-subtitle"),t.EFF(107,"Number of Individuals Outplanted per Species"),t.k0s()(),t.j41(108,"ion-card-content")(109,"div",40),t.DNE(110,xt,16,7,"div",26),t.k0s(),t.j41(111,"ion-item",27)(112,"ion-label")(113,"strong"),t.EFF(114,"Total"),t.k0s()(),t.j41(115,"div",28),t.DNE(116,Ot,5,1,"div",29),t.nrm(117,"ion-input",30),t.k0s()()()(),t.j41(118,"ion-card")(119,"ion-card-header",0)(120,"ion-card-title"),t.EFF(121,"Additional Notes"),t.k0s()(),t.j41(122,"ion-card-content")(123,"ion-item")(124,"ion-label",41),t.EFF(125,"Observations"),t.k0s(),t.nrm(126,"ion-textarea",42),t.k0s()()(),t.DNE(127,yt,10,1,"div",43)(128,Rt,4,0,"div",44),t.k0s()()),2&n){let a,c,l,u,d;t.R7$(8),t.SpI(" ",o.currentDateTime),t.R7$(),t.Y8G("ngIf",(o.viewMode||o.isEditMode)&&o.getEditedDateTime()),t.R7$(6),t.JRh((null==(a=o.restorationForm.get("site"))?null:a.value)||"Add site"),t.R7$(),t.Y8G("ngIf",!(null!=(c=o.restorationForm.get("site"))&&c.value||o.viewMode)),t.R7$(),t.Y8G("ngIf",(null==(l=o.restorationForm.get("zoneNumber"))?null:l.value)&&o.locationHasZones()),t.R7$(),t.Y8G("ngIf",(null==(u=o.restorationForm.get("quadNumber"))?null:u.value)&&o.locationHasQuads()),t.R7$(),t.Y8G("ngIf",o.isEditMode&&o.currentUser&&o.currentUser.level>=4),t.R7$(),t.Y8G("ngIf",(null==(d=o.restorationForm.get("site"))?null:d.hasError("required"))&&(null==(d=o.restorationForm.get("site"))?null:d.touched)),t.R7$(2),t.Y8G("value",o.progress),t.R7$(2),t.SpI(" ",(100*o.progress).toFixed(0),"% Complete "),t.R7$(),t.AVh("view-mode",o.viewMode),t.R7$(),t.Y8G("formGroup",o.restorationForm),t.R7$(),t.Y8G("ngIf",o.viewMode&&o.currentUser&&o.currentUser.level>=4),t.R7$(),t.Y8G("ngIf",o.isEditMode),t.R7$(7),t.Y8G("ngIf",!o.viewMode),t.R7$(9),t.Y8G("ngForOf",o.mangroveSpecies),t.R7$(6),t.Y8G("ngIf",o.isUpdatingProject&&o.lastReportData),t.R7$(),t.Y8G("value",o.seedCollectionTotal),t.R7$(9),t.Y8G("ngForOf",o.mangroveSpecies),t.R7$(6),t.Y8G("ngIf",o.isUpdatingProject&&o.lastReportData),t.R7$(),t.Y8G("value",o.seedsSowedTotal),t.R7$(9),t.Y8G("ngForOf",o.mangroveSpecies),t.R7$(6),t.Y8G("ngIf",o.isUpdatingProject&&o.lastReportData),t.R7$(),t.Y8G("value",o.averageHeightOverall),t.R7$(11),t.Y8G("ngForOf",o.mangroveSpecies),t.R7$(6),t.Y8G("ngIf",o.isUpdatingProject&&o.lastReportData),t.R7$(),t.Y8G("value",o.mortalityTotal),t.R7$(9),t.Y8G("ngForOf",o.mangroveSpecies),t.R7$(6),t.Y8G("ngIf",o.isUpdatingProject&&o.lastReportData),t.R7$(),t.Y8G("value",o.outplantingTotal),t.R7$(10),t.Y8G("ngIf",!o.viewMode),t.R7$(),t.Y8G("ngIf",o.viewMode&&(null==o.currentUser?null:o.currentUser.level)>=4)}},dependencies:[M.Sq,M.bT,v.qT,v.me,v.Q0,v.BC,v.cb,v.VZ,v.vS,v.l_,v.j4,v.JD,v.v8,m.Jm,m.QW,m.b_,m.I9,m.ME,m.HW,m.tN,m.W9,m.eU,m.iq,m.$w,m.uz,m.he,m.JI,m.FH,m.IO,m.nc,m.BC,m.BY,m.ai,m.hB,m.su,m.Gw,m.el,m.T6],styles:[".restoration-green[_ngcontent-%COMP%]{--background: #2d8659;color:#fff}.restoration-green[_ngcontent-%COMP%]   ion-back-button[_ngcontent-%COMP%]{--color: white;transition:transform .2s}.restoration-green[_ngcontent-%COMP%]   ion-back-button[_ngcontent-%COMP%]:hover{transform:translate(-4px)}.restoration-green[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;text-align:center}.restoration-green.compact-toolbar[_ngcontent-%COMP%]{--min-height: 28px;--padding-top: 5px;--padding-bottom: 5px}.edit-mode-banner[_ngcontent-%COMP%]{padding:.75rem 1rem;margin:.5rem;border-radius:.5rem}.edit-mode-banner[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: .5rem;font-weight:600}.edit-mode-banner.editing[_ngcontent-%COMP%]{background:#fff3cd;border:1px solid #ffc107;display:flex;align-items:center;gap:.5rem;color:#856404;font-weight:500}.edit-mode-banner.editing[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2rem}.date-time-text[_ngcontent-%COMP%]{display:block;text-align:center;color:#fffffff2;font-size:14px;padding:0;margin:3px 0;font-weight:400;letter-spacing:.3px;line-height:1.2}.metadata-toolbar[_ngcontent-%COMP%]{--min-height: 40px;--padding-top: 6px;--padding-bottom: 6px}.metadata-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:8px;padding:0 12px;flex-wrap:wrap}.metadata-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px;background:#ffffff26;border-radius:16px;padding:5px 10px;cursor:pointer;transition:all .2s ease;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2)}.metadata-item[_ngcontent-%COMP%]:active{transform:scale(.95);background:#ffffff40}.metadata-icon[_ngcontent-%COMP%]{font-size:14px;color:#ffffffe6;min-width:14px}.metadata-label[_ngcontent-%COMP%]{color:#fff;font-size:12px;font-weight:500;letter-spacing:.2px;white-space:nowrap;max-width:120px;overflow:hidden;text-overflow:ellipsis}.edit-location-link[_ngcontent-%COMP%]{color:#ffffffe6;font-size:11px;text-decoration:underline;cursor:pointer;margin-left:8px;padding:4px 8px}.edit-location-link[_ngcontent-%COMP%]:active{opacity:.7}.status-icon[_ngcontent-%COMP%]{font-size:14px;margin-left:2px}.status-icon.success[_ngcontent-%COMP%]{color:#52a676}.status-icon.required[_ngcontent-%COMP%]{color:#ffd93d;animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.6}}.progress-text[_ngcontent-%COMP%]{display:block;text-align:center;color:#fff;font-size:13px;padding:0;margin:0 0 4px;font-weight:400;line-height:1}ion-card[_ngcontent-%COMP%]{margin:16px;border-radius:12px;box-shadow:0 2px 8px #0000001a}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{border-radius:12px 12px 0 0;padding:16px}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:#fff}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#fffffff2;font-size:.875rem;margin-top:4px}ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{background:#fff;padding:16px}.outplanting-header[_ngcontent-%COMP%]{--background: #52a676 !important;--background-opacity: 1}.outplanting-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%], .outplanting-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#333}.seed-collection-header[_ngcontent-%COMP%]{--background: #4fb3bf !important;--background-opacity: 1}.seed-collection-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%], .seed-collection-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#fff}.sowing-header[_ngcontent-%COMP%]{--background: #4dbba7 !important;--background-opacity: 1}.sowing-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{color:#333}.growth-header[_ngcontent-%COMP%]{--background: #D4A73C !important;--background-opacity: 1}.growth-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%], .growth-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#333}.mortality-header[_ngcontent-%COMP%]{--background: #e76f51 !important;--background-opacity: 1}.mortality-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%], .mortality-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#333}.info-note[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#4fb3bf;font-size:.875rem;padding:8px 0}.info-note[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2rem}.section-label[_ngcontent-%COMP%]{display:block;font-weight:600;color:#0d3d2f;margin:16px 0 8px;font-size:.95rem}.species-list[_ngcontent-%COMP%]{margin-top:8px}.species-row[_ngcontent-%COMP%]{margin-bottom:8px}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;--background: #f9f9f9;border-radius:8px;margin-bottom:8px}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .species-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;flex:1;min-width:170px}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .height-input-simple[_ngcontent-%COMP%]{--padding-start: 8px;--padding-end: 8px;text-align:center;max-width:140px;font-weight:500;margin-left:auto}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .height-input-simple.item-interactive[_ngcontent-%COMP%]{--background: #f5f5f5;--border-color: #ddd;--border-radius: 8px}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .height-input-simple[readonly][_ngcontent-%COMP%]{--background: transparent;pointer-events:none}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:600;color:#0d3d2f;margin:0 0 4px;font-size:.95rem}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7c7a;font-size:.8rem;font-style:italic;margin:0}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{font-size:1.3rem;flex-shrink:0;margin-right:10px;cursor:pointer}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]:hover{opacity:.7}.species-input[_ngcontent-%COMP%]{--padding-start: 12px;--padding-end: 12px;max-width:120px;text-align:center;font-weight:600;border:1px solid #ddd;border-radius:6px;margin-left:8px}.value-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.value-section.height-section[_ngcontent-%COMP%]{gap:8px}.total-value-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.last-value[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;min-width:50px;padding:4px 8px;background:#f5f5f5;border-radius:6px;border:1px solid #e0e0e0}.last-value[_ngcontent-%COMP%]   .last-label[_ngcontent-%COMP%]{font-size:.65rem;color:#888;text-transform:uppercase;letter-spacing:.5px}.last-value[_ngcontent-%COMP%]   .last-number[_ngcontent-%COMP%]{font-size:.9rem;font-weight:600;color:#6b7c7a}.tally-control[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px}.tally-control[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 4px;--padding-end: 4px;min-width:32px;height:32px;margin:0}.tally-control[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.tally-control[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{min-width:30px;text-align:center;font-weight:600;font-size:.95rem}.tally-control[_ngcontent-%COMP%]   .placeholder-value[_ngcontent-%COMP%]{color:#999;font-weight:400}.tally-control[_ngcontent-%COMP%]   .tally-input[_ngcontent-%COMP%]{width:50px;text-align:center;font-weight:600;font-size:.95rem;border:1px solid #ccc;border-radius:4px;padding:4px;appearance:textfield}.tally-control[_ngcontent-%COMP%]   .tally-input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .tally-control[_ngcontent-%COMP%]   .tally-input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.total-row[_ngcontent-%COMP%]{background:#e8f8f5!important;border-top:2px solid #2d8659;margin-top:12px;padding:8px 0;--background: #e8f8f5}.total-row[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#2d8659;font-size:1rem}.total-input[_ngcontent-%COMP%]{--padding-start: 12px;--padding-end: 12px;max-width:120px;text-align:center;font-weight:700;color:#2d8659;border:2px solid #2d8659;border-radius:6px;background:#fff;margin-left:8px}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;margin-bottom:12px}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-bottom:8px}ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{--padding-start: 12px;--padding-end: 12px;border:1px solid #ddd;border-radius:8px;margin-top:4px}ion-item[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{--padding-top: 12px;--padding-bottom: 12px}.form-buttons[_ngcontent-%COMP%]{padding:0 16px;margin-top:24px;margin-bottom:32px}.form-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-bottom:12px}.form-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:last-child{margin-bottom:0}.form-buttons[_ngcontent-%COMP%]   ion-button.save-draft-button[_ngcontent-%COMP%]{margin:10px 0 12px}.form-buttons[_ngcontent-%COMP%]   .save-draft-button[_ngcontent-%COMP%]{--border-radius: 8px;height:48px;font-size:1rem;font-weight:500;--background: rgba(107, 124, 122, .1);--border-color: #6b7c7a;--color: #6b7c7a;--background-hover: rgba(107, 124, 122, .2);--background-activated: rgba(107, 124, 122, .3)}.form-buttons[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]{margin:0;--border-radius: 8px;height:48px;font-size:1.125rem;font-weight:600;--background: #2d8659;--background-hover: #256e47;--background-activated: #256e47}.form-buttons[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]:disabled{opacity:.5}.form-buttons[_ngcontent-%COMP%]   .discard-button[_ngcontent-%COMP%]{--border-radius: 8px;height:48px;font-size:1rem;font-weight:500;--color: #e76f51;--border-color: #e76f51;--border-width: 2px;--background-hover: rgba(231, 111, 81, .1);--background-activated: rgba(231, 111, 81, .2);--ripple-color: rgba(231, 111, 81, .3)}.form-buttons[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{margin-top:20px;--background: #d32f2f;--background-hover: #b71c1c;--background-activated: #b71c1c;font-weight:600;height:48px;font-size:1rem}.submit-button[_ngcontent-%COMP%]{margin:24px 16px 32px;--border-radius: 8px;height:48px;font-size:1.125rem;font-weight:600;--background: #2d8659;--background-hover: #256e47;--background-activated: #256e47}.submit-button[_ngcontent-%COMP%]:disabled{opacity:.5}ion-error[_ngcontent-%COMP%]{color:#e76f51!important;font-size:.75rem!important;margin-top:4px;padding-left:16px}.view-mode[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%], .view-mode   [_nghost-%COMP%]   ion-item[_ngcontent-%COMP%], .view-mode[_nghost-%COMP%]   ion-input[_ngcontent-%COMP%], .view-mode   [_nghost-%COMP%]   ion-input[_ngcontent-%COMP%], .view-mode[_nghost-%COMP%]   ion-textarea[_ngcontent-%COMP%], .view-mode   [_nghost-%COMP%]   ion-textarea[_ngcontent-%COMP%], .view-mode[_nghost-%COMP%]   ion-select[_ngcontent-%COMP%], .view-mode   [_nghost-%COMP%]   ion-select[_ngcontent-%COMP%], .view-mode[_nghost-%COMP%]   ion-toggle[_ngcontent-%COMP%], .view-mode   [_nghost-%COMP%]   ion-toggle[_ngcontent-%COMP%], .view-mode[_nghost-%COMP%]   ion-checkbox[_ngcontent-%COMP%], .view-mode   [_nghost-%COMP%]   ion-checkbox[_ngcontent-%COMP%], .view-mode[_nghost-%COMP%]   ion-label[_ngcontent-%COMP%], .view-mode   [_nghost-%COMP%]   ion-label[_ngcontent-%COMP%]{opacity:1!important;--opacity: 1 !important;color:#000!important;--color: #000 !important}ion-item.item-disabled[_ngcontent-%COMP%], ion-item.item-interactive-disabled[_ngcontent-%COMP%]{opacity:1!important;--opacity: 1 !important}ion-item.item-disabled[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], ion-item.item-interactive-disabled[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{opacity:1!important;color:#000!important}  .item-disabled,   .item-interactive-disabled{opacity:1!important}  .item-disabled ion-label,   .item-disabled .label-text,   .item-disabled .native-input,   .item-disabled .select-text,   .item-disabled .select-icon,   .item-interactive-disabled ion-label,   .item-interactive-disabled .label-text,   .item-interactive-disabled .native-input,   .item-interactive-disabled .select-text,   .item-interactive-disabled .select-icon{opacity:1!important;color:#000!important}  ion-select.select-disabled{opacity:1!important}  ion-select.select-disabled .select-text,   ion-select.select-disabled .select-icon,   ion-select.select-disabled .select-placeholder{opacity:1!important;color:#000!important}  ion-toggle.toggle-disabled{opacity:1!important}  ion-checkbox.checkbox-disabled{opacity:1!important}  ion-input.input-disabled,   ion-textarea.textarea-disabled{opacity:1!important}  ion-input.input-disabled .native-input,   ion-input.input-disabled .native-textarea,   ion-textarea.textarea-disabled .native-input,   ion-textarea.textarea-disabled .native-textarea{opacity:1!important;color:#000!important;-webkit-text-fill-color:#000!important}@media (max-width: 768px){.species-input[_ngcontent-%COMP%], .total-input[_ngcontent-%COMP%]{max-width:100px;font-size:.9rem}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.85rem}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.75rem}ion-card[_ngcontent-%COMP%]{margin:12px}.status-card[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{font-size:.8rem!important}.status-card[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.9rem!important}.status-card[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem!important}.status-card[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{color:#888;font-size:.7rem!important;font-style:italic;margin-top:12px}}@media (max-width: 480px){ion-card[_ngcontent-%COMP%]{margin:8px}ion-card-content[_ngcontent-%COMP%]{padding:12px 8px!important}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 4px;--inner-padding-end: 4px}.species-info[_ngcontent-%COMP%]{min-width:100px!important;gap:4px!important}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.8rem}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.7rem}.info-icon[_ngcontent-%COMP%]{font-size:1rem!important}.tally-control[_ngcontent-%COMP%]{gap:4px}.tally-control[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{min-width:28px;height:28px}.tally-control[_ngcontent-%COMP%]   .tally-input[_ngcontent-%COMP%]{width:40px;padding:2px;font-size:.85rem}.height-input-simple[_ngcontent-%COMP%]{max-width:100px!important;font-size:.85rem}.value-section[_ngcontent-%COMP%]{gap:6px}.last-value[_ngcontent-%COMP%]{min-width:50px;padding:2px 4px}.last-value[_ngcontent-%COMP%]   .last-label[_ngcontent-%COMP%]{font-size:.6rem}.last-value[_ngcontent-%COMP%]   .last-number[_ngcontent-%COMP%]{font-size:.75rem}.total-row[_ngcontent-%COMP%]{--padding-end: 10px}.total-row[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:.9rem}.total-input[_ngcontent-%COMP%]{max-width:90px!important}}.status-card[_ngcontent-%COMP%]{margin:16px;box-shadow:0 2px 8px #2d865926}.status-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{padding-bottom:8px}.status-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{color:#2d8659;font-size:1.1rem;font-weight:600}.status-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#666;font-size:.875rem;margin-top:4px}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{color:#2d8659;font-size:1.5rem;margin-right:8px}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.938rem;font-weight:500;color:#333;margin:0 0 4px}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.813rem;color:#666;margin:0}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-toggle[_ngcontent-%COMP%]{--handle-width: 26px;--handle-height: 26px;--handle-border-radius: 50%;--track-border-radius: 15px}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .status-note[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;margin-top:12px;padding:8px 12px;background:#f0f9f4;border-radius:8px;font-size:.813rem;color:#2d8659}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .status-note.warning[_ngcontent-%COMP%]{background:#fff3e0;color:#e76f51}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .status-note[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.1rem;flex-shrink:0}ion-toggle.restoration-toggle[_ngcontent-%COMP%]{--track-background: #e0e0e0;--track-background-checked: #e0e0e0;--handle-background: #ffffff;--handle-background-checked: #2d8659;--handle-border-radius: 50% !important;--track-border-radius: 15px !important}ion-toggle.restoration-toggle[_ngcontent-%COMP%]::part(handle){border-radius:50%!important}ion-toggle.restoration-toggle[_ngcontent-%COMP%]::part(track){border-radius:15px!important}"]}))}return i(),s})(),jt=(()=>{var i;class s{constructor(e){this.modalController=e,this.currentIndex=0,this.rotatedImages=new Set(["assets/mangroves/Red mangrove1.webp","assets/mangroves/Red mangrove2.webp","assets/mangroves/White mangrove2.webp","assets/mangroves/Black mangrove.webp","assets/mangroves/Oriental mangrove1.webp","assets/mangroves/Oriental mangrove2.webp","assets/mangroves/Puzzlenut mangrove.webp","assets/mangroves/Yellow mangrove1.webp","assets/mangroves/Yellow mangrove2.webp","assets/mangroves/Apple mangrove.webp"])}isCurrentImageRotated(){return this.rotatedImages.has(this.getCurrentImage())}getImages(){return Array.isArray(this.species.imagePath)?this.species.imagePath:[this.species.imagePath]}getCurrentImage(){return this.getImages()[this.currentIndex]||""}next(){const e=this.getImages();this.currentIndex=(this.currentIndex+1)%e.length}previous(){const e=this.getImages();this.currentIndex=(this.currentIndex-1+e.length)%e.length}goTo(e){this.currentIndex=e}dismiss(){this.modalController.dismiss()}static#t=i=()=>(this.\u0275fac=function(n){return new(n||s)(t.rXU(m.W3))},this.\u0275cmp=t.VBU({type:s,selectors:[["mangrove-info-modal"]],decls:18,vars:8,consts:[["slot","end"],[3,"click"],["name","close","slot","icon-only"],[1,"ion-padding"],[1,"popover-content"],[1,"common-name"],[1,"latin-name"],[1,"slideshow-container"],[1,"image-wrapper"],["appPinchZoom","",1,"mangrove-image",3,"src","alt"],["class","slideshow-controls",4,"ngIf"],[1,"slideshow-controls"],[1,"nav-button",3,"click"],["name","chevron-back"],[1,"slideshow-indicators"],["class","indicator-dot",3,"active","click",4,"ngFor","ngForOf"],["name","chevron-forward"],[1,"indicator-dot",3,"click"]],template:function(n,o){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.j41(4,"ion-buttons",0)(5,"ion-button",1),t.bIt("click",function(){return o.dismiss()}),t.nrm(6,"ion-icon",2),t.k0s()()()(),t.j41(7,"ion-content",3)(8,"div",4)(9,"p",5),t.EFF(10),t.k0s(),t.j41(11,"p",6)(12,"em"),t.EFF(13),t.k0s()(),t.j41(14,"div",7)(15,"div",8),t.nrm(16,"img",9),t.k0s(),t.DNE(17,Ft,7,1,"div",10),t.k0s()()()),2&n&&(t.R7$(3),t.JRh(o.species.scientificName),t.R7$(7),t.JRh(o.species.commonName),t.R7$(3),t.JRh(o.species.latinName),t.R7$(2),t.AVh("rotated-wrapper",o.isCurrentImageRotated()),t.R7$(),t.Y8G("src",o.getCurrentImage(),t.B4B)("alt",o.species.scientificName),t.R7$(),t.Y8G("ngIf",o.getImages().length>1))},dependencies:[m.bv,m.Jm,m.QW,m.W9,m.eU,m.iq,m.BC,m.ai,M.MD,M.Sq,M.bT,j.h],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: #2d8659;--color: white}ion-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600}ion-button[_ngcontent-%COMP%]{--color: white}ion-content[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;--padding-top: 0;--padding-bottom: 0}.popover-content[_ngcontent-%COMP%]{text-align:center;height:100%;display:flex;flex-direction:column;justify-content:flex-start;padding-top:20px;min-height:0;overflow:hidden}.common-name[_ngcontent-%COMP%]{margin:16px 16px 8px;font-size:16px;color:#666;font-weight:500}.latin-name[_ngcontent-%COMP%]{margin:0 16px 16px;font-size:14px;color:#888}.slideshow-container[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;min-height:0;overflow:hidden}.image-wrapper[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;min-height:0;width:100%;overflow:hidden;position:relative}.mangrove-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain;image-orientation:none}@media screen and (max-width: 768px){.image-wrapper.rotated-wrapper[_ngcontent-%COMP%]{transform:rotate(-90deg);width:auto;height:100%}.mangrove-image[_ngcontent-%COMP%]{touch-action:none;user-select:none;-webkit-user-select:none}}@media screen and (min-width: 769px){.mangrove-image[_ngcontent-%COMP%]{margin-top:-20px;transition:transform .2s ease,filter .2s ease}.mangrove-image[_ngcontent-%COMP%]:hover{transform:scale(1.02);filter:brightness(1.1)}.mangrove-image[_ngcontent-%COMP%]:active{transform:scale(.98)}.image-wrapper.rotated-wrapper[_ngcontent-%COMP%]   .mangrove-image[_ngcontent-%COMP%]{transform:rotate(-90deg);max-width:none;max-height:none;height:100%;width:auto;position:absolute;margin-top:0}.image-wrapper.rotated-wrapper[_ngcontent-%COMP%]   .mangrove-image[_ngcontent-%COMP%]:hover{transform:rotate(-90deg) scale(1.02)}.image-wrapper.rotated-wrapper[_ngcontent-%COMP%]   .mangrove-image[_ngcontent-%COMP%]:active{transform:rotate(-90deg) scale(.98)}}.slideshow-controls[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:16px;padding:8px 0}.nav-button[_ngcontent-%COMP%]{background:#2d865926;border:none;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease}.nav-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#2d8659}.nav-button[_ngcontent-%COMP%]:hover{background:#2d865940}.nav-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.slideshow-indicators[_ngcontent-%COMP%]{display:flex;gap:8px}.indicator-dot[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;background:#2d865940;cursor:pointer;transition:all .3s ease}.indicator-dot.active[_ngcontent-%COMP%]{background:#2d8659;transform:scale(1.3)}.indicator-dot[_ngcontent-%COMP%]:hover{background:#2d865980}"]}))}return i(),s})();const St=[{path:"",component:wt}];let Nt=(()=>{var i;class s{static#t=i=()=>(this.\u0275fac=function(n){return new(n||s)},this.\u0275mod=t.$C({type:s}),this.\u0275inj=g.G2t({imports:[O.iI.forChild(St),O.iI]}))}return i(),s})(),Et=(()=>{var i;class s{static#t=i=()=>(this.\u0275fac=function(n){return new(n||s)},this.\u0275mod=t.$C({type:s}),this.\u0275inj=g.G2t({imports:[M.MD,v.YN,v.X1,m.bv,Nt]}))}return i(),s})()}}]);