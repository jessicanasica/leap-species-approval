"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1153],{1153(B,C,a){a.d(C,{VersionManagerModule:()=>I});var g=a(2200),l=a(4341),x=a(8132),k=a(7343),f=a(467),M=a(2084),e=a(3664),p=a(2615),E=a(5029);const y=["fileInput"];function V(r,s){if(1&r&&(e.j41(0,"div")(1,"p")(2,"strong"),e.EFF(3,"Version:"),e.k0s(),e.EFF(4),e.k0s(),e.j41(5,"p")(6,"strong"),e.EFF(7,"Minimum:"),e.k0s(),e.EFF(8),e.k0s(),e.j41(9,"p")(10,"strong"),e.EFF(11,"Released:"),e.k0s(),e.EFF(12),e.nI1(13,"date"),e.k0s(),e.j41(14,"p")(15,"strong"),e.EFF(16,"Force Update:"),e.k0s(),e.EFF(17),e.k0s()()),2&r){const d=e.XpG();e.R7$(4),e.SpI(" ",d.currentVersion.latestVersion),e.R7$(4),e.SpI(" ",d.currentVersion.minVersion),e.R7$(4),e.SpI(" ",e.i5U(13,4,d.currentVersion.releaseDate,"mediumDate")),e.R7$(5),e.SpI(" ",d.currentVersion.forceUpdate?"Yes":"No")}}function j(r,s){1&r&&(e.j41(0,"p"),e.EFF(1,"Loading..."),e.k0s())}function D(r,s){if(1&r&&(e.j41(0,"div",27),e.EFF(1),e.k0s()),2&r){const d=e.XpG();e.HbH("success"===d.messageType?"success":"error"),e.R7$(),e.SpI(" ",d.message," ")}}const w=[{path:"",component:(()=>{var r;class s{constructor(o){this.supabase=o,this.currentVersion=null,this.loading=!1,this.message="",this.messageType="success"}ngOnInit(){var o=this;return(0,f.A)(function*(){yield o.loadCurrentVersion()})()}loadCurrentVersion(){var o=this;return(0,f.A)(function*(){try{const{data:n,error:t}=yield o.supabase.getClient().storage.from("app-config").download("version.json");if(t)throw t;o.currentVersion=JSON.parse(yield n.text())}catch(n){console.error("Failed to load current version:",n)}})()}onFileSelected(o){const n=o.target.files[0];if(n){const t=document.querySelector(".file-input-wrapper span"),i=document.getElementById("selectedFile");t&&(t.textContent=n.name),i&&(i.textContent=`Size: ${(n.size/1024/1024).toFixed(2)} MB`)}}onSubmit(o){var n=this;return(0,f.A)(function*(){if(!n.loading&&o.valid){n.loading=!0,n.message="";try{const i=n.fileInput.nativeElement.files?.[0];if(!i)throw new Error("Please select a ZIP file");const c=o.value.version,u=o.value.minVersion,P=o.value.updateMessage,O=o.value.changelog||"",_=o.value.forceUpdate||!1,m=`v${c}/app-bundle.zip`,{error:F}=yield n.supabase.getClient().storage.from("app-updates").upload(m,i,{cacheControl:"3600",upsert:!0});if(F)throw F;const{data:{publicUrl:S}}=n.supabase.getClient().storage.from("app-updates").getPublicUrl(m),U={latestVersion:c,minVersion:u,updateMessage:P,forceUpdate:_,downloadUrl:S,changelog:O,releaseDate:(0,M.E)()},{error:b}=yield n.supabase.getClient().storage.from("app-config").upload("version.json",new Blob([JSON.stringify(U,null,2)],{type:"application/json"}),{cacheControl:"60",upsert:!0});if(b)throw b;n.message=`\u2705 Version ${c} uploaded successfully!`,n.messageType="success",setTimeout(()=>n.loadCurrentVersion(),1e3),setTimeout(()=>{o.resetForm();const h=document.querySelector(".file-input-wrapper span"),v=document.getElementById("selectedFile");h&&(h.textContent="Choose ZIP file or drag it here"),v&&(v.textContent=""),n.loading=!1},2e3)}catch(t){console.error("Upload failed:",t),n.message=`\u274c Upload failed: ${t.message}`,n.messageType="error",n.loading=!1}}})()}static#e=r=()=>(this.\u0275fac=function(n){return new(n||s)(e.rXU(E.L))},this.\u0275cmp=e.VBU({type:s,selectors:[["app-version-manager"]],viewQuery:function(n,t){if(1&n&&e.GBs(y,5),2&n){let i;e.mGM(i=e.lsd())&&(t.fileInput=i.first)}},standalone:!1,decls:83,vars:5,consts:[["loadingVersion",""],["form","ngForm"],["fileInput",""],[1,"container"],[1,"info"],["id","currentVersion",1,"current-version"],[4,"ngIf","ngIfElse"],[3,"ngSubmit"],[1,"form-group"],["for","appBundle"],[1,"file-input-wrapper"],["type","file","id","appBundle","name","appBundle","accept",".zip","required","",3,"change"],["id","selectedFile",1,"selected-file"],["for","version"],["type","text","id","version","name","version","placeholder","1.0.0","pattern","\\d+\\.\\d+\\.\\d+","required","","ngModel",""],["for","minVersion"],["type","text","id","minVersion","name","minVersion","placeholder","1.0.0","pattern","\\d+\\.\\d+\\.\\d+","required","","ngModel",""],["for","updateMessage"],["type","text","id","updateMessage","name","updateMessage","placeholder","New features and bug fixes available!","required","","ngModel",""],["for","changelog"],["id","changelog","name","changelog","placeholder","Added automatic update checking\nImproved form validation\nBug fixes and performance improvements","ngModel",""],[1,"form-group","checkbox-group"],["type","checkbox","id","forceUpdate","name","forceUpdate","ngModel",""],["for","forceUpdate",2,"margin-bottom","0"],["type","submit","id","uploadBtn",3,"disabled"],["id","message",3,"class",4,"ngIf"],[1,"info",2,"margin-top","30px"],["id","message"]],template:function(n,t){if(1&n){const i=e.RV6();e.j41(0,"div",3)(1,"h1"),e.EFF(2,"\u{1f33f} WETSAPP - Version Manager"),e.k0s(),e.j41(3,"div",4)(4,"strong"),e.EFF(5,"\u{1f4f1} For Free Side-loading Distribution"),e.k0s(),e.nrm(6,"br"),e.EFF(7," This tool manages app updates for internal distribution without App Store/Play Store. "),e.k0s(),e.j41(8,"div",5)(9,"h3"),e.EFF(10,"Current Version Info"),e.k0s(),e.DNE(11,V,18,7,"div",6)(12,j,2,0,"ng-template",null,0,e.C5r),e.k0s(),e.j41(14,"form",7,1),e.bIt("ngSubmit",function(){p.eBV(i);const u=e.sdS(15);return p.Njj(t.onSubmit(u))}),e.j41(16,"div",8)(17,"label",9),e.EFF(18,"\u{1f4e6} App Bundle (ZIP file)"),e.k0s(),e.j41(19,"div",10)(20,"input",11,2),e.bIt("change",function(u){return p.eBV(i),p.Njj(t.onFileSelected(u))}),e.k0s(),e.j41(22,"span"),e.EFF(23,"Choose ZIP file or drag it here"),e.k0s(),e.nrm(24,"div",12),e.k0s(),e.j41(25,"small"),e.EFF(26,"Instructions: Build your app with "),e.j41(27,"code"),e.EFF(28,"ionic build"),e.k0s(),e.EFF(29,", then ZIP the www folder"),e.k0s()(),e.j41(30,"div",8)(31,"label",13),e.EFF(32,"\u{1f3f7}\ufe0f Version Number (e.g., 1.2.3)"),e.k0s(),e.nrm(33,"input",14),e.k0s(),e.j41(34,"div",8)(35,"label",15),e.EFF(36,"\u26a0\ufe0f Minimum Version (e.g., 1.0.0)"),e.k0s(),e.nrm(37,"input",16),e.j41(38,"small"),e.EFF(39,"Users below this version will be forced to update"),e.k0s()(),e.j41(40,"div",8)(41,"label",17),e.EFF(42,"\u{1f4dd} Update Message"),e.k0s(),e.nrm(43,"input",18),e.k0s(),e.j41(44,"div",8)(45,"label",19),e.EFF(46,"\u{1f4cb} Changelog (one feature per line)"),e.k0s(),e.nrm(47,"textarea",20),e.k0s(),e.j41(48,"div",21),e.nrm(49,"input",22),e.j41(50,"label",23),e.EFF(51,"\u{1f512} Force Update (no dismiss option)"),e.k0s()(),e.j41(52,"button",24),e.EFF(53),e.k0s(),e.DNE(54,D,2,3,"div",25),e.k0s(),e.j41(55,"div",26)(56,"h3"),e.EFF(57,"\u{1f4cb} Build Instructions"),e.k0s(),e.j41(58,"ol")(59,"li"),e.EFF(60,"Run "),e.j41(61,"code"),e.EFF(62,"ionic build"),e.k0s(),e.EFF(63," to create the www folder"),e.k0s(),e.j41(64,"li"),e.EFF(65,"ZIP the entire www folder (not the parent folder)"),e.k0s(),e.j41(66,"li"),e.EFF(67,"Upload the ZIP file using this form"),e.k0s(),e.j41(68,"li"),e.EFF(69,"Users will get update notifications automatically"),e.k0s()(),e.j41(70,"h3"),e.EFF(71,"\u{1f504} Update Flow"),e.k0s(),e.j41(72,"ul")(73,"li")(74,"strong"),e.EFF(75,"Android:"),e.k0s(),e.EFF(76," Auto-downloads and installs"),e.k0s(),e.j41(77,"li")(78,"strong"),e.EFF(79,"iOS:"),e.k0s(),e.EFF(80,' Downloads, user must tap "Install"'),e.k0s(),e.j41(81,"li"),e.EFF(82,"Users can dismiss 3 times before update is forced"),e.k0s()()()()}if(2&n){const i=e.sdS(13);e.R7$(11),e.Y8G("ngIf",t.currentVersion)("ngIfElse",i),e.R7$(41),e.Y8G("disabled",t.loading),e.R7$(),e.SpI(" ",t.loading?"\u23f3 Uploading...":"\u{1f680} Upload & Update version.json"," "),e.R7$(),e.Y8G("ngIf",t.message)}},dependencies:[g.bT,l.qT,l.me,l.Zm,l.BC,l.cb,l.YS,l.R_,l.vS,l.cV,g.vh],styles:["[_nghost-%COMP%]{display:block;padding:20px;max-width:800px;margin:0 auto;background-color:#f5f5f5;height:100vh;overflow-y:auto;-webkit-overflow-scrolling:touch}.container[_ngcontent-%COMP%]{background:#fff;padding:30px;border-radius:8px;box-shadow:0 2px 10px #0000001a}h1[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:30px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:600;color:#34495e}input[type=text][_ngcontent-%COMP%], input[type=url][_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:16px;box-sizing:border-box}textarea[_ngcontent-%COMP%]{height:100px;resize:vertical}.checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}input[type=checkbox][_ngcontent-%COMP%]{width:20px;height:20px}button[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;padding:12px 24px;border:none;border-radius:4px;font-size:16px;cursor:pointer;transition:background-color .3s}button[_ngcontent-%COMP%]:hover{background-color:#2980b9}button[_ngcontent-%COMP%]:disabled{background-color:#bdc3c7;cursor:not-allowed}.success[_ngcontent-%COMP%]{color:#27ae60;margin-top:10px}.error[_ngcontent-%COMP%]{color:#e74c3c;margin-top:10px}.info[_ngcontent-%COMP%]{background-color:#e8f4f8;padding:15px;border-radius:4px;margin-bottom:20px;border-left:4px solid #3498db}.current-version[_ngcontent-%COMP%]{background-color:#f8f9fa;padding:15px;border-radius:4px;margin-bottom:20px}.current-version[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#2c3e50}.file-input-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block;cursor:pointer;background:#f8f9fa;padding:10px 15px;border:1px solid #ddd;border-radius:4px;width:100%;box-sizing:border-box}.file-input-wrapper[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;left:-9999px}.file-input-wrapper[_ngcontent-%COMP%]:hover{background:#e9ecef}.selected-file[_ngcontent-%COMP%]{margin-top:5px;font-size:14px;color:#666}small[_ngcontent-%COMP%]{color:#666;font-size:12px}code[_ngcontent-%COMP%]{background:#f4f4f4;padding:2px 4px;border-radius:3px;font-family:Courier New,monospace}"]}))}return r(),s})()}];let I=(()=>{var r;class s{static#e=r=()=>(this.\u0275fac=function(n){return new(n||s)},this.\u0275mod=e.$C({type:s}),this.\u0275inj=p.G2t({imports:[g.MD,l.YN,k.bv,x.iI.forChild(w)]}))}return r(),s})()}}]);