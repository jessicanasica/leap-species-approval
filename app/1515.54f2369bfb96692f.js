"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1515],{1515(je,F,g){g.d(F,{LocationOutplantingPageModule:()=>Se});var O=g(2200),M=g(4341),p=g(7343),b=g(8132),_=g(467),S=g(7762),e=g(3664),c=g(2615),I=g(5921),E=g(5032),R=g(5735),$=g(7643),Z=g(3205),T=g(5029),D=g(5010),X=g(7863),B=g(4718),v=g(5676),j=g(8220),k=g(582),w=g(3010),N=g(8736);const f=a=>[a],C=()=>[];function Y(a,l){if(1&a&&(e.j41(0,"span",35),e.nrm(1,"ion-icon",36),e.EFF(2),e.k0s()),2&a){const n=e.XpG().$implicit;e.R7$(2),e.SpI(" ",n.speciesCount," species ")}}function V(a,l){if(1&a){const n=e.RV6();e.j41(0,"ion-item",25)(1,"ion-radio",26),e.bIt("click",function(o){const i=c.eBV(n).$implicit,r=e.XpG(2);return c.Njj(r.toggleProjectSelection(i.projectKey,o))}),e.k0s(),e.j41(2,"ion-label")(3,"h3")(4,"strong"),e.EFF(5),e.k0s()(),e.j41(6,"p",27),e.nrm(7,"ion-icon",28),e.j41(8,"span"),e.EFF(9),e.nI1(10,"date"),e.k0s(),e.j41(11,"span",29),e.EFF(12,"\u2022"),e.k0s(),e.j41(13,"span"),e.EFF(14),e.nI1(15,"date"),e.k0s()(),e.j41(16,"p",30)(17,"ion-badge",31),e.EFF(18),e.k0s(),e.DNE(19,Y,3,1,"span",32),e.k0s()(),e.j41(20,"ion-button",33),e.bIt("click",function(o){const i=c.eBV(n).$implicit,r=e.XpG(2);return c.Njj(r.viewProjectHistory(i,o))}),e.nrm(21,"ion-icon",34),e.k0s()()}if(2&a){const n=l.$implicit,t=e.XpG(2);e.R7$(),e.Y8G("value",n.projectKey),e.R7$(4),e.JRh(t.getProjectDisplayLabel(n)),e.R7$(4),e.SpI("Started: ",e.i5U(10,6,n.initialDate,"mediumDate")),e.R7$(5),e.SpI("Last: ",e.i5U(15,9,n.lastCheckIn,"mediumDate")),e.R7$(4),e.SpI("",n.checkInCount," check-ins"),e.R7$(),e.Y8G("ngIf",n.speciesCount>0)}}function A(a,l){if(1&a){const n=e.RV6();e.j41(0,"div",20)(1,"ion-card",21)(2,"ion-card-header")(3,"ion-card-title",10),e.nrm(4,"ion-icon",22),e.EFF(5," Continue Existing Outplanting Monitoring Activity "),e.k0s(),e.j41(6,"ion-card-subtitle",11),e.EFF(7," Select a monitoring activity to add a new check-in, or start a new monitoring activity below "),e.k0s()(),e.j41(8,"ion-card-content")(9,"ion-list")(10,"ion-radio-group",23),e.mxI("ngModelChange",function(o){c.eBV(n);const i=e.XpG();return e.DH7(i.selectedOngoingProject,o)||(i.selectedOngoingProject=o),c.Njj(o)}),e.bIt("ionChange",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.onProjectSelected())}),e.DNE(11,V,22,12,"ion-item",24),e.k0s()()()()()}if(2&a){const n=e.XpG();e.R7$(10),e.R50("ngModel",n.selectedOngoingProject),e.R7$(),e.Y8G("ngForOf",n.ongoingProjects)}}function U(a,l){1&a&&(e.j41(0,"div",37)(1,"span"),e.EFF(2,"OR START NEW"),e.k0s()())}function K(a,l){if(1&a&&(e.j41(0,"ion-select-option",38),e.EFF(1),e.k0s()),2&a){const n=l.$implicit;e.Y8G("value",n.name),e.R7$(),e.SpI(" ",n.name," ")}}function q(a,l){if(1&a&&(e.j41(0,"ion-note",39),e.nrm(1,"ion-icon",40),e.EFF(2),e.k0s()),2&a){const n=e.XpG();e.R7$(2),e.SpI(" Location locked to: ",n.selectedLocation," ")}}function H(a,l){if(1&a){const n=e.RV6();e.j41(0,"div",58),e.nrm(1,"img",59),e.j41(2,"ion-button",60),e.bIt("click",function(){c.eBV(n);const o=e.XpG(2);return c.Njj(o.removeSitePhoto())}),e.nrm(3,"ion-icon",61),e.k0s()()}if(2&a){const n=e.XpG(2);e.R7$(),e.Y8G("src",n.sitePhoto,e.B4B)}}function J(a,l){if(1&a){const n=e.RV6();e.j41(0,"div",62),e.nrm(1,"img",63),e.j41(2,"ion-button",60),e.bIt("click",function(){c.eBV(n);const o=e.XpG(2);return c.Njj(o.removeSiteMap())}),e.nrm(3,"ion-icon",61),e.k0s()()}if(2&a){const n=e.XpG(2);e.R7$(),e.Y8G("src",n.siteMap,e.B4B)}}function W(a,l){if(1&a){const n=e.RV6();e.j41(0,"div",41)(1,"ion-card",42)(2,"ion-card-content")(3,"h3",43),e.EFF(4,"New Site Information"),e.k0s(),e.j41(5,"p",11),e.EFF(6,"Enter details for the new site"),e.k0s(),e.j41(7,"ion-item",44)(8,"ion-input",45),e.mxI("ngModelChange",function(o){c.eBV(n);const i=e.XpG();return e.DH7(i.newSiteName,o)||(i.newSiteName=o),c.Njj(o)}),e.k0s()(),e.j41(9,"ion-item",44)(10,"ion-input",46),e.mxI("ngModelChange",function(o){c.eBV(n);const i=e.XpG();return e.DH7(i.newSiteDescription,o)||(i.newSiteDescription=o),c.Njj(o)}),e.k0s()(),e.j41(11,"ion-button",47),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.captureGPSCoordinates())}),e.nrm(12,"ion-icon",48),e.EFF(13),e.k0s(),e.j41(14,"ion-row",49)(15,"ion-col",50)(16,"ion-button",51),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.captureSitePhoto())}),e.nrm(17,"ion-icon",52),e.EFF(18),e.k0s()(),e.j41(19,"ion-col",50)(20,"ion-button",51),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.uploadSiteMap())}),e.nrm(21,"ion-icon",53),e.EFF(22),e.k0s()()(),e.DNE(23,H,4,1,"div",54)(24,J,4,1,"div",55),e.nrm(25,"br"),e.j41(26,"ion-button",56),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.submitNewSite())}),e.nrm(27,"ion-icon",57),e.EFF(28," Add New Site "),e.k0s()()()()}if(2&a){const n=e.XpG();e.R7$(8),e.R50("ngModel",n.newSiteName),e.R7$(2),e.R50("ngModel",n.newSiteDescription),e.R7$(3),e.SpI(" ",n.gpsCoordinates?"GPS Captured: "+n.gpsCoordinates.latitude.toFixed(6)+", "+n.gpsCoordinates.longitude.toFixed(6):"Take GPS Coordinates"," "),e.R7$(5),e.SpI(" ",n.sitePhoto?"Photo Captured":"Take Site Photo"," "),e.R7$(4),e.SpI(" ",n.siteMap?"Map Uploaded":"Upload Site Map"," "),e.R7$(),e.Y8G("ngIf",n.sitePhoto),e.R7$(),e.Y8G("ngIf",n.siteMap),e.R7$(2),e.Y8G("disabled",!n.newSiteName||!n.gpsCoordinates)}}function Q(a,l){if(1&a){const n=e.RV6();e.j41(0,"div",58),e.nrm(1,"img",59),e.j41(2,"ion-button",60),e.bIt("click",function(){c.eBV(n);const o=e.XpG(2);return c.Njj(o.removeEditSitePhoto())}),e.nrm(3,"ion-icon",61),e.k0s()()}if(2&a){const n=e.XpG(2);e.R7$(),e.Y8G("src",n.editSitePhoto,e.B4B)}}function ee(a,l){if(1&a){const n=e.RV6();e.j41(0,"div",62),e.nrm(1,"img",63),e.j41(2,"ion-button",60),e.bIt("click",function(){c.eBV(n);const o=e.XpG(2);return c.Njj(o.removeEditSiteMap())}),e.nrm(3,"ion-icon",61),e.k0s()()}if(2&a){const n=e.XpG(2);e.R7$(),e.Y8G("src",n.editSiteMap,e.B4B)}}function te(a,l){if(1&a){const n=e.RV6();e.j41(0,"div",41)(1,"ion-card",42)(2,"ion-card-content")(3,"div",64)(4,"h3",43),e.EFF(5,"Edit Site Information"),e.k0s(),e.j41(6,"ion-badge",65),e.EFF(7,"Admin Only"),e.k0s()(),e.j41(8,"p",11),e.EFF(9,"Modify site details (L4+ users only)"),e.k0s(),e.j41(10,"ion-item",44)(11,"ion-input",45),e.mxI("ngModelChange",function(o){c.eBV(n);const i=e.XpG();return e.DH7(i.editSiteName,o)||(i.editSiteName=o),c.Njj(o)}),e.k0s()(),e.j41(12,"ion-item",44)(13,"ion-input",66),e.mxI("ngModelChange",function(o){c.eBV(n);const i=e.XpG();return e.DH7(i.editSiteDescription,o)||(i.editSiteDescription=o),c.Njj(o)}),e.k0s()(),e.j41(14,"ion-button",47),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.captureEditGPS())}),e.nrm(15,"ion-icon",48),e.EFF(16),e.k0s(),e.j41(17,"ion-row",49)(18,"ion-col",50)(19,"ion-button",51),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.captureEditSitePhoto())}),e.nrm(20,"ion-icon",52),e.EFF(21),e.k0s()(),e.j41(22,"ion-col",50)(23,"ion-button",51),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.uploadEditSiteMap())}),e.nrm(24,"ion-icon",53),e.EFF(25),e.k0s()()(),e.DNE(26,Q,4,1,"div",54)(27,ee,4,1,"div",55),e.nrm(28,"br"),e.j41(29,"ion-row",49)(30,"ion-col",50)(31,"ion-button",67),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.cancelEditSite())}),e.nrm(32,"ion-icon",68),e.EFF(33," Cancel "),e.k0s()(),e.j41(34,"ion-col",50)(35,"ion-button",69),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.saveEditSite())}),e.nrm(36,"ion-icon",70),e.EFF(37," Save Changes "),e.k0s()()(),e.j41(38,"ion-row",71)(39,"ion-col",72)(40,"ion-button",73),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.deleteEditSite())}),e.nrm(41,"ion-icon",74),e.EFF(42," Delete Site "),e.k0s()()()()()()}if(2&a){const n=e.XpG();e.R7$(11),e.R50("ngModel",n.editSiteName),e.R7$(2),e.R50("ngModel",n.editSiteDescription),e.R7$(3),e.SpI(" ",n.editGpsCoordinates?"GPS: "+n.editGpsCoordinates.latitude.toFixed(6)+", "+n.editGpsCoordinates.longitude.toFixed(6):"Update GPS Coordinates"," "),e.R7$(5),e.SpI(" ",n.editSitePhoto?"Photo Set":"New Photo"," "),e.R7$(4),e.SpI(" ",n.editSiteMap?"Map Set":"New Map"," "),e.R7$(),e.Y8G("ngIf",n.editSitePhoto),e.R7$(),e.Y8G("ngIf",n.editSiteMap),e.R7$(8),e.Y8G("disabled",!n.editSiteName)}}function ne(a,l){1&a&&(e.j41(0,"div",90),e.nrm(1,"ion-icon",91),e.j41(2,"span"),e.EFF(3,"Click zones to select"),e.k0s()())}function oe(a,l){if(1&a){const n=e.RV6();e.j41(0,"div",92)(1,"ion-button",93),e.bIt("click",function(){c.eBV(n);const o=e.XpG(2);return c.Njj(o.startEditSite())}),e.nrm(2,"ion-icon",94),e.EFF(3," Edit Site (Admin) "),e.k0s()()}}function ie(a,l){if(1&a){const n=e.RV6();e.j41(0,"app-interactive-location-map",95),e.bIt("zoneSelected",function(o){c.eBV(n);const i=e.XpG(2);return c.Njj(i.onZoneSelected(o))}),e.k0s()}if(2&a){const n=e.XpG(2);e.Y8G("mapImagePath",n.currentMapPath)("zones",n.currentZones)("samplePoints",null)("selectedZones",n.selectedZone?e.eq3(5,f,n.selectedZone):e.lJ4(7,C))("selectedSamplePoints",null)}}function ae(a,l){if(1&a&&e.nrm(0,"app-caiman-interactive-map",96),2&a){const n=e.XpG(2);e.Y8G("mapImagePath",n.currentMapPath)("samplePoints",null)("selectedSamplePoints",null)}}function ce(a,l){if(1&a&&e.nrm(0,"app-canopy-interactive-map",96),2&a){const n=e.XpG(2);e.Y8G("mapImagePath",n.currentMapPath)("samplePoints",null)("selectedSamplePoints",null)}}function re(a,l){if(1&a){const n=e.RV6();e.j41(0,"app-grand-anse-interactive-map",95),e.bIt("zoneSelected",function(o){c.eBV(n);const i=e.XpG(2);return c.Njj(i.onZoneSelected(o))}),e.k0s()}if(2&a){const n=e.XpG(2);e.Y8G("mapImagePath",n.currentMapPath)("zones",n.currentZones)("samplePoints",null)("selectedZones",n.selectedZone?e.eq3(5,f,n.selectedZone):e.lJ4(7,C))("selectedSamplePoints",null)}}function se(a,l){if(1&a){const n=e.RV6();e.j41(0,"app-petit-barbarons-interactive-map",97),e.bIt("zoneSelected",function(o){c.eBV(n);const i=e.XpG(2);return c.Njj(i.onZoneSelected(o))}),e.k0s()}if(2&a){const n=e.XpG(2);e.Y8G("mapImagePath",n.currentMapPath)("zones",n.currentZones)("selectedZones",n.selectedZone?e.eq3(3,f,n.selectedZone):e.lJ4(5,C))}}function le(a,l){if(1&a&&e.nrm(0,"img",98),2&a){const n=e.XpG(2);e.Y8G("src",n.currentMapPath,e.B4B)("alt",n.selectedLocation+" map")}}function de(a,l){1&a&&(e.j41(0,"h3",43),e.EFF(1," Assessment Details"),e.k0s())}function pe(a,l){if(1&a){const n=e.RV6();e.j41(0,"ion-item",44)(1,"ion-input",99),e.mxI("ngModelChange",function(o){c.eBV(n);const i=e.XpG(2);return e.DH7(i.zoneNumber,o)||(i.zoneNumber=o),c.Njj(o)}),e.k0s()()}if(2&a){const n=e.XpG(2);e.AVh("disabled-item","Caiman"===n.selectedLocation||"Canopy"===n.selectedLocation),e.R7$(),e.R50("ngModel",n.zoneNumber),e.Y8G("placeholder","Caiman"===n.selectedLocation||"Canopy"===n.selectedLocation?"Not applicable":"Enter zone number (required)")("disabled","Caiman"===n.selectedLocation||"Canopy"===n.selectedLocation)}}function ge(a,l){if(1&a&&(e.j41(0,"ion-item",44)(1,"ion-label",100),e.EFF(2,"Site Description"),e.k0s(),e.j41(3,"p",101),e.EFF(4),e.k0s()()),2&a){const n=e.XpG(2);e.R7$(4),e.JRh(n.selectedSiteDescription)}}function me(a,l){1&a&&(e.j41(0,"div",102),e.nrm(1,"ion-icon",103),e.j41(2,"span"),e.EFF(3,"Please select a zone on the map"),e.k0s()())}function _e(a,l){if(1&a){const n=e.RV6();e.j41(0,"div",41),e.DNE(1,ne,4,0,"div",75)(2,oe,4,0,"div",76),e.j41(3,"ion-card",77)(4,"ion-card-content",78)(5,"div",79),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.openMapModal())}),e.nrm(6,"ion-icon",80),e.k0s(),e.DNE(7,ie,1,8,"app-interactive-location-map",81)(8,ae,1,3,"app-caiman-interactive-map",82)(9,ce,1,3,"app-canopy-interactive-map",82)(10,re,1,8,"app-grand-anse-interactive-map",81)(11,se,1,6,"app-petit-barbarons-interactive-map",83)(12,le,1,2,"img",84),e.k0s()(),e.j41(13,"ion-card",42)(14,"ion-card-content"),e.DNE(15,de,2,0,"h3",85)(16,pe,2,5,"ion-item",86)(17,ge,5,1,"ion-item",87)(18,me,4,0,"div",88),e.j41(19,"ion-button",69),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.startAssessment())}),e.nrm(20,"ion-icon",89),e.EFF(21," Start Assessment "),e.k0s()()()()}if(2&a){const n=e.XpG();e.R7$(),e.Y8G("ngIf",n.showMap&&n.currentZones.length>0),e.R7$(),e.Y8G("ngIf",n.canEditSelectedSite()),e.R7$(5),e.Y8G("ngIf",n.currentZones.length>0&&"Ramsar"===n.selectedLocation),e.R7$(),e.Y8G("ngIf","Caiman"===n.selectedLocation),e.R7$(),e.Y8G("ngIf","Canopy"===n.selectedLocation),e.R7$(),e.Y8G("ngIf",n.currentZones.length>0&&"Grand Anse"===n.selectedLocation),e.R7$(),e.Y8G("ngIf",n.currentZones.length>0&&"Petit Barbarons"===n.selectedLocation),e.R7$(),e.Y8G("ngIf",0===n.currentZones.length&&"Caiman"!==n.selectedLocation&&"Canopy"!==n.selectedLocation),e.R7$(3),e.Y8G("ngIf","Kempinski"!==n.selectedLocation&&"Roche Caiman"!==n.selectedLocation&&("new"===n.selectedLocation||n.isPredefinedSite(n.selectedLocation))&&n.currentZones.length>0),e.R7$(),e.Y8G("ngIf",!n.showNewSiteForm&&n.currentZones.length>0),e.R7$(),e.Y8G("ngIf",n.selectedLocation&&!n.showNewSiteForm&&0===n.currentZones.length&&n.selectedSiteDescription&&!n.isPredefinedSite(n.selectedLocation)),e.R7$(),e.Y8G("ngIf",n.selectedLocation&&!n.isSelectionValid()&&!n.showNewSiteForm&&n.currentZones.length>0),e.R7$(),e.Y8G("disabled",!n.isSelectionValid()&&!n.showNewSiteForm&&n.currentZones.length>0)}}function ue(a,l){1&a&&(e.j41(0,"div",104)(1,"ion-card",105)(2,"ion-card-content")(3,"div",106),e.nrm(4,"ion-icon",107),e.j41(5,"h4"),e.EFF(6,"How to Begin"),e.k0s()(),e.j41(7,"ul")(8,"li"),e.EFF(9,"Select a "),e.j41(10,"strong",108),e.EFF(11,"known site"),e.k0s(),e.EFF(12," to view its map or enter a "),e.j41(13,"strong",108),e.EFF(14,"new site"),e.k0s(),e.EFF(15," to create a custom location"),e.k0s(),e.j41(16,"li"),e.EFF(17,"Tap the map or fill out new site information to start your assessment"),e.k0s()()()()())}function xe(a,l){if(1&a){const n=e.RV6();e.j41(0,"app-interactive-location-map",121),e.bIt("zoneSelected",function(o){c.eBV(n);const i=e.XpG(2);return c.Njj(i.onZoneSelected(o))}),e.k0s()}if(2&a){const n=e.XpG(2);e.Y8G("mapImagePath",n.currentMapPath)("zones",n.currentZones)("samplePoints",null)("selectedZones",n.selectedZone?e.eq3(5,f,n.selectedZone):e.lJ4(7,C))("selectedSamplePoints",null)}}function ye(a,l){if(1&a&&e.nrm(0,"app-caiman-interactive-map",122),2&a){const n=e.XpG(2);e.Y8G("mapImagePath",n.currentMapPath)("samplePoints",null)("selectedSamplePoints",null)}}function Pe(a,l){if(1&a&&e.nrm(0,"app-canopy-interactive-map",122),2&a){const n=e.XpG(2);e.Y8G("mapImagePath",n.currentMapPath)("samplePoints",null)("selectedSamplePoints",null)}}function he(a,l){if(1&a){const n=e.RV6();e.j41(0,"app-grand-anse-interactive-map",123),e.bIt("zoneSelected",function(o){c.eBV(n);const i=e.XpG(2);return c.Njj(i.onZoneSelected(o))}),e.k0s()}if(2&a){const n=e.XpG(2);e.Y8G("mapImagePath",n.currentMapPath)("zones",n.currentZones)("selectedZones",n.selectedZone?e.eq3(3,f,n.selectedZone):e.lJ4(5,C))}}function fe(a,l){if(1&a){const n=e.RV6();e.j41(0,"app-petit-barbarons-interactive-map",123),e.bIt("zoneSelected",function(o){c.eBV(n);const i=e.XpG(2);return c.Njj(i.onZoneSelected(o))}),e.k0s()}if(2&a){const n=e.XpG(2);e.Y8G("mapImagePath",n.currentMapPath)("zones",n.currentZones)("selectedZones",n.selectedZone?e.eq3(3,f,n.selectedZone):e.lJ4(5,C))}}function Ce(a,l){if(1&a&&e.nrm(0,"img",124),2&a){const n=e.XpG(2);e.Y8G("src",n.currentMapPath,e.B4B)("alt",n.selectedLocation+" map")}}function Oe(a,l){if(1&a){const n=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar",109)(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-buttons",110)(5,"ion-button",111),e.bIt("click",function(){c.eBV(n);const o=e.XpG();return c.Njj(o.closeMapModal())}),e.nrm(6,"ion-icon",112),e.k0s()()()(),e.j41(7,"ion-content",113)(8,"div",114)(9,"p",115),e.nrm(10,"ion-icon",116),e.EFF(11," Rotate device for full-screen view "),e.k0s(),e.DNE(12,xe,1,8,"app-interactive-location-map",117)(13,ye,1,3,"app-caiman-interactive-map",118)(14,Pe,1,3,"app-canopy-interactive-map",118)(15,he,1,6,"app-grand-anse-interactive-map",119)(16,fe,1,6,"app-petit-barbarons-interactive-map",119)(17,Ce,1,2,"img",120),e.k0s()()}if(2&a){const n=e.XpG();e.R7$(3),e.SpI("",n.selectedLocation," Map"),e.R7$(9),e.Y8G("ngIf",n.currentZones.length>0&&"Ramsar"===n.selectedLocation),e.R7$(),e.Y8G("ngIf","Caiman"===n.selectedLocation),e.R7$(),e.Y8G("ngIf","Canopy"===n.selectedLocation),e.R7$(),e.Y8G("ngIf",n.currentZones.length>0&&"Grand Anse"===n.selectedLocation),e.R7$(),e.Y8G("ngIf",n.currentZones.length>0&&"Petit Barbarons"===n.selectedLocation),e.R7$(),e.Y8G("ngIf",0===n.currentZones.length&&"Caiman"!==n.selectedLocation&&"Canopy"!==n.selectedLocation)}}const Me=[{path:"",component:(()=>{var a;class l{constructor(t,o,i,r,s,d,m,u,y,x){this.router=t,this.modalController=o,this.alertController=i,this.platform=r,this.outplantingSyncService=s,this.siteSyncService=d,this.auth=m,this.supabase=u,this.photoService=y,this.imageCompression=x,this.selectedLocation="",this.showMap=!1,this.currentMapPath="",this.zoneNumber="",this.quadNumber="",this.isMapModalOpen=!1,this.showNewSiteForm=!1,this.newSiteName="",this.newSiteDescription="",this.gpsCoordinates=null,this.sitePhoto=null,this.siteMap=null,this.isEditingSite=!1,this.editSiteName="",this.editSiteDescription="",this.editGpsCoordinates=null,this.editSitePhoto=null,this.editSiteMap=null,this.editingSiteOriginalName="",this.selectedZone="",this.currentZones=[],this.selectedSiteDescription="",this.currentUser=null,this.userSubscription=null,this.ongoingProjects=[],this.selectedOngoingProject=null,this.isUpdatingProject=!1,this.knownSites=[{name:"Ramsar",mapPath:"assets/maps/ramsar_plots.webp",zones:[{id:"zone1",name:"Zone 1",points:[{x:-140,y:75},{x:-110,y:80},{x:-65,y:75},{x:-60,y:88},{x:0,y:106},{x:25,y:100},{x:37,y:87},{x:45,y:91},{x:65,y:93},{x:80,y:110},{x:105,y:112},{x:108,y:120},{x:155,y:133},{x:180,y:155},{x:170,y:160},{x:150,y:150},{x:130,y:142},{x:95,y:158},{x:89,y:170},{x:90,y:200},{x:80,y:220},{x:35,y:230},{x:-30,y:235},{x:-84,y:253},{x:-75,y:190},{x:-80,y:160},{x:-135,y:130},{x:-137,y:93},{x:-145,y:77}]},{id:"zone2",name:"Zone 2",points:[{x:-82,y:273},{x:-70,y:253},{x:-40,y:245},{x:-5,y:240},{x:40,y:233},{x:80,y:222},{x:105,y:200},{x:120,y:190},{x:140,y:175},{x:160,y:165},{x:235,y:170},{x:225,y:180},{x:215,y:190},{x:200,y:230},{x:187,y:240},{x:187,y:255},{x:215,y:300},{x:235,y:320},{x:250,y:340},{x:255,y:380},{x:253,y:400},{x:240,y:420},{x:265,y:445},{x:267,y:468},{x:250,y:483},{x:230,y:480},{x:240,y:455},{x:222,y:445},{x:210,y:430},{x:190,y:440},{x:175,y:425},{x:145,y:425},{x:125,y:433},{x:105,y:420},{x:95,y:390},{x:55,y:335},{x:40,y:335},{x:-10,y:350},{x:-30,y:340},{x:-65,y:315}]},{id:"zone3",name:"Zone 3",points:[{x:-5,y:465},{x:-5,y:457},{x:20,y:470},{x:30,y:473},{x:40,y:475},{x:50,y:470},{x:60,y:473},{x:85,y:468},{x:93,y:455},{x:113,y:463},{x:123,y:458},{x:138,y:470},{x:180,y:465},{x:184,y:469},{x:174,y:488},{x:185,y:505},{x:202,y:515},{x:220,y:492},{x:232,y:490},{x:228,y:524},{x:243,y:546},{x:283,y:554},{x:291,y:551},{x:300,y:558},{x:300,y:564},{x:290,y:562},{x:280,y:567},{x:260,y:567},{x:240,y:569},{x:217,y:566},{x:204,y:557},{x:194,y:557},{x:163,y:540},{x:158,y:525},{x:150,y:510},{x:135,y:505},{x:135,y:500},{x:113,y:500},{x:108,y:495},{x:92,y:495},{x:88,y:490},{x:75,y:484},{x:60,y:484},{x:40,y:483},{x:20,y:477}]},{id:"zone4",name:"Zone 4",points:[{x:382,y:65},{x:386,y:65},{x:401,y:82},{x:423,y:87},{x:427,y:80},{x:437,y:78},{x:450,y:75},{x:460,y:90},{x:475,y:117},{x:491,y:130},{x:485,y:137},{x:453,y:140},{x:450,y:150},{x:425,y:153},{x:351,y:146},{x:337,y:148},{x:317,y:149},{x:321,y:141},{x:321,y:138},{x:313,y:135},{x:310,y:115},{x:330,y:112},{x:340,y:97}]},{id:"zone5",name:"Zone 5",points:[{x:217,y:195},{x:245,y:165},{x:255,y:165},{x:257,y:160},{x:290,y:160},{x:305,y:152},{x:355,y:150},{x:395,y:155},{x:400,y:165},{x:415,y:165},{x:420,y:171},{x:430,y:169},{x:430,y:174},{x:458,y:188},{x:490,y:185},{x:540,y:200},{x:540,y:215},{x:530,y:218},{x:495,y:213},{x:465,y:222},{x:430,y:245},{x:415,y:245},{x:385,y:230},{x:370,y:215},{x:350,y:218},{x:332,y:215},{x:325,y:208},{x:290,y:205},{x:280,y:225},{x:260,y:240},{x:230,y:244},{x:225,y:230},{x:202,y:230}]},{id:"zone6",name:"Zone 6",points:[{x:606,y:100},{x:612,y:100},{x:622,y:108},{x:637,y:106},{x:642,y:112},{x:647,y:110},{x:667,y:112},{x:693,y:114},{x:725,y:105},{x:745,y:123},{x:748,y:165},{x:726,y:185},{x:715,y:195},{x:692,y:214},{x:672,y:210},{x:657,y:212},{x:642,y:232},{x:636,y:232},{x:618,y:202},{x:607,y:218},{x:566,y:191},{x:580,y:170},{x:583,y:162},{x:569,y:141},{x:571,y:129},{x:596,y:125}]}],description:""},{name:"Caiman",mapPath:"assets/maps/Caiman_quad_map.webp"},{name:"Canopy",mapPath:"assets/maps/Canopy_quad_map.webp"},{name:"Grand Anse",mapPath:"assets/maps/GA_quad_map.webp",zones:[{id:"zone1",name:"Zone 1",points:[{x:-200,y:315},{x:-175,y:300},{x:-145,y:300},{x:-60,y:313},{x:-55,y:323},{x:64,y:290},{x:154,y:290},{x:170,y:285},{x:210,y:298},{x:240,y:293},{x:260,y:298},{x:270,y:293},{x:275,y:294},{x:285,y:350},{x:242,y:345},{x:125,y:370},{x:75,y:374},{x:35,y:374},{x:15,y:382},{x:0,y:405},{x:-5,y:405},{x:-30,y:380},{x:-90,y:390},{x:-105,y:388},{x:-160,y:397},{x:-198,y:407},{x:-250,y:430},{x:-270,y:430}]},{id:"zone2",name:"Zone 2",points:[{x:140,y:148},{x:150,y:147},{x:182,y:113},{x:196,y:118},{x:209,y:131},{x:235,y:128},{x:265,y:105},{x:282,y:100},{x:292,y:105},{x:310,y:100},{x:360,y:115},{x:370,y:123},{x:380,y:120},{x:405,y:165},{x:400,y:197},{x:390,y:203},{x:390,y:223},{x:385,y:228},{x:390,y:268},{x:382,y:275},{x:370,y:275},{x:377,y:295},{x:398,y:298},{x:400,y:305},{x:415,y:307},{x:451,y:315},{x:497,y:340},{x:530,y:390},{x:545,y:405},{x:545,y:415},{x:532,y:433},{x:435,y:375},{x:385,y:350},{x:355,y:343},{x:287,y:350},{x:275,y:295},{x:295,y:290},{x:313,y:257},{x:300,y:247},{x:293,y:227},{x:298,y:222},{x:283,y:212},{x:240,y:215},{x:238,y:227},{x:174,y:243}]},{id:"zone3",name:"Zone 3",points:[{x:400,y:135},{x:425,y:110},{x:435,y:110},{x:462,y:150},{x:485,y:155},{x:490,y:165},{x:520,y:170},{x:520,y:185},{x:535,y:188},{x:560,y:196},{x:575,y:183},{x:670,y:203},{x:688,y:194},{x:741,y:195},{x:733,y:185},{x:733,y:170},{x:740,y:153},{x:760,y:155},{x:767,y:160},{x:758,y:185},{x:767,y:212},{x:802,y:205},{x:832,y:230},{x:830,y:190},{x:850,y:170},{x:927,y:195},{x:925,y:200},{x:955,y:243},{x:955,y:263},{x:945,y:273},{x:872,y:260},{x:872,y:275},{x:845,y:320},{x:835,y:325},{x:777,y:329},{x:725,y:364},{x:680,y:345},{x:680,y:345},{x:680,y:300},{x:665,y:258},{x:635,y:250},{x:605,y:232},{x:595,y:205},{x:583,y:205},{x:583,y:210},{x:535,y:217},{x:523,y:215},{x:500,y:190},{x:480,y:190},{x:450,y:173},{x:420,y:173},{x:408,y:163}]},{id:"zone4",name:"Zone 4",points:[{x:545,y:483},{x:579,y:475},{x:573,y:460},{x:540,y:448},{x:540,y:445},{x:525,y:440},{x:525,y:430},{x:531,y:433},{x:546,y:413},{x:590,y:440},{x:623,y:444},{x:648,y:420},{x:635,y:415},{x:635,y:405},{x:650,y:402},{x:663,y:370},{x:670,y:370},{x:670,y:345},{x:680,y:345},{x:725,y:364},{x:683,y:427},{x:715,y:443},{x:715,y:460},{x:695,y:475},{x:662,y:460},{x:650,y:475},{x:610,y:495},{x:540,y:495}]}],description:""},{name:"Petit Barbarons",mapPath:"assets/maps/PB_wetland_area_map.webp",zones:[{id:"wetland1",name:"Zone 1",points:[{x:305,y:260},{x:332,y:255},{x:335,y:253},{x:345,y:259},{x:361,y:274},{x:380,y:300},{x:382,y:340},{x:370,y:350},{x:368,y:365},{x:360,y:371},{x:350,y:385},{x:340,y:390},{x:330,y:410},{x:315,y:420},{x:300,y:421},{x:286,y:424},{x:261,y:408},{x:222,y:414},{x:214,y:419},{x:185,y:414},{x:180,y:400},{x:172,y:399},{x:174,y:380},{x:157,y:372},{x:120,y:393},{x:120,y:405},{x:100,y:407},{x:86,y:417},{x:52,y:405},{x:30,y:385},{x:65,y:380},{x:70,y:370},{x:70,y:350},{x:85,y:322},{x:135,y:302},{x:145,y:305},{x:150,y:295},{x:195,y:285},{x:220,y:275},{x:250,y:270},{x:295,y:270}]},{id:"wetland3",name:"Zone 3",points:[{x:420,y:315},{x:433,y:315},{x:445,y:328},{x:480,y:330},{x:500,y:325},{x:560,y:335},{x:580,y:335},{x:602,y:341},{x:610,y:333},{x:630,y:335},{x:644,y:352},{x:648,y:382},{x:643,y:392},{x:603,y:390},{x:500,y:405},{x:460,y:405},{x:451,y:415},{x:432,y:418},{x:382,y:398},{x:382,y:378}]},{id:"wetland2",name:"Zone 2",points:[{x:350,y:10},{x:357,y:39},{x:409,y:68},{x:411,y:77},{x:402,y:90},{x:410,y:118},{x:383,y:155},{x:388,y:185},{x:376,y:202},{x:380,y:212},{x:382,y:222},{x:372,y:234},{x:280,y:210},{x:190,y:140},{x:182,y:140},{x:182,y:130},{x:187,y:125},{x:201,y:124},{x:220,y:105},{x:220,y:75},{x:231,y:63},{x:258,y:60},{x:272,y:50},{x:272,y:36},{x:290,y:28},{x:300,y:30},{x:320,y:30},{x:332,y:7}]},{id:"wetland4",name:"Zone 4",points:[{x:650,y:320},{x:665,y:300},{x:725,y:287},{x:736,y:280},{x:756,y:282},{x:776,y:287},{x:790,y:295},{x:810,y:293},{x:825,y:300},{x:810,y:320},{x:817,y:350},{x:850,y:378},{x:888,y:430},{x:888,y:450},{x:840,y:575},{x:788,y:575},{x:772,y:525},{x:755,y:500},{x:757,y:489},{x:754,y:470},{x:734,y:450},{x:733,y:430},{x:735,y:421},{x:727,y:412},{x:720,y:393},{x:667,y:355}]}]},{name:"Kempinski",mapPath:"assets/maps/kempinski_map.webp"},{name:"Roche Caiman",mapPath:"assets/maps/SARC.webp"}]}ngOnInit(){this.loadDynamicSites(),this.loadOngoingProjects(),this.userSubscription=this.auth.currentUser$.subscribe(t=>{this.currentUser=t})}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}ionViewWillEnter(){this.loadOngoingProjects(),this.selectedLocation="",this.showMap=!1,this.currentMapPath="",this.zoneNumber="",this.quadNumber="",this.showNewSiteForm=!1,this.newSiteName="",this.newSiteDescription="",this.isMapModalOpen=!1,this.selectedZone="",this.currentZones=[],this.selectedOngoingProject=null,this.isUpdatingProject=!1}goBack(){this.router.navigate(["/health"])}onLocationChange(){if("new"===this.selectedLocation)this.showNewSiteForm=!0,this.showMap=!1,this.newSiteName="",this.newSiteDescription="",this.currentZones=[],this.selectedZone="";else if(this.selectedLocation){const t=this.knownSites.find(o=>o.name===this.selectedLocation);t&&(this.currentMapPath=t.mapPath,this.currentZones=t.zones||[],this.showMap=!0,this.showNewSiteForm=!1,this.selectedZone="",this.selectedSiteDescription=t.description||"")}else this.showMap=!1,this.showNewSiteForm=!1,this.currentZones=[],this.selectedZone="",this.selectedSiteDescription=""}onZoneSelected(t){if(this.selectedZone===t)this.selectedZone="",this.zoneNumber="";else if(this.selectedZone&&this.selectedZone!==t&&(this.quadNumber=""),this.selectedZone=t,"Petit Barbarons"===this.selectedLocation){const o=this.currentZones.find(i=>i.id===t);if(o&&o.name){const i=o.name.match(/\d+/);this.zoneNumber=i?i[0]:""}else this.zoneNumber=""}else{const o=t.replace("zone","");this.zoneNumber=o}}getZoneName(t){return t?`Zone ${t}`:""}isPredefinedSite(t){return["Ramsar","Grand Anse","Caiman","Roche Caiman","Canopy","Petit Barbarons","Kempinski"].includes(t)}isSelectionValid(){if(!this.selectedLocation||"new"===this.selectedLocation)return!0;const t=this.knownSites.find(i=>i.name===this.selectedLocation);return!(!t||t.zones&&t.zones.length>0&&!this.zoneNumber)}openMapModal(){this.isMapModalOpen=!0}closeMapModal(){this.isMapModalOpen=!1}loadDynamicSites(){var t=this;return(0,_.A)(function*(){try{(yield t.siteSyncService.getAllSites()).forEach(i=>{const r={name:i.name,mapPath:i.map_path||i.site_photo||"assets/maps/generic_map.jpg",zones:i.zones||[],description:i.description||"",gpsCoordinates:i.gps_latitude&&i.gps_longitude?{latitude:i.gps_latitude,longitude:i.gps_longitude}:void 0};t.knownSites.some(s=>s.name===i.name)||t.knownSites.push(r)})}catch(o){console.error("Error loading dynamic sites:",o)}})()}captureGPSCoordinates(){var t=this;return(0,_.A)(function*(){try{const o=yield S.L.getCurrentPosition();t.gpsCoordinates={latitude:o.coords.latitude,longitude:o.coords.longitude}}catch(o){console.error("Error getting GPS coordinates:",o),yield(yield t.alertController.create({header:"GPS Error",message:"Could not get GPS coordinates. Please ensure location services are enabled.",buttons:["OK"]})).present()}})()}captureSitePhoto(){var t=this;return(0,_.A)(function*(){try{const o=yield t.photoService.TakePicture(),r=yield(yield fetch(o)).blob(),s=new File([r],"site_photo.jpg",{type:"image/jpeg"}),d=t.newSiteName.trim().replace(/\s+/g,"_"),m=new Date,x=`site-photos/${d}_photo_${String(m.getDate()).padStart(2,"0")}${String(m.getMonth()+1).padStart(2,"0")}${m.getFullYear()}.jpg`,{error:P}=yield t.supabase.getClient().storage.from("site-images").upload(x,s);if(P)throw P;const{data:{publicUrl:h}}=t.supabase.getClient().storage.from("site-images").getPublicUrl(x);t.sitePhoto=h,console.log("Site photo uploaded:",h)}catch(o){console.error("Error capturing photo:",o),yield(yield t.alertController.create({header:"Camera Error",message:"Failed to capture photo. Please try again.",buttons:["OK"]})).present()}})()}uploadSiteMap(){var t=this;return(0,_.A)(function*(){const o=document.createElement("input");o.type="file",o.accept="image/png,image/jpeg,image/jpg",o.onchange=function(){var i=(0,_.A)(function*(r){const s=r.target.files[0];if(s)try{console.log("\u{1f4c1} File selected for upload:",s.name,`Size: ${(s.size/1048576).toFixed(2)}MB`),console.log("\u{1f5dc}\ufe0f Compressing uploaded image...");const d=yield t.imageCompression.compressFile(s),m=s.size,u=d.size,y=t.imageCompression.getCompressionPercentage(m,u);console.log(`\u{1f5dc}\ufe0f Image compressed: ${(m/1048576).toFixed(2)}MB \u2192 ${(u/1048576).toFixed(2)}MB (${y}% reduction)`);const x=d.name.split(".").pop(),P=t.newSiteName.trim().replace(/\s+/g,"_"),h=new Date,L=`site-maps/${P}_map_${String(h.getDate()).padStart(2,"0")}${String(h.getMonth()+1).padStart(2,"0")}${h.getFullYear()}.${x}`,{error:G}=yield t.supabase.getClient().storage.from("site-images").upload(L,d);if(G)throw G;const{data:{publicUrl:z}}=t.supabase.getClient().storage.from("site-images").getPublicUrl(L);t.siteMap=z,console.log("Site map uploaded:",z)}catch(d){console.error("Error uploading site map:",d),yield(yield t.alertController.create({header:"Upload Failed",message:"Failed to upload site map. Please try again.",buttons:["OK"]})).present()}});return function(r){return i.apply(this,arguments)}}(),o.click()})()}removeSitePhoto(){this.sitePhoto=null}removeSiteMap(){this.siteMap=null}submitNewSite(){var t=this;return(0,_.A)(function*(){if(t.newSiteName.trim())if(t.gpsCoordinates)if(yield t.siteSyncService.siteExists(t.newSiteName.trim()))yield(yield t.alertController.create({header:"Site Already Exists",message:"A site with this name already exists. Please choose a different name.",buttons:["OK"]})).present();else try{const i=t.auth.getCurrentUser()||{email:"unknown",level:1,organization:"unknown"},r={name:t.newSiteName.trim(),description:t.newSiteDescription.trim(),gps_latitude:t.gpsCoordinates?.latitude,gps_longitude:t.gpsCoordinates?.longitude,added_by:i.email||"unknown",map_path:t.siteMap||t.sitePhoto||"assets/maps/generic_map.jpg",site_photo:t.sitePhoto||void 0,site_map:t.siteMap||void 0};yield t.siteSyncService.addNewSite(r),t.knownSites.push({name:r.name,mapPath:r.map_path,zones:[]}),t.newSiteName="",t.newSiteDescription="",t.gpsCoordinates=null,t.sitePhoto=null,t.siteMap=null,t.showNewSiteForm=!1;let m="";m=(i.level||1)>=4?`The site "${r.name}" has been added and will be available to all users.`:`The site "${r.name}" has been added locally. Permission request has been submitted and will be reviewed by an administrator.`,yield(yield t.alertController.create({header:"Site Added Successfully",message:m,buttons:["OK"]})).present(),t.selectedLocation=r.name,t.onLocationChange()}catch(i){console.error("Error adding new site:",i),yield(yield t.alertController.create({header:"Error",message:"Failed to add the new site. Please try again.",buttons:["OK"]})).present()}else yield(yield t.alertController.create({header:"GPS Required",message:"GPS coordinates are required for new sites. Please capture GPS coordinates first.",buttons:["OK"]})).present()})()}loadOngoingProjects(){var t=this;return(0,_.A)(function*(){try{const o=yield t.outplantingSyncService.getAllReports(),i=new Map;o.filter(r=>!1!==r.is_ongoing).forEach(r=>{const s=r.project_key||r.report.reportId;(!i.has(s)||(r.sequence_number||1)>(i.get(s).sequence_number||1))&&i.set(s,r)}),t.ongoingProjects=Array.from(i.values()).map(r=>{const s=r.report||r;return{projectKey:r.project_key||s.reportId,location:s.form?.siteLocation||s.location||"Unknown",zoneNumber:s.form?.zoneNumber||"",quadNumber:s.form?.quadNumber||"",initialDate:s.form?.date||s.date||s.createdAt,lastCheckIn:r.createdAt||s.createdAt,checkInCount:r.sequence_number||1,speciesCount:(s.form?.individualsOutplanted||[]).filter(d=>d>0).length,isOngoing:!1!==r.is_ongoing}}),t.ongoingProjects.sort((r,s)=>new Date(s.lastCheckIn).getTime()-new Date(r.lastCheckIn).getTime()),console.log("LocationOutplantingPage: Loaded ongoing projects:",t.ongoingProjects)}catch(o){console.error("LocationOutplantingPage: Error loading ongoing projects:",o),t.ongoingProjects=[]}})()}toggleProjectSelection(t,o){this.selectedOngoingProject===t&&(o.preventDefault(),o.stopPropagation(),setTimeout(()=>{this.selectedOngoingProject=null,this.clearProjectSelection()},0))}onProjectSelected(){if(this.selectedOngoingProject){this.isUpdatingProject=!0;const t=this.ongoingProjects.find(o=>o.projectKey===this.selectedOngoingProject);t&&(this.selectedLocation=t.location,this.zoneNumber=t.zoneNumber,this.quadNumber=t.quadNumber,this.onLocationChange(),console.log("Selected project for update:",t))}else this.clearProjectSelection()}clearProjectSelection(){this.selectedOngoingProject=null,this.isUpdatingProject=!1,this.selectedLocation="",this.showMap=!1,this.currentMapPath="",this.zoneNumber="",this.quadNumber="",this.selectedZone="",this.currentZones=[]}viewProjectHistory(t,o){o.stopPropagation(),this.alertController.create({header:"Project History",message:`View full history for project at ${this.getProjectDisplayLabel(t)}. This feature will show all ${t.checkInCount} check-ins chronologically.`,buttons:["OK"]}).then(i=>i.present())}startAssessment(){var t=this;return(0,_.A)(function*(){if(t.selectedOngoingProject){const r=t.ongoingProjects.find(s=>s.projectKey===t.selectedOngoingProject);if(r){const s={location:r.location,zone:r.zoneNumber,projectKey:r.projectKey},d=t.knownSites.find(m=>m.name===r.location);return d?.gpsCoordinates&&(s.lat=d.gpsCoordinates.latitude,s.lng=d.gpsCoordinates.longitude),void t.router.navigate(["/outplanting"],{queryParams:s})}}const o="new"===t.selectedLocation?t.newSiteName:t.selectedLocation;let i=t.gpsCoordinates;if("new"!==t.selectedLocation){const r=t.knownSites.find(s=>s.name===t.selectedLocation);r?.gpsCoordinates&&(i=r.gpsCoordinates)}if(o){const r={location:o,zoneNumber:t.zoneNumber,quadNumber:t.quadNumber};if(yield t.outplantingSyncService.loadDraft(r)){let d=o;t.zoneNumber&&(d+=` - Zone ${t.zoneNumber}`),t.quadNumber&&(d+=` - Quad ${t.quadNumber}`),yield(yield t.alertController.create({header:"Draft Found for This Location",message:`You have an unfinished outplanting monitoring for ${d}. What would you like to do?`,buttons:[{text:"Keep editing previous draft",handler:()=>{const u={location:o,zone:t.zoneNumber};i&&(u.lat=i.latitude,u.lng=i.longitude),t.router.navigate(["/outplanting"],{queryParams:u})}},{text:"Start New (deletes existing draft)",handler:(u=(0,_.A)(function*(){yield t.outplantingSyncService.clearDraft(r);const y={location:o,zone:t.zoneNumber,fresh:"true"};i&&(y.lat=i.latitude,y.lng=i.longitude),t.router.navigate(["/outplanting"],{queryParams:y})}),function(){return u.apply(this,arguments)})},{text:"Cancel",role:"cancel"}]})).present()}else{const d={location:o,zone:t.zoneNumber};i&&(d.lat=i.latitude,d.lng=i.longitude),t.router.navigate(["/outplanting"],{queryParams:d})}}var u})()}getProjectDisplayLabel(t){let o=t.location;return t.zoneNumber&&(o+=` - Zone ${t.zoneNumber}`),t.quadNumber&&(o+=` - Quad ${t.quadNumber}`),o}formatLastCheckIn(t){return new Date(t).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}isL4User(){return this.currentUser&&this.currentUser.level>=4}canEditSelectedSite(){return this.isL4User()&&!!this.selectedLocation&&!this.isPredefinedSite(this.selectedLocation)}startEditSite(){if(!this.canEditSelectedSite())return;const t=this.knownSites.find(o=>o.name===this.selectedLocation);t&&(this.isEditingSite=!0,this.editingSiteOriginalName=t.name,this.editSiteName=t.name,this.editSiteDescription=t.description||"",this.editGpsCoordinates=t.gpsCoordinates||null,this.editSitePhoto=null,this.editSiteMap=null,this.loadSiteMediaForEdit(t.name))}loadSiteMediaForEdit(t){var o=this;return(0,_.A)(function*(){try{const r=(yield o.siteSyncService.getAllSites()).find(s=>s.name===t);r&&(o.editSitePhoto=r.site_photo||null,o.editSiteMap=r.site_map||r.map_path||null)}catch(i){console.error("Error loading site media for edit:",i)}})()}cancelEditSite(){this.isEditingSite=!1,this.editSiteName="",this.editSiteDescription="",this.editGpsCoordinates=null,this.editSitePhoto=null,this.editSiteMap=null,this.editingSiteOriginalName=""}captureEditGPS(){var t=this;return(0,_.A)(function*(){try{const o=yield S.L.getCurrentPosition();t.editGpsCoordinates={latitude:o.coords.latitude,longitude:o.coords.longitude}}catch(o){console.error("Error getting GPS coordinates:",o),yield(yield t.alertController.create({header:"GPS Error",message:"Could not get GPS coordinates. Please ensure location services are enabled.",buttons:["OK"]})).present()}})()}captureEditSitePhoto(){var t=this;return(0,_.A)(function*(){try{const o=yield t.photoService.TakePicture(),r=yield(yield fetch(o)).blob(),s=new File([r],"site_photo.jpg",{type:"image/jpeg"}),d=t.editSiteName.trim().replace(/\s+/g,"_"),m=new Date,x=`site-photos/${d}_photo_${String(m.getDate()).padStart(2,"0")}${String(m.getMonth()+1).padStart(2,"0")}${m.getFullYear()}.jpg`,{error:P}=yield t.supabase.getClient().storage.from("site-images").upload(x,s);if(P)throw P;const{data:{publicUrl:h}}=t.supabase.getClient().storage.from("site-images").getPublicUrl(x);t.editSitePhoto=h}catch(o){console.error("Error capturing photo:",o),yield(yield t.alertController.create({header:"Camera Error",message:"Failed to capture photo. Please try again.",buttons:["OK"]})).present()}})()}uploadEditSiteMap(){var t=this;return(0,_.A)(function*(){const o=document.createElement("input");o.type="file",o.accept="image/png,image/jpeg,image/jpg",o.onchange=function(){var i=(0,_.A)(function*(r){const s=r.target.files[0];if(s)try{const d=yield t.imageCompression.compressFile(s),m=d.name.split(".").pop(),x=`site-maps/${t.editSiteName.trim().replace(/\s+/g,"_")}_map_${Date.now()}.${m}`,{error:P}=yield t.supabase.getClient().storage.from("site-images").upload(x,d);if(P)throw P;const{data:{publicUrl:h}}=t.supabase.getClient().storage.from("site-images").getPublicUrl(x);t.editSiteMap=h}catch(d){console.error("Error uploading site map:",d),yield(yield t.alertController.create({header:"Upload Failed",message:"Failed to upload site map. Please try again.",buttons:["OK"]})).present()}});return function(r){return i.apply(this,arguments)}}(),o.click()})()}removeEditSitePhoto(){this.editSitePhoto=null}removeEditSiteMap(){this.editSiteMap=null}saveEditSite(){var t=this;return(0,_.A)(function*(){if(t.editSiteName.trim())try{const o={name:t.editSiteName.trim(),description:t.editSiteDescription.trim()};t.editGpsCoordinates&&(o.gps_latitude=t.editGpsCoordinates.latitude,o.gps_longitude=t.editGpsCoordinates.longitude),t.editSitePhoto&&(o.site_photo=t.editSitePhoto),t.editSiteMap&&(o.site_map=t.editSiteMap,o.map_path=t.editSiteMap),yield t.siteSyncService.updateSite(t.editingSiteOriginalName,o);const i=t.knownSites.findIndex(s=>s.name===t.editingSiteOriginalName);-1!==i&&(t.knownSites[i]={...t.knownSites[i],name:t.editSiteName.trim(),description:t.editSiteDescription.trim(),mapPath:t.editSiteMap||t.knownSites[i].mapPath,gpsCoordinates:t.editGpsCoordinates||t.knownSites[i].gpsCoordinates}),t.editingSiteOriginalName!==t.editSiteName.trim()&&(t.selectedLocation=t.editSiteName.trim()),t.selectedSiteDescription=t.editSiteDescription.trim(),t.editSiteMap&&(t.currentMapPath=t.editSiteMap),t.cancelEditSite(),yield(yield t.alertController.create({header:"Site Updated",message:"The site information has been updated successfully.",buttons:["OK"]})).present()}catch(o){console.error("Error updating site:",o),yield(yield t.alertController.create({header:"Update Failed",message:"Failed to update site. Please try again.",buttons:["OK"]})).present()}else yield(yield t.alertController.create({header:"Name Required",message:"Site name is required.",buttons:["OK"]})).present()})()}deleteEditSite(){var t=this;return(0,_.A)(function*(){var i;yield(yield t.alertController.create({header:"Delete Site",message:`Are you sure you want to delete "${t.editingSiteOriginalName}"? This action cannot be undone.`,buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:(i=(0,_.A)(function*(){try{yield t.siteSyncService.deleteSite(t.editingSiteOriginalName),t.knownSites=t.knownSites.filter(s=>s.name!==t.editingSiteOriginalName),t.selectedLocation===t.editingSiteOriginalName&&(t.selectedLocation="",t.selectedSiteDescription="",t.currentMapPath=""),t.cancelEditSite(),yield(yield t.alertController.create({header:"Site Deleted",message:"The site has been deleted successfully.",buttons:["OK"]})).present()}catch(r){console.error("Error deleting site:",r),yield(yield t.alertController.create({header:"Delete Failed",message:"Failed to delete site. Please try again.",buttons:["OK"]})).present()}}),function(){return i.apply(this,arguments)})}]})).present()})()}static#e=a=()=>(this.\u0275fac=function(o){return new(o||l)(e.rXU(I.Ix),e.rXU(p.W3),e.rXU(p.hG),e.rXU(E.OD),e.rXU(R.Q),e.rXU($.k),e.rXU(Z.N),e.rXU(T.L),e.rXU(D.I),e.rXU(X.L))},this.\u0275cmp=e.VBU({type:l,selectors:[["app-location-outplanting"]],standalone:!1,decls:31,vars:12,consts:[[1,"location-selection-bg",3,"fullscreen"],[1,"page-header","emerald-gradient"],[1,"header-content"],["name","chevron-back",1,"back-icon",3,"click"],["name","location-outline",1,"page-icon"],[1,"header-text"],["class","selection-section","style","margin-bottom:-20px !important;",4,"ngIf"],["class","or-divider",4,"ngIf"],[1,"selection-section",2,"margin-top","-20px !important"],[1,"selection-card"],[1,"card-title"],[1,"card-subtitle"],["lines","none",1,"location-select-item"],["label","Choose Location","labelPlacement","floating","interface","popover",3,"ngModelChange","ionChange","ngModel","disabled"],[3,"value",4,"ngFor","ngForOf"],["value","new"],["slot","helper","class","locked-note",4,"ngIf"],["class","map-section",4,"ngIf"],["class","instructions-section",4,"ngIf"],["cssClass","fullscreen-map-modal",3,"didDismiss","isOpen"],[1,"selection-section",2,"margin-bottom","-20px !important"],[1,"ongoing-projects-card"],["name","leaf-outline",1,"title-icon"],[3,"ngModelChange","ionChange","ngModel"],["lines","full","class","project-item",4,"ngFor","ngForOf"],["lines","full",1,"project-item"],["slot","start",3,"click","value"],[1,"project-dates"],["name","calendar-outline","size","small"],[1,"separator"],[1,"project-details"],[1,"coastal-badge"],["class","species-info",4,"ngIf"],["slot","end","fill","clear","size","small",1,"history-btn",3,"click"],["name","time-outline","slot","icon-only"],[1,"species-info"],["name","flower-outline","size","small"],[1,"or-divider"],[3,"value"],["slot","helper",1,"locked-note"],["name","lock-closed-outline","size","small"],[1,"map-section"],[1,"details-card"],[1,"details-title"],["lines","none",1,"detail-input-item"],["label","Site Name","labelPlacement","floating","placeholder","Enter site name (required)",3,"ngModelChange","ngModel"],["label","Location Description","labelPlacement","floating","placeholder","Enter location description (optional)",3,"ngModelChange","ngModel"],["expand","block",1,"gps-button",3,"click"],["name","location-outline","slot","start"],[1,"button-row"],["size","6"],["expand","block",1,"coastal-blue-button",3,"click"],["name","camera-outline","slot","start"],["name","map-outline","slot","start"],["class","photo-preview",4,"ngIf"],["class","map-preview",4,"ngIf"],["expand","block",1,"add-site-button",3,"click","disabled"],["name","add-circle-outline","slot","start"],[1,"photo-preview"],["alt","Site photo",1,"preview-image",3,"src"],["fill","clear","color","danger",3,"click"],["name","trash-outline","slot","icon-only"],[1,"map-preview"],["alt","Site map",1,"preview-image",3,"src"],[1,"edit-header"],["color","warning"],["label","Description","labelPlacement","floating","placeholder","Enter description (optional)",3,"ngModelChange","ngModel"],["expand","block","color","medium",3,"click"],["name","close-outline","slot","start"],["expand","block",1,"start-button",3,"click","disabled"],["name","checkmark-outline","slot","start"],[1,"button-row","delete-row"],["size","12"],["expand","block","fill","outline","color","danger",3,"click"],["name","trash-outline","slot","start"],["class","map-hint",4,"ngIf"],["class","admin-edit-button",4,"ngIf"],[1,"map-card"],[1,"map-content"],[1,"map-expand-button",3,"click"],["name","expand-outline"],[3,"mapImagePath","zones","samplePoints","selectedZones","selectedSamplePoints","zoneSelected",4,"ngIf"],[3,"mapImagePath","samplePoints","selectedSamplePoints",4,"ngIf"],[3,"mapImagePath","zones","selectedZones","zoneSelected",4,"ngIf"],["class","site-map",3,"src","alt",4,"ngIf"],["class","details-title",4,"ngIf"],["lines","none","class","detail-input-item",3,"disabled-item",4,"ngIf"],["lines","none","class","detail-input-item",4,"ngIf"],["class","selection-warning",4,"ngIf"],["name","clipboard-outline","slot","start"],[1,"map-hint"],["name","hand-left-outline"],[1,"admin-edit-button"],["size","small","fill","outline","color","warning",3,"click"],["name","pencil-outline","slot","start"],[3,"zoneSelected","mapImagePath","zones","samplePoints","selectedZones","selectedSamplePoints"],[3,"mapImagePath","samplePoints","selectedSamplePoints"],[3,"zoneSelected","mapImagePath","zones","selectedZones"],[1,"site-map",3,"src","alt"],["label","Zone","labelPlacement","floating",3,"ngModelChange","ngModel","placeholder","disabled"],["position","stacked",1,"ion-text-wrap"],[1,"site-description"],[1,"selection-warning"],["name","alert-circle-outline"],[1,"instructions-section"],[1,"info-card"],[1,"info-header"],["name","information-circle-outline",1,"info-icon"],[1,"green-text"],[1,"map-modal-toolbar"],["slot","end"],[3,"click"],["name","close","slot","icon-only"],[1,"map-modal-content"],[1,"fullscreen-map-container"],[1,"rotation-hint"],["name","phone-portrait-outline"],["class","fullscreen-map",3,"mapImagePath","zones","samplePoints","selectedZones","selectedSamplePoints","zoneSelected",4,"ngIf"],["class","fullscreen-map",3,"mapImagePath","samplePoints","selectedSamplePoints",4,"ngIf"],["class","fullscreen-map",3,"mapImagePath","zones","selectedZones","zoneSelected",4,"ngIf"],["class","fullscreen-map","appPinchZoom","",3,"src","alt",4,"ngIf"],[1,"fullscreen-map",3,"zoneSelected","mapImagePath","zones","samplePoints","selectedZones","selectedSamplePoints"],[1,"fullscreen-map",3,"mapImagePath","samplePoints","selectedSamplePoints"],[1,"fullscreen-map",3,"zoneSelected","mapImagePath","zones","selectedZones"],["appPinchZoom","",1,"fullscreen-map",3,"src","alt"]],template:function(o,i){1&o&&(e.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"ion-icon",3),e.bIt("click",function(){return i.goBack()}),e.k0s(),e.nrm(4,"ion-icon",4),e.j41(5,"div",5)(6,"h1"),e.EFF(7,"Select Location"),e.k0s(),e.j41(8,"p"),e.EFF(9,"Choose a site to begin assessment"),e.k0s()()()(),e.DNE(10,A,12,2,"div",6)(11,U,3,0,"div",7),e.j41(12,"div",8)(13,"ion-card",9)(14,"ion-card-content")(15,"h3",10),e.EFF(16,"Start New Outplanting Monitoring Activity"),e.k0s(),e.j41(17,"p",11),e.EFF(18,"Select a known site or create a new one"),e.k0s(),e.j41(19,"ion-item",12)(20,"ion-select",13),e.mxI("ngModelChange",function(s){return e.DH7(i.selectedLocation,s)||(i.selectedLocation=s),s}),e.bIt("ionChange",function(){return i.onLocationChange()}),e.DNE(21,K,2,2,"ion-select-option",14),e.j41(22,"ion-select-option",15),e.EFF(23,"\u2795 New Site"),e.k0s()(),e.DNE(24,q,3,1,"ion-note",16),e.k0s()()()(),e.DNE(25,W,29,8,"div",17)(26,te,43,8,"div",17)(27,_e,22,13,"div",17)(28,ue,18,0,"div",18),e.j41(29,"ion-modal",19),e.bIt("didDismiss",function(){return i.closeMapModal()}),e.DNE(30,Oe,18,7,"ng-template"),e.k0s()()),2&o&&(e.Y8G("fullscreen",!0),e.R7$(10),e.Y8G("ngIf",i.ongoingProjects.length>0),e.R7$(),e.Y8G("ngIf",i.ongoingProjects.length>0),e.R7$(9),e.R50("ngModel",i.selectedLocation),e.Y8G("disabled",!!i.selectedOngoingProject),e.R7$(),e.Y8G("ngForOf",i.knownSites),e.R7$(3),e.Y8G("ngIf",i.selectedOngoingProject),e.R7$(),e.Y8G("ngIf",i.showNewSiteForm),e.R7$(),e.Y8G("ngIf",i.isEditingSite),e.R7$(),e.Y8G("ngIf",i.showMap&&!i.isEditingSite),e.R7$(),e.Y8G("ngIf",!i.showMap&&!i.showNewSiteForm&&!i.selectedLocation),e.R7$(),e.Y8G("isOpen",i.isMapModalOpen))},dependencies:[O.Sq,O.bT,M.BC,M.vS,p.In,p.Jm,p.QW,p.b_,p.I9,p.ME,p.HW,p.tN,p.hU,p.W9,p.eU,p.iq,p.$w,p.uz,p.he,p.nf,p.JI,p.KO,p.f0,p.ln,p.Nm,p.Ip,p.BC,p.ai,p.Sb,p.Je,p.Gw,B.h,v.P,j.x,k.m,w.f,N.k,O.vh],styles:['@charset "UTF-8";.location-selection-bg[_ngcontent-%COMP%]{--background: #ffffff}.page-header[_ngcontent-%COMP%]{padding:1.25rem;box-shadow:0 2px 8px #52a67626;color:#fff}.page-header.emerald-gradient[_ngcontent-%COMP%]{background:#2d8659}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .back-icon[_ngcontent-%COMP%]{font-size:1.5rem;cursor:pointer;transition:transform .2s}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .back-icon[_ngcontent-%COMP%]:hover{transform:translate(-4px)}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-icon[_ngcontent-%COMP%]{font-size:1.75rem}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]{flex:1}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;margin:0 0 .25rem}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem;margin:0;opacity:.9}.selection-section[_ngcontent-%COMP%]{padding:1.25rem 1.25rem 1rem}.selection-section[_ngcontent-%COMP%]   .selection-card[_ngcontent-%COMP%]{border-radius:1rem;box-shadow:0 2px 6px #0000001a;margin:0}.selection-section[_ngcontent-%COMP%]   .selection-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:1.25rem}.selection-section[_ngcontent-%COMP%]   .selection-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#0d3d2f;margin:0 0 .4rem}.selection-section[_ngcontent-%COMP%]   .selection-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .card-subtitle[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7c7a;margin:0 0 1.25rem}.selection-section[_ngcontent-%COMP%]   .selection-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .location-select-item[_ngcontent-%COMP%]{--background: #ffffff;--border-radius: .75rem;--padding-start: 1rem;--padding-end: 1rem;--min-height: 48px;border:2px solid #4fb3bf;border-radius:.75rem;margin:0;display:flex;align-items:center}.selection-section[_ngcontent-%COMP%]   .selection-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .location-select-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{--padding-top: 0;--padding-bottom: 0;font-weight:500;color:#0d3d2f;width:100%}.map-section[_ngcontent-%COMP%]{padding:0 1.25rem 1.25rem}.map-section[_ngcontent-%COMP%]   .map-hint[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;background:linear-gradient(135deg,#52a676,#459465);color:#fff;padding:.75rem 1.5rem;border-radius:2rem;margin:0 auto 1rem;max-width:fit-content;box-shadow:0 2px 8px #52a6764d;font-weight:500;font-size:.9rem}.map-section[_ngcontent-%COMP%]   .map-hint[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem}.map-section[_ngcontent-%COMP%]   .map-card[_ngcontent-%COMP%]{border-radius:1rem;box-shadow:0 2px 6px #0000001a;margin:0 0 1rem;overflow:hidden;transition:all .3s ease}.map-section[_ngcontent-%COMP%]   .map-card[_ngcontent-%COMP%]   .map-content[_ngcontent-%COMP%]{padding:0;position:relative}.map-section[_ngcontent-%COMP%]   .map-card[_ngcontent-%COMP%]   .map-content[_ngcontent-%COMP%]   .map-hint[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;background:linear-gradient(135deg,#52a676,#459465);color:#fff;padding:.75rem 1.5rem;border-radius:2rem;margin:0 auto 1rem;max-width:fit-content;box-shadow:0 2px 8px #52a6764d;font-weight:500;font-size:.9rem}.map-section[_ngcontent-%COMP%]   .map-card[_ngcontent-%COMP%]   .map-content[_ngcontent-%COMP%]   .map-hint[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem}.map-section[_ngcontent-%COMP%]   .map-card[_ngcontent-%COMP%]   .map-content[_ngcontent-%COMP%]   .map-expand-button[_ngcontent-%COMP%]{position:absolute;bottom:1rem;right:1rem;background:#4fb3bff2;color:#fff;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #0003;z-index:10;cursor:pointer;transition:all .2s ease}.map-section[_ngcontent-%COMP%]   .map-card[_ngcontent-%COMP%]   .map-content[_ngcontent-%COMP%]   .map-expand-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.5rem}.map-section[_ngcontent-%COMP%]   .map-card[_ngcontent-%COMP%]   .map-content[_ngcontent-%COMP%]   .map-expand-button[_ngcontent-%COMP%]:hover{background:#4fb3bf;transform:scale(1.1)}.map-section[_ngcontent-%COMP%]   .map-card[_ngcontent-%COMP%]   .map-content[_ngcontent-%COMP%]   .map-expand-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.map-section[_ngcontent-%COMP%]   .map-card[_ngcontent-%COMP%]   .map-content[_ngcontent-%COMP%]   .site-map[_ngcontent-%COMP%]{width:100%;height:auto;display:block}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]{border-radius:1rem;box-shadow:0 2px 6px #0000001a;margin:0}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:1.25rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .details-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#0d3d2f;margin:0 0 1rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .site-description[_ngcontent-%COMP%]{color:#475569;font-size:.95rem;line-height:1.5;margin:0;padding:.5rem 0}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .detail-input-item[_ngcontent-%COMP%]{--background: #ffffff;--border-radius: .75rem;--padding-start: 1rem;--padding-end: 1rem;margin-bottom:1rem;border:1px solid #e0e0e0;border-radius:.75rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .detail-input-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--padding-top: .5rem;--padding-bottom: .5rem;font-weight:500;color:#0d3d2f}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .detail-input-item[_ngcontent-%COMP%]   .zone-display[_ngcontent-%COMP%]{padding:.25rem 0;margin-top:-.25rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .detail-input-item[_ngcontent-%COMP%]   .zone-display[_ngcontent-%COMP%]   .zone-name[_ngcontent-%COMP%]{font-size:.85rem;color:#0d3d2f;font-weight:600;background:#0d3d2f1a;padding:.25rem .5rem;border-radius:.25rem;display:inline-block}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .detail-input-item[_ngcontent-%COMP%]   .quad-display[_ngcontent-%COMP%]{padding:.25rem 0;margin-top:-.25rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .detail-input-item[_ngcontent-%COMP%]   .quad-display[_ngcontent-%COMP%]   .quad-name[_ngcontent-%COMP%]{font-size:.85rem;color:#0d3d2f;font-weight:600;background:#0d3d2f1a;padding:.25rem .5rem;border-radius:.25rem;display:inline-block}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .selection-warning[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem;background:#ffc1071a;border:1px solid rgba(255,193,7,.5);border-radius:.5rem;margin:.5rem 0;color:#856404;font-size:.9rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .selection-warning[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.25rem;flex-shrink:0}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .gps-button[_ngcontent-%COMP%]{--background: #e76f51;--border-radius: .75rem;font-weight:600;text-transform:none;margin-top:.5rem;margin-bottom:.5rem;height:3rem;font-size:.9rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .gps-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.25rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .gps-button[_ngcontent-%COMP%]:hover{--background: #d55a3c}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .add-site-button[_ngcontent-%COMP%]{--background: #2d8659;--border-radius: .75rem;font-weight:600;text-transform:none;margin-top:.5rem;height:3rem;font-size:.9rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .add-site-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.25rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .add-site-button[_ngcontent-%COMP%]:hover{--background: #246d49}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .coastal-blue-button[_ngcontent-%COMP%]{--background: #4fb3bf;--border-radius: .75rem;font-weight:600;text-transform:none;height:3rem;font-size:.9rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .coastal-blue-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.25rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .coastal-blue-button[_ngcontent-%COMP%]:hover{--background: #3d919c}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .start-button[_ngcontent-%COMP%]{--background: var(--fresh-leaf, #52a676);--border-radius: .75rem;font-weight:600;text-transform:none;margin-top:.5rem;height:3rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .start-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.25rem}.map-section[_ngcontent-%COMP%]   .details-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .start-button[_ngcontent-%COMP%]:disabled{--background: #cccccc;opacity:.5}.instructions-section[_ngcontent-%COMP%]{padding:0 1.25rem 1.5rem}.instructions-section[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]{border-radius:1rem;background:#4fb3bf1a;border:2px solid rgba(79,179,191,.3);box-shadow:none;margin:0}.instructions-section[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:1.25rem}.instructions-section[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .info-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;margin-bottom:.75rem}.instructions-section[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .info-header[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{font-size:1.25rem;color:#4fb3bf;flex-shrink:0}.instructions-section[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .info-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#0d3d2f;margin:0}.instructions-section[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;text-align:left}.instructions-section[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:#0d3d2f;font-size:.875rem;position:relative;padding:.4rem 0 .4rem 1.5rem}.instructions-section[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:"\\2022";color:#4fb3bf;font-weight:700;font-size:1.5rem;position:absolute;left:0;top:.25rem}.instructions-section[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#2d8659;font-weight:600}.instructions-section[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong.green-text[_ngcontent-%COMP%]{color:#2d8659}.map-modal-toolbar[_ngcontent-%COMP%]{--background: var(--fresh-leaf, #52a676);--color: white}.map-modal-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-weight:600}.map-modal-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--color: white}.map-modal-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.5rem}.map-modal-content[_ngcontent-%COMP%]{--background: #0d3d2f}.map-modal-content[_ngcontent-%COMP%]   .fullscreen-map-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:.5rem;overflow:auto}.map-modal-content[_ngcontent-%COMP%]   .fullscreen-map-container[_ngcontent-%COMP%]   .rotation-hint[_ngcontent-%COMP%]{display:none;align-items:center;gap:.5rem;color:#fffc;font-size:.875rem;margin-bottom:.75rem;font-style:italic}.map-modal-content[_ngcontent-%COMP%]   .fullscreen-map-container[_ngcontent-%COMP%]   .rotation-hint[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.25rem}@media screen and (max-width: 768px) and (orientation: portrait){.map-modal-content[_ngcontent-%COMP%]   .fullscreen-map-container[_ngcontent-%COMP%]   .rotation-hint[_ngcontent-%COMP%]{display:flex}}.map-modal-content[_ngcontent-%COMP%]   .fullscreen-map-container[_ngcontent-%COMP%]   .fullscreen-map[_ngcontent-%COMP%]{width:100%;height:auto;object-fit:contain;border-radius:.5rem;box-shadow:0 8px 24px #0000004d;touch-action:none;user-select:none;-webkit-user-select:none}@media screen and (orientation: landscape){.map-modal-content[_ngcontent-%COMP%]   .fullscreen-map-container[_ngcontent-%COMP%]   .fullscreen-map[_ngcontent-%COMP%]{width:100%;max-height:calc(100vh - 60px)}}@media screen and (orientation: portrait){.map-modal-content[_ngcontent-%COMP%]   .fullscreen-map-container[_ngcontent-%COMP%]   .fullscreen-map[_ngcontent-%COMP%]{width:100%;max-height:calc(100vh - 60px)}}.disabled-item[_ngcontent-%COMP%]{opacity:.6}.disabled-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--color: #999;--placeholder-color: #bbb}.add-site-button[_ngcontent-%COMP%]{--background: var(--fresh-leaf, #52a676);--background-hover: #459562;--background-activated: #3d7f54;margin-bottom:.5rem}.add-site-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:.5rem}.admin-edit-button[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:.75rem}.admin-edit-button[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: .5rem;font-size:.85rem;font-weight:500;text-transform:none}.edit-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:.5rem}.edit-header[_ngcontent-%COMP%]   .details-title[_ngcontent-%COMP%]{margin:0!important}.edit-header[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{font-size:.7rem;padding:.25rem .5rem}.button-row[_ngcontent-%COMP%]{margin-top:.75rem}.delete-row[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1rem;border-top:1px solid #eee}.photo-preview[_ngcontent-%COMP%], .map-preview[_ngcontent-%COMP%]{position:relative;margin-top:10px;text-align:center}.photo-preview[_ngcontent-%COMP%]   .preview-image[_ngcontent-%COMP%], .map-preview[_ngcontent-%COMP%]   .preview-image[_ngcontent-%COMP%]{max-width:100%;max-height:200px;border-radius:8px;box-shadow:0 2px 8px #0000001a}.photo-preview[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%], .map-preview[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;--background: rgba(255, 255, 255, .9);--color: #eb445a;--border-radius: 50%;width:36px;height:36px}.photo-preview[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .map-preview[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.ongoing-projects-card[_ngcontent-%COMP%]{border-radius:1rem;box-shadow:0 2px 6px #0000001a;margin:0;border-left:4px solid #52a676}.ongoing-projects-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#0d3d2f;margin:0;display:flex;align-items:center;gap:.5rem}.ongoing-projects-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]   .title-icon[_ngcontent-%COMP%]{color:#52a676;font-size:1.1rem}.ongoing-projects-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .card-subtitle[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7c7a;margin:.25rem 0 0}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]{--background: #f8faf9;--border-radius: .75rem;margin-bottom:.75rem;border-radius:.75rem}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   ion-radio[_ngcontent-%COMP%]{--color: #4fb3bf;--color-checked: #4fb3bf}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:600;color:#0d3d2f;font-size:.9rem;margin-bottom:3px}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .project-dates[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7c7a;display:flex;align-items:center;gap:4px;margin:0}@media (max-width: 767px){.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .project-dates[_ngcontent-%COMP%]{flex-wrap:wrap}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .project-dates[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{display:none}}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .project-dates[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:.85rem;color:#52a676}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .project-dates[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{margin:0 4px;color:#ccc}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .project-details[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:4px}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .project-details[_ngcontent-%COMP%]   .coastal-badge[_ngcontent-%COMP%]{background-color:#4fb3bf;color:#fff;font-size:.7rem}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .project-details[_ngcontent-%COMP%]   .species-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:.8rem;color:#6b7c7a}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .project-details[_ngcontent-%COMP%]   .species-info[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:.85rem;color:#52a676}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   .history-btn[_ngcontent-%COMP%]{--color: #2d8659}.ongoing-projects-card[_ngcontent-%COMP%]   .project-item[_ngcontent-%COMP%]   .history-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#2d8659}.location-select-item[_ngcontent-%COMP%]   .locked-note[_ngcontent-%COMP%]{font-size:.8rem;color:#52a676;display:flex;align-items:center;gap:4px;margin-top:4px}.or-divider[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 1.5rem;margin:.5rem 0}.or-divider[_ngcontent-%COMP%]:before, .or-divider[_ngcontent-%COMP%]:after{content:"";flex:1;height:1px;background:#ddd}.or-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0 1rem;font-size:.75rem;font-weight:600;color:#999;text-transform:uppercase;letter-spacing:.5px}']}))}return a(),l})()}];let be=(()=>{var a;class l{static#e=a=()=>(this.\u0275fac=function(o){return new(o||l)},this.\u0275mod=e.$C({type:l}),this.\u0275inj=c.G2t({imports:[b.iI.forChild(Me),b.iI]}))}return a(),l})(),Se=(()=>{var a;class l{static#e=a=()=>(this.\u0275fac=function(o){return new(o||l)},this.\u0275mod=e.$C({type:l}),this.\u0275inj=c.G2t({imports:[O.MD,M.YN,p.bv,be,v.P,j.x,k.m,w.f,N.k]}))}return a(),l})()}}]);