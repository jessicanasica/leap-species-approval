"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5369],{5369(kt,w,_){_.d(w,{OutplantingPageModule:()=>yt});var O=_(2200),h=_(4341),g=_(7343),x=_(8132),m=_(467),R=_(152),j=_(7762),S=_(4718),y=_(5083),k=_(5415),t=_(3664),u=_(2615),F=_(5921),E=_(3205),I=_(5735),N=_(918),D=_(9187),z=_(7643);const G=()=>({standalone:!0});function $(i,c){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const r=t.XpG();t.R7$(),t.SpI(" (edited: ",r.getEditedDateTime(),")")}}function T(i,c){1&i&&t.nrm(0,"ion-icon",50)}function A(i,c){if(1&i){const r=t.RV6();t.j41(0,"div",8),t.bIt("click",function(){u.eBV(r);const n=t.XpG();return u.Njj(!n.viewMode&&n.editZone())}),t.nrm(1,"ion-icon",51),t.j41(2,"span",10),t.EFF(3),t.k0s()()}if(2&i){let r;const e=t.XpG();t.R7$(3),t.JRh(e.getZoneName(null==(r=e.outplantingForm.get("zoneNumber"))?null:r.value))}}function V(i,c){if(1&i){const r=t.RV6();t.j41(0,"span",52),t.bIt("click",function(){u.eBV(r);const n=t.XpG();return u.Njj(n.editLocationAdmin())}),t.EFF(1," Edit location "),t.k0s()}}function X(i,c){1&i&&(t.j41(0,"ion-error",53),t.EFF(1," Location is required "),t.k0s())}function Y(i,c){if(1&i){const r=t.RV6();t.j41(0,"div",54)(1,"ion-button",55),t.bIt("click",function(){u.eBV(r);const n=t.XpG();return u.Njj(n.enableEditMode())}),t.nrm(2,"ion-icon",56),t.EFF(3," Edit This Entry "),t.k0s()()}}function L(i,c){1&i&&(t.j41(0,"div",57),t.nrm(1,"ion-icon",58),t.j41(2,"span"),t.EFF(3,"Editing Entry - Changes will replace the original submission"),t.k0s()())}function B(i,c){if(1&i&&(t.j41(0,"ion-card-subtitle"),t.EFF(1),t.k0s()),2&i){const r=t.XpG(2);t.R7$(),t.SpI(" Check-in #",r.currentSequenceNumber," for ongoing project ")}}function U(i,c){1&i&&(t.j41(0,"ion-note",69),t.nrm(1,"ion-icon",70),t.EFF(2," Outplanting activity will be marked as closed and removed from the active outplanting monitoring list. "),t.k0s())}function H(i,c){if(1&i){const r=t.RV6();t.j41(0,"ion-card",59)(1,"ion-card-header")(2,"ion-card-title"),t.EFF(3,"Project Status"),t.k0s(),t.DNE(4,B,2,1,"ion-card-subtitle",5),t.k0s(),t.j41(5,"ion-card-content")(6,"ion-item",60),t.nrm(7,"ion-icon",61),t.j41(8,"ion-label",62)(9,"h3",63),t.EFF(10,"Keep monitoring activity ongoing"),t.k0s(),t.j41(11,"p"),t.EFF(12,"Allow future check-ins for the outplanting at this specific location."),t.k0s(),t.j41(13,"p",64),t.EFF(14,"(Toggle off to close monitoring activity for this specific location.)"),t.k0s()(),t.j41(15,"div",65)(16,"strong",66),t.EFF(17),t.k0s(),t.j41(18,"ion-toggle",67),t.mxI("ngModelChange",function(n){u.eBV(r);const o=t.XpG();return t.DH7(o.isProjectOngoing,n)||(o.isProjectOngoing=n),u.Njj(n)}),t.k0s()()(),t.DNE(19,U,3,0,"ion-note",68),t.k0s()()}if(2&i){const r=t.XpG();t.R7$(4),t.Y8G("ngIf",r.isUpdatingProject),t.R7$(12),t.xc7("color",r.isProjectOngoing?"#2d8659":"#e76f51"),t.R7$(),t.SpI(" ",r.isProjectOngoing?"Ongoing":"Closed"," "),t.R7$(),t.R50("ngModel",r.isProjectOngoing),t.Y8G("ngModelOptions",t.lJ4(7,G)),t.R7$(),t.Y8G("ngIf",!r.isProjectOngoing)}}function q(i,c){1&i&&(t.j41(0,"p",71),t.nrm(1,"ion-icon",72),t.EFF(2," Tap to get current GPS location "),t.k0s())}function Z(i,c){if(1&i&&(t.j41(0,"p",73),t.nrm(1,"ion-icon",74),t.EFF(2),t.k0s()),2&i){const r=t.XpG();t.R7$(2),t.Lme(" ",r.coordinates.latitude.toFixed(6),", ",r.coordinates.longitude.toFixed(6)," ")}}function J(i,c){1&i&&(t.j41(0,"p",75),t.nrm(1,"ion-icon",76),t.EFF(2," GPS captured when creating new site "),t.k0s())}function Q(i,c){if(1&i&&(t.j41(0,"div",83)(1,"span",84),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",85),t.EFF(4),t.k0s()()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(4),t.JRh(e.lastReportData.individualsOutplanted[r]||0)}}function K(i,c){if(1&i){const r=t.RV6();t.j41(0,"ion-button",86),t.bIt("click",function(){u.eBV(r);const n=t.XpG().index,o=t.XpG();return u.Njj(o.decrementValue("individualsOutplanted",n))}),t.nrm(1,"ion-icon",87),t.k0s()}}function W(i,c){if(1&i&&t.nrm(0,"input",88),2&i){const r=t.XpG().index;t.Y8G("formControlName",r)}}function tt(i,c){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(),t.JRh(e.individualsOutplanted.at(r).value)}}function et(i,c){if(1&i){const r=t.RV6();t.j41(0,"ion-button",86),t.bIt("click",function(){u.eBV(r);const n=t.XpG().index,o=t.XpG();return u.Njj(o.incrementValue("individualsOutplanted",n))}),t.nrm(1,"ion-icon",89),t.k0s()}}function nt(i,c){if(1&i){const r=t.RV6();t.j41(0,"div",77)(1,"ion-item")(2,"div",78)(3,"ion-label")(4,"h3"),t.EFF(5),t.k0s(),t.j41(6,"p")(7,"em"),t.EFF(8),t.k0s()()(),t.j41(9,"ion-icon",79),t.bIt("click",function(n){const o=u.eBV(r).$implicit,a=t.XpG();return u.Njj(a.showMangroveInfo(n,o))}),t.k0s()(),t.j41(10,"div",46),t.DNE(11,Q,5,1,"div",37),t.j41(12,"div",80),t.DNE(13,K,2,0,"ion-button",81)(14,W,1,1,"input",82)(15,tt,2,1,"span",5)(16,et,2,0,"ion-button",81),t.k0s()()()()}if(2&i){const r=c.$implicit,e=t.XpG();t.R7$(5),t.JRh(r.scientificName),t.R7$(3),t.JRh(r.commonName),t.R7$(3),t.Y8G("ngIf",e.isUpdatingProject&&e.lastReportData),t.R7$(2),t.Y8G("ngIf",!e.viewMode),t.R7$(),t.Y8G("ngIf",!e.viewMode),t.R7$(),t.Y8G("ngIf",e.viewMode),t.R7$(),t.Y8G("ngIf",!e.viewMode)}}function ot(i,c){if(1&i&&(t.j41(0,"div",83)(1,"span",84),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",85),t.EFF(4),t.k0s()()),2&i){const r=t.XpG();t.R7$(4),t.JRh(r.lastIndividualsOutplantedTotal)}}function it(i,c){if(1&i&&(t.j41(0,"div",83)(1,"span",84),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",85),t.EFF(4),t.k0s()()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(4),t.SpI("",e.lastReportData.averageHeight[r]||0," cm")}}function at(i,c){if(1&i){const r=t.RV6();t.j41(0,"div",77)(1,"ion-item")(2,"div",78)(3,"ion-label")(4,"h3"),t.EFF(5),t.k0s(),t.j41(6,"p")(7,"em"),t.EFF(8),t.k0s()()(),t.j41(9,"ion-icon",79),t.bIt("click",function(n){const o=u.eBV(r).$implicit,a=t.XpG();return u.Njj(a.showMangroveInfo(n,o))}),t.k0s()(),t.j41(10,"div",90),t.DNE(11,it,5,1,"div",37),t.j41(12,"ion-input",91),t.bIt("ionChange",function(){const n=u.eBV(r).index,o=t.XpG();return u.Njj(o.onHeightChange(n))}),t.j41(13,"span",41),t.EFF(14,"cm"),t.k0s()()()()()}if(2&i){const r=c.$implicit,e=c.index,n=t.XpG();t.R7$(5),t.JRh(r.scientificName),t.R7$(3),t.JRh(r.commonName),t.R7$(3),t.Y8G("ngIf",n.isUpdatingProject&&n.lastReportData),t.R7$(),t.Y8G("formControl",n.averageHeight.at(e))("readonly",n.viewMode)}}function rt(i,c){if(1&i&&(t.j41(0,"div",83)(1,"span",84),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",85),t.EFF(4),t.k0s()()),2&i){const r=t.XpG();t.R7$(4),t.SpI("",r.lastAverageHeightOverall," cm")}}function st(i,c){if(1&i&&(t.j41(0,"div",83)(1,"span",84),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",85),t.EFF(4),t.k0s()()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(4),t.JRh(e.lastReportData.mortality[r]||0)}}function ct(i,c){if(1&i){const r=t.RV6();t.j41(0,"ion-button",86),t.bIt("click",function(){u.eBV(r);const n=t.XpG().index,o=t.XpG();return u.Njj(o.decrementValue("mortality",n))}),t.nrm(1,"ion-icon",87),t.k0s()}}function lt(i,c){if(1&i&&t.nrm(0,"input",88),2&i){const r=t.XpG().index;t.Y8G("formControlName",r)}}function dt(i,c){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(),t.JRh(e.mortality.at(r).value)}}function gt(i,c){if(1&i){const r=t.RV6();t.j41(0,"ion-button",86),t.bIt("click",function(){u.eBV(r);const n=t.XpG().index,o=t.XpG();return u.Njj(o.incrementValue("mortality",n))}),t.nrm(1,"ion-icon",89),t.k0s()}}function ut(i,c){if(1&i&&(t.j41(0,"div",77)(1,"ion-item")(2,"div",78)(3,"ion-label")(4,"h3"),t.EFF(5),t.k0s(),t.j41(6,"p")(7,"em"),t.EFF(8),t.k0s()()()(),t.j41(9,"div",46),t.DNE(10,st,5,1,"div",37),t.j41(11,"div",80),t.DNE(12,ct,2,0,"ion-button",81)(13,lt,1,1,"input",82)(14,dt,2,1,"span",5)(15,gt,2,0,"ion-button",81),t.k0s()()()()),2&i){const r=c.$implicit,e=t.XpG();t.R7$(5),t.JRh(r.scientificName),t.R7$(3),t.JRh(r.commonName),t.R7$(2),t.Y8G("ngIf",e.isUpdatingProject&&e.lastReportData),t.R7$(2),t.Y8G("ngIf",!e.viewMode),t.R7$(),t.Y8G("ngIf",!e.viewMode),t.R7$(),t.Y8G("ngIf",e.viewMode),t.R7$(),t.Y8G("ngIf",!e.viewMode)}}function pt(i,c){if(1&i&&(t.j41(0,"div",83)(1,"span",84),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",85),t.EFF(4),t.k0s()()),2&i){const r=t.XpG();t.R7$(4),t.JRh(r.lastMortalityTotal)}}function mt(i,c){if(1&i&&(t.j41(0,"div",99)(1,"span",84),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",100),t.EFF(4),t.k0s()()),2&i){const r=t.XpG().index,e=t.XpG();t.R7$(4),t.E5c(" ",null!=e.lastReportData.signsOfReproduction[r]&&e.lastReportData.signsOfReproduction[r].flowers?"\u{1f338}":"","",null!=e.lastReportData.signsOfReproduction[r]&&e.lastReportData.signsOfReproduction[r].fruits?"\u{1f347}":"","",null!=e.lastReportData.signsOfReproduction[r]&&e.lastReportData.signsOfReproduction[r].flowers||null!=e.lastReportData.signsOfReproduction[r]&&e.lastReportData.signsOfReproduction[r].fruits?"":"-"," ")}}function ft(i,c){if(1&i){const r=t.RV6();t.j41(0,"div",77)(1,"ion-item",92)(2,"div",78)(3,"ion-label")(4,"h3"),t.EFF(5),t.k0s(),t.j41(6,"p")(7,"em"),t.EFF(8),t.k0s()()(),t.j41(9,"ion-icon",79),t.bIt("click",function(n){const o=u.eBV(r).$implicit,a=t.XpG();return u.Njj(a.showMangroveInfo(n,o))}),t.k0s()(),t.j41(10,"div",93),t.DNE(11,mt,5,3,"div",94),t.j41(12,"div",95)(13,"div",96)(14,"ion-label"),t.EFF(15,"Flowers"),t.k0s(),t.nrm(16,"ion-checkbox",97),t.k0s(),t.j41(17,"div",96)(18,"ion-label"),t.EFF(19,"Fruits"),t.k0s(),t.nrm(20,"ion-checkbox",98),t.k0s()()()()()}if(2&i){const r=c.$implicit,e=c.index,n=t.XpG();t.R7$(),t.Y8G("formGroupName",e),t.R7$(4),t.JRh(r.scientificName),t.R7$(3),t.JRh(r.commonName),t.R7$(3),t.Y8G("ngIf",n.isUpdatingProject&&n.lastReportData)}}function _t(i,c){if(1&i&&(t.j41(0,"div",83)(1,"span",84),t.EFF(2,"Last:"),t.k0s(),t.j41(3,"span",85),t.EFF(4),t.k0s()()),2&i){const r=t.XpG();t.R7$(4),t.JRh(r.lastReproductionSpeciesCount)}}function ht(i,c){if(1&i){const r=t.RV6();t.j41(0,"div",101)(1,"ion-button",102),t.nrm(2,"ion-icon",103),t.EFF(3," Submit Outplanting Monitoring "),t.k0s(),t.j41(4,"ion-button",104),t.bIt("click",function(){u.eBV(r);const n=t.XpG();return u.Njj(n.saveDraft())}),t.nrm(5,"ion-icon",105),t.EFF(6," Save Draft "),t.k0s(),t.j41(7,"ion-button",106),t.bIt("click",function(){u.eBV(r);const n=t.XpG();return u.Njj(n.discardForm())}),t.nrm(8,"ion-icon",107),t.EFF(9," Discard "),t.k0s()()}if(2&i){const r=t.XpG();t.R7$(),t.Y8G("disabled",!r.outplantingForm.valid)}}function bt(i,c){if(1&i){const r=t.RV6();t.j41(0,"div",108)(1,"ion-button",109),t.bIt("click",function(){u.eBV(r);const n=t.XpG();return u.Njj(n.deleteEntry())}),t.nrm(2,"ion-icon",107),t.EFF(3," Delete Entry "),t.k0s()()}}function vt(i,c){if(1&i){const r=t.RV6();t.j41(0,"span",17),t.bIt("click",function(){const n=u.eBV(r).index,o=t.XpG(2);return u.Njj(o.goTo(n))}),t.k0s()}if(2&i){const r=c.index,e=t.XpG(2);t.AVh("active",r===e.currentIndex)}}function Ot(i,c){if(1&i){const r=t.RV6();t.j41(0,"div",11)(1,"button",12),t.bIt("click",function(){u.eBV(r);const n=t.XpG();return u.Njj(n.previous())}),t.nrm(2,"ion-icon",13),t.k0s(),t.j41(3,"div",14),t.DNE(4,vt,1,2,"span",15),t.k0s(),t.j41(5,"button",12),t.bIt("click",function(){u.eBV(r);const n=t.XpG();return u.Njj(n.next())}),t.nrm(6,"ion-icon",16),t.k0s()()}if(2&i){const r=t.XpG();t.R7$(4),t.Y8G("ngForOf",r.getImages())}}let Pt=(()=>{var i;class c{forceDeleteDraftFile(e){var n=this;return(0,m.A)(function*(){for(let o=0;o<3;o++)try{yield n.sharedDataService.deleteJsonFile(e),console.log(`Draft file force deleted successfully (attempt ${o+1})`);break}catch(a){if(console.error(`Error force deleting draft file (attempt ${o+1}):`,a),2===o)try{yield n.sharedDataService.writeJsonFile(e,null),console.log("Draft file cleared with null write")}catch(s){console.error("Failed to clear draft file with null write:",s)}yield new Promise(s=>setTimeout(s,100))}})()}constructor(e,n,o,a,s,l,d,p,f,b,v){this.formBuilder=e,this.alertController=n,this.loadingController=o,this.router=a,this.route=s,this.modalController=l,this.auth=d,this.outplantingSyncService=p,this.sharedDataService=f,this.entryDeletionService=b,this.siteSyncService=v,this.progress=0,this.currentDateTime="",this.viewMode=!1,this.currentUser=null,this.currentReportId="",this.loadedReport=null,this.coordinates=null,this.gpsFromLocation=!1,this.autosaveSub=null,this.isDiscarded=!1,this.isSubmitted=!1,this.isSubmitting=!1,this.isEditMode=!1,this.originalSubmittedBy="",this.isProjectOngoing=!0,this.isUpdatingProject=!1,this.currentProjectKey=null,this.currentSequenceNumber=1,this.parentReportId=null,this.lastReportData=null,this.mangroveSpecies=[{scientificName:"Mangliye Rouz",commonName:"Red Mangrove",latinName:"Rhizophora mucronata",imagePath:["assets/mangroves/Red-Man.webp","assets/mangroves/Red mangrove1.webp","assets/mangroves/Red mangrove2.webp"]},{scientificName:"Mangliye Blan",commonName:"White Mangrove",latinName:"Avicennia marina",imagePath:["assets/mangroves/White-Man.webp","assets/mangroves/White mangrove1.webp","assets/mangroves/White mangrove2.webp"]},{scientificName:"Mangliye Zonn",commonName:"Yellow Mangrove",latinName:"Ceriops tagal",imagePath:["assets/mangroves/Yellow-Man.webp","assets/mangroves/Yellow mangrove1.webp","assets/mangroves/Yellow mangrove2.webp"]},{scientificName:"Mangliye Pti Fey",commonName:"Black Mangrove",latinName:"Lumnitzera racemosa",imagePath:["assets/mangroves/Black-Man.webp","assets/mangroves/Black mangrove.webp"]},{scientificName:"Mangliye Lat",commonName:"Oriental Mangrove",latinName:"Bruguiera gymnorrhiza",imagePath:["assets/mangroves/Oriental-Man.webp","assets/mangroves/Oriental mangrove1.webp","assets/mangroves/Oriental mangrove2.webp"]},{scientificName:"Mangliye Fler",commonName:"Apple Mangrove",latinName:"Sonneratia alba",imagePath:["assets/mangroves/Apple-Man.webp","assets/mangroves/Apple mangrove.webp"]},{scientificName:"Mangliye Pasyans",commonName:"Puzzlenut Mangrove",latinName:"Xylocarpus granatum",imagePath:["assets/mangroves/Puzzlenut-Man.webp","assets/mangroves/Puzzlenut mangrove.webp"]}],this.availableLocations=[{name:"Ramsar",hasZones:!0,hasQuads:!1,zones:["1","2","3","4","5","6"],quads:[]},{name:"Grand Anse",hasZones:!0,hasQuads:!1,zones:["1","2","3","4"],quads:[]},{name:"Caiman",hasZones:!1,hasQuads:!1,zones:[],quads:[]},{name:"Canopy",hasZones:!1,hasQuads:!1,zones:[],quads:[]},{name:"Petit Barbarons",hasZones:!0,hasQuads:!1,zones:["1","2","3","4"],quads:[]},{name:"Kempinski",hasZones:!1,hasQuads:!1,zones:[],quads:[]},{name:"Roche Caiman",hasZones:!1,hasQuads:!1,zones:[],quads:[]}]}ngOnInit(){var e=this;return(0,m.A)(function*(){e.currentUser=e.auth.getCurrentUser(),e.initializeForm(),e.setCurrentDateTime(),yield e.loadDynamicSites();const n=e.route.snapshot.queryParams;if("true"!==n.viewMode||!n.reportId)return"true"===n.editMode&&n.reportId?(yield e.loadReportForViewing(n.reportId),void e.enableEditMode()):(e.route.queryParams.subscribe(function(){var o=(0,m.A)(function*(a){a.location&&e.outplantingForm.patchValue({siteLocation:a.location}),a.zone&&e.outplantingForm.patchValue({zoneNumber:a.zone}),a.lat&&a.lng&&(e.coordinates={latitude:parseFloat(a.lat),longitude:parseFloat(a.lng)},e.gpsFromLocation=!0,e.updateProgress()),a.projectKey&&(e.isUpdatingProject=!0,yield e.loadProjectForContinuation(a.projectKey))});return function(a){return o.apply(this,arguments)}}()),"true"!==n.fresh&&(yield e.restoreDraftIfAny(),e.setCurrentDateTime()),e.currentReportId||(e.currentReportId=e.outplantingSyncService.generateReportId()),e.subscribeToFormChanges(),void(navigator.onLine&&e.outplantingSyncService.processPendingQueue().catch(o=>{console.error("OutplantingPage: processPendingQueue failed:",o)})));yield e.loadReportForViewing(n.reportId)})()}ngOnDestroy(){this.autosaveSub&&(this.autosaveSub.unsubscribe(),this.autosaveSub=null),this.isSubmitted||this.saveDraftOnExit().catch(e=>console.error("OutplantingPage: saveDraftOnExit failed:",e))}setCurrentDateTime(e){if(this.outplantingForm){const p=this.outplantingForm.get("date")?.value,f=this.outplantingForm.get("observationTime")?.value;if(p&&f){const[b,v,P]=p.split("-"),[C,M]=f.split(":");return void(this.currentDateTime=`${P}/${v}/${b}  \u2022  ${C}:${M}`)}}if(e){const p=this.extractDateTimeFromReportId(e);if(p)return void(this.currentDateTime=p)}const n=new Date,o=String(n.getDate()).padStart(2,"0"),a=String(n.getMonth()+1).padStart(2,"0"),s=n.getFullYear(),l=String(n.getHours()).padStart(2,"0"),d=String(n.getMinutes()).padStart(2,"0");this.currentDateTime=`${o}/${a}/${s}  \u2022  ${l}:${d}`}extractDateTimeFromReportId(e){const n=e.match(/(\d{2})(\d{2})(\d{4})_(\d{2})(\d{2})(\d{2})/);if(n){const[,o,a,s,l,d]=n;return`${o}/${a}/${s}  \u2022  ${l}:${d}`}return null}getCurrentDate(){return(new Date).toISOString().split("T")[0]}editLocation(){var e=this;return(0,m.A)(function*(){yield(yield e.alertController.create({header:"Site Location",inputs:[{name:"siteLocation",type:"text",placeholder:"Enter site location",value:e.outplantingForm.get("siteLocation")?.value||""}],buttons:[{text:"Cancel",role:"cancel"},{text:"Save",handler:o=>{e.outplantingForm.patchValue({siteLocation:o.siteLocation})}}]})).present()})()}editZone(){var e=this;return(0,m.A)(function*(){yield(yield e.alertController.create({header:"Zone Number",inputs:[{name:"zoneNumber",type:"text",placeholder:"Enter zone number",value:e.outplantingForm.get("zoneNumber")?.value||""}],buttons:[{text:"Cancel",role:"cancel"},{text:"Save",handler:o=>{e.outplantingForm.patchValue({zoneNumber:o.zoneNumber})}}]})).present()})()}getZoneName(e){return e?`Zone ${e}`:""}locationHasZones(){const e=this.outplantingForm.get("siteLocation")?.value;return!!e&&["Ramsar","Grand Anse","Petit Barbarons"].includes(e)}locationHasQuads(){const e=this.outplantingForm.get("siteLocation")?.value;return!!e&&["Ramsar","Grand Anse","Caiman","Canopy"].includes(e)}getQuadDisplay(e){if(!e)return"";const n=e.match(/\d+/);return n?n[0]:""}editLocationAdmin(){var e=this;return(0,m.A)(function*(){if(!e.currentUser||e.currentUser.level<4)return;const n=yield e.selectLocationStep();if(!n)return;const o=e.availableLocations.find(s=>s.name===n);let a="";if(o?.hasZones&&o.zones.length>0){const s=yield e.selectZoneStep(o);if(null===s)return;a=s}e.outplantingForm.patchValue({siteLocation:n,zoneNumber:a}),e.isEditMode&&e.outplantingForm.markAsDirty()})()}selectLocationStep(){var e=this;return new Promise(function(){var n=(0,m.A)(function*(o){const a=e.outplantingForm.get("siteLocation")?.value||"",s=e.availableLocations.map(d=>({name:"location",type:"radio",label:d.name,value:d.name,checked:d.name===a}));yield(yield e.alertController.create({header:"Select Location",cssClass:"location-edit-alert",inputs:s,buttons:[{text:"Cancel",role:"cancel",handler:()=>o(null)},{text:"Next",handler:d=>o(d)}]})).present()});return function(o){return n.apply(this,arguments)}}())}selectZoneStep(e){var n=this;return new Promise(function(){var o=(0,m.A)(function*(a){const s=n.outplantingForm.get("zoneNumber")?.value||"",l=e.zones.map(p=>({name:"zone",type:"radio",label:`Zone ${p}`,value:p,checked:p===s}));yield(yield n.alertController.create({header:"Select Zone",subHeader:e.name,cssClass:"location-edit-alert",inputs:l,buttons:[{text:"Cancel",role:"cancel",handler:()=>a(null)},{text:"Save",handler:p=>a(p)}]})).present()});return function(a){return o.apply(this,arguments)}}())}loadDynamicSites(){var e=this;return(0,m.A)(function*(){try{(yield e.siteSyncService.getAllSites()).forEach(o=>{e.availableLocations.some(a=>a.name===o.name)||e.availableLocations.push({name:o.name,hasZones:o.zones&&o.zones.length>0||!1,hasQuads:o.sample_points&&o.sample_points.length>0||!1,zones:o.zones?o.zones.map(a=>a.name?.replace("Zone ","")||a.id):[],quads:o.sample_points?o.sample_points.map(a=>a.id||a.label):[]})})}catch(n){console.error("Error loading dynamic sites:",n)}})()}getGPSCoordinates(){var e=this;return(0,m.A)(function*(){try{const n=yield e.loadingController.create({message:"Getting GPS coordinates..."});yield n.present();const o=yield j.L.getCurrentPosition({enableHighAccuracy:!0,timeout:15e3,maximumAge:0});e.coordinates={latitude:o.coords.latitude,longitude:o.coords.longitude},yield n.dismiss(),e.updateProgress(),yield(yield e.alertController.create({header:"GPS Captured",message:`Location: ${e.coordinates.latitude.toFixed(6)}, ${e.coordinates.longitude.toFixed(6)}`,buttons:["OK"]})).present()}catch(n){console.error("Error getting GPS coordinates:",n),yield(yield e.alertController.create({header:"GPS Error",message:"Failed to get GPS coordinates. Please ensure location services are enabled and try again.",buttons:["OK"]})).present()}})()}initializeForm(){const e=this.getCurrentDate(),n=new Date,o=`${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`;this.outplantingForm=this.formBuilder.group({siteLocation:["",h.k0.required],zoneNumber:[""],quadNumber:"",totalArea:[""],areaRestored:[""],date:[e,h.k0.required],observationTime:[o],individualsOutplanted:this.formBuilder.array(this.mangroveSpecies.map(()=>[null])),averageHeight:this.formBuilder.array(this.mangroveSpecies.map(()=>[null])),mortality:this.formBuilder.array(this.mangroveSpecies.map(()=>[null])),signsOfReproduction:this.formBuilder.array(this.mangroveSpecies.map(()=>this.formBuilder.group({flowers:[!1],fruits:[!1]}))),notes:[""]}),this.updateProgress()}get individualsOutplanted(){return this.outplantingForm.get("individualsOutplanted")}get averageHeight(){return this.outplantingForm.get("averageHeight")}get mortality(){return this.outplantingForm.get("mortality")}get signsOfReproduction(){return this.outplantingForm.get("signsOfReproduction")}get individualsOutplantedTotal(){return this.individualsOutplanted.value.reduce((e,n)=>e+(Number(n)||0),0)}get averageHeightOverall(){const e=this.averageHeight.value.filter(o=>o>0);return 0===e.length?"0.0":(e.reduce((o,a)=>o+(Number(a)||0),0)/e.length).toFixed(1)}get mortalityTotal(){return this.mortality.value.reduce((e,n)=>e+(Number(n)||0),0)}get reproductionCount(){return this.signsOfReproduction.value.filter(e=>e.flowers||e.fruits).length}updateProgress(){const e=this.outplantingForm.value;let n=0,o=2;e.siteLocation&&n++,e.date&&n++,e.totalArea&&(n++,o++),e.areaRestored&&(n++,o++),this.coordinates&&(n++,o++),this.individualsOutplantedTotal>0&&(n++,o++),this.averageHeight.value.some(s=>s>0)&&(n++,o++),this.mortalityTotal>0&&(n++,o++),this.reproductionCount>0&&(n++,o++),e.notes&&(n++,o++),this.progress=o>0?n/o:0}subscribeToFormChanges(){this.autosaveSub&&this.autosaveSub.unsubscribe(),this.autosaveSub=this.outplantingForm.valueChanges.pipe((0,R.B)(750)).subscribe(()=>{this.isSubmitted||(this.updateProgress(),this.saveDraftOnExit().catch(e=>console.error("OutplantingPage: autosave failed:",e)))})}incrementValue(e,n,o=1){const a=this.outplantingForm.get(e);if(a&&a.at(n)){const s=a.at(n).value||0;a.at(n).setValue(Number((s+o).toFixed(1)))}}decrementValue(e,n,o=1){const a=this.outplantingForm.get(e);if(a&&a.at(n)){const s=a.at(n).value||0;s>0&&a.at(n).setValue(Math.max(0,Number((s-o).toFixed(1))))}}onHeightChange(e){const n=this.averageHeight.at(e).value;if(null!=n){const o=Number(n);!isNaN(o)&&o>=0?this.averageHeight.at(e).setValue(Number(o.toFixed(1))):this.averageHeight.at(e).setValue(0)}}onSubmit(){var e=this;return(0,m.A)(function*(){if(e.isSubmitting)return;if(e.isSubmitting=!0,e.outplantingForm.markAllAsTouched(),!e.outplantingForm.valid)return e.isSubmitting=!1,void(yield(yield e.alertController.create({header:"Incomplete Form",message:"Please fill in all required fields (Location and Date).",buttons:["OK"]})).present());e.isSubmitted=!0,e.autosaveSub&&(e.autosaveSub.unsubscribe(),e.autosaveSub=null);const n=yield e.loadingController.create({message:"Submitting outplanting data..."});yield n.present();try{const o={...e.outplantingForm.value,individualsOutplantedTotal:e.individualsOutplantedTotal,averageHeightOverall:e.averageHeightOverall,mortalityTotal:e.mortalityTotal,reproductionCount:e.reproductionCount};o.status={incomplete:!1,sent:!0,pending:!1};let a=e.currentProjectKey;if(!a){const f=o.siteLocation||"Unknown",b=o.zoneNumber||"",v=o.quadNumber||"";a=`OUTP${Array.from({length:3},()=>String.fromCharCode(65+Math.floor(26*Math.random()))).join("")}_${f.replace(/[^a-zA-Z0-9]/g,"_")}${b?"_Zone"+b:""}${v?"_Quad"+v:""}`}const s={formValue:o,coordinates:e.coordinates,photos:[],project_key:a,sequence_number:e.currentSequenceNumber,parent_report_id:e.parentReportId||void 0,is_ongoing:e.isProjectOngoing,existingReportId:e.currentReportId||void 0};e.isEditMode&&(s.originalSubmittedBy=e.originalSubmittedBy);const l=yield e.outplantingSyncService.submitFinal(s);yield n.dismiss();try{e.autosaveSub&&(e.autosaveSub.unsubscribe(),e.autosaveSub=null),yield new Promise(M=>setTimeout(M,1e3));const f=e.outplantingForm.value;yield e.outplantingSyncService.clearDraft(f);const b=(f?.location||"unknown").replace(/[^a-zA-Z0-9]/g,"_"),v=f?.zoneNumber||"",P=f?.quadNumber||"";let C=`outplanting_draft_${b}`;v&&(C+=`_zone${v}`),P&&(C+=`_quad${P}`),yield e.forceDeleteDraftFile(`${C}.json`),e.isSubmitted=!0,console.log("OutplantingPage: Draft cleared and form reset successfully")}catch(f){console.error("OutplantingPage: Failed to clear draft:",f)}const d=e.isEditMode?l.queued?"Updated data saved locally and queued for upload when online.":"Outplanting data updated successfully!":l.queued?"Outplanting data saved locally and queued for upload when online.":"Outplanting data submitted successfully!";yield(yield e.alertController.create({header:"Success",message:d,buttons:[{text:"OK",handler:()=>{e.router.navigate(["/health"])}}]})).present()}catch(o){yield n.dismiss(),console.error("Error submitting outplanting data:",o),yield(yield e.alertController.create({header:"Error",message:"Failed to submit outplanting data. Please try again.",buttons:["OK"]})).present()}})()}discardForm(){var e=this;return(0,m.A)(function*(){var o;yield(yield e.alertController.create({header:"Discard Form",message:"Are you sure you want to discard this form? All entered data will be lost.",buttons:[{text:"Cancel",role:"cancel"},{text:"Discard",role:"destructive",handler:(o=(0,m.A)(function*(){e.isDiscarded=!0,e.autosaveSub&&(e.autosaveSub.unsubscribe(),e.autosaveSub=null),yield new Promise(f=>setTimeout(f,1e3));const a=e.outplantingForm.value;yield e.outplantingSyncService.clearDraft(a);const s=(a?.location||"unknown").replace(/[^a-zA-Z0-9]/g,"_"),l=a?.zoneNumber||"",d=a?.quadNumber||"";let p=`outplanting_draft_${s}`;l&&(p+=`_zone${l}`),d&&(p+=`_quad${d}`),yield e.forceDeleteDraftFile(`${p}.json`),yield new Promise(f=>setTimeout(f,200)),e.initializeForm(),e.router.navigate(["/health"])}),function(){return o.apply(this,arguments)})}]})).present()})()}restoreDraftIfAny(){var e=this;return(0,m.A)(function*(){const n=e.route.snapshot.queryParams,o={location:n.location||e.outplantingForm.get("location")?.value,zoneNumber:n.zone||e.outplantingForm.get("zoneNumber")?.value,quadNumber:n.quad||e.outplantingForm.get("quadNumber")?.value},a=yield e.outplantingSyncService.loadDraft(o);if(a)try{a.reportId&&(e.currentReportId=a.reportId),a.form&&e.outplantingForm.patchValue(a.form),e.coordinates=a.coordinates||null,e.updateProgress()}catch(s){console.error("OutplantingPage: failed to restore draft:",s)}})()}saveDraft(){var e=this;return(0,m.A)(function*(){var o;e.outplantingForm&&(yield(yield e.alertController.create({header:"Save Draft",message:"Are you sure you want to save this form as a draft? You can return to complete it later.",buttons:[{text:"Cancel",role:"cancel"},{text:"Save Draft",handler:(o=(0,m.A)(function*(){try{yield e.saveDraftOnExit(),yield(yield e.alertController.create({header:"Draft Saved",message:"Your form has been saved as a draft. You can access it from the health page.",buttons:[{text:"OK",handler:()=>{e.router.navigate(["/health"])}}]})).present()}catch(a){console.error("Failed to save draft:",a),yield(yield e.alertController.create({header:"Save Failed",message:"Failed to save the draft. Please try again.",buttons:["OK"]})).present()}}),function(){return o.apply(this,arguments)})}]})).present())})()}saveDraftOnExit(){var e=this;return(0,m.A)(function*(){if(!e.outplantingForm||e.viewMode||e.isDiscarded||e.isSubmitted)return;const n=e.outplantingForm.value;(n?.siteLocation||e.individualsOutplantedTotal>0||e.mortalityTotal>0)&&(yield e.outplantingSyncService.saveDraft({reportId:e.currentReportId,form:{...n,individualsOutplantedTotal:e.individualsOutplantedTotal,averageHeightOverall:e.averageHeightOverall,mortalityTotal:e.mortalityTotal,reproductionCount:e.reproductionCount},coordinates:null,photos:[]}))})()}showMangroveInfo(e,n){var o=this;return(0,m.A)(function*(){if(e.stopPropagation(),y.Ii.isNativePlatform())try{yield k.Z.lock({orientation:"portrait"})}catch{}const a=yield o.modalController.create({component:Ct,componentProps:{species:n},cssClass:"fullheight-info-modal"});a.onDidDismiss().then((0,m.A)(function*(){if(y.Ii.isNativePlatform())try{yield k.Z.unlock()}catch{}})),yield a.present()})()}setViewMode(e){this.viewMode=e,e?(this.outplantingForm.disable(),this.enableCheckboxControls()):this.outplantingForm.enable()}enableEditMode(){!this.currentUser||this.currentUser.level<4||(this.isEditMode=!0,this.viewMode=!1,this.outplantingForm.enable(),this.originalSubmittedBy=this.loadedReport?.submittedBy||"")}getEditedDateTime(){if(!this.loadedReport)return null;let e=this.loadedReport.editedAt||null;if(!e){const p=this.loadedReport.updatedAt,f=this.loadedReport.createdAt;p&&f&&p!==f&&Math.abs(new Date(p).getTime()-new Date(f).getTime())>5e3&&(e=p)}if(!e)return null;const n=new Date(e);return isNaN(n.getTime())?null:`${n.getDate().toString().padStart(2,"0")}/${(n.getMonth()+1).toString().padStart(2,"0")}/${n.getFullYear()} ${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`}enableCheckboxControls(){const e=this.outplantingForm.get("species");e&&e.controls.forEach(n=>{n.get("flowers")?.enable(),n.get("fruits")?.enable()})}loadReportForViewing(e){var n=this;return(0,m.A)(function*(){try{const o=yield n.outplantingSyncService.getAllReports();console.log("OutplantingPage: All reports:",o);const a=o.find(l=>l.report.reportId===e);if(!a)return console.error("OutplantingPage: Report not found for viewing:",e),yield(yield n.alertController.create({header:"Report Not Found",message:"The requested report could not be found.",buttons:["OK"]})).present(),void n.router.navigate(["/health"]);const s=a.report;if(console.log("OutplantingPage: Loading report for viewing:",s),n.loadedReport=s,n.outplantingForm.patchValue({siteLocation:s.form.siteLocation||"",date:s.form.date||"",observationTime:s.form.observationTime||"",zoneNumber:s.form.zoneNumber||"",notes:s.form.notes||""}),s.form.individualsOutplanted&&Array.isArray(s.form.individualsOutplanted)){const l=n.outplantingForm.get("individualsOutplanted");s.form.individualsOutplanted.forEach((d,p)=>{l.at(p)&&l.at(p).patchValue(void 0!==d?d:null)})}if(s.form.averageHeight&&Array.isArray(s.form.averageHeight)){const l=n.outplantingForm.get("averageHeight");s.form.averageHeight.forEach((d,p)=>{l.at(p)&&l.at(p).patchValue(void 0!==d?d:null)})}if(s.form.mortality&&Array.isArray(s.form.mortality)){const l=n.outplantingForm.get("mortality");s.form.mortality.forEach((d,p)=>{l.at(p)&&l.at(p).patchValue(void 0!==d?d:null)})}if(s.form.reproduction&&Array.isArray(s.form.reproduction)){const l=n.outplantingForm.get("reproduction");s.form.reproduction.forEach((d,p)=>{l.at(p)&&l.at(p).patchValue(void 0!==d?d:null)})}s.coordinates&&(n.coordinates=s.coordinates),n.currentReportId=e,n.setCurrentDateTime(e),n.updateProgress(),n.setViewMode(!0)}catch(o){console.error("OutplantingPage: Error loading report for viewing:",o),yield(yield n.alertController.create({header:"Error",message:"Failed to load the report.",buttons:["OK"]})).present(),n.router.navigate(["/health"])}})()}deleteEntry(){var e=this;return(0,m.A)(function*(){const n=e.auth.getCurrentUser();var a;!n||n.level<4?yield(yield e.alertController.create({header:"Permission Denied",message:"Only Level 4 users can delete entries.",buttons:["OK"]})).present():yield(yield e.alertController.create({header:"Delete Entry",message:"Are you sure you want to permanently delete this entry? This will remove it from the database and back it up to deleted files storage. This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:(a=(0,m.A)(function*(){yield e.performDeletion()}),function(){return a.apply(this,arguments)})}]})).present()})()}performDeletion(){var e=this;return(0,m.A)(function*(){const n=yield e.loadingController.create({message:"Deleting entry..."});yield n.present();try{const o=e.auth.getCurrentUser();yield e.entryDeletionService.deleteEntry({reportId:e.currentReportId,formType:"outplanting",tableName:"outplanting_reports",deletedBy:o?.username||"Unknown",deletedByEmail:o?.email||"",originalSubmittedBy:e.loadedReport?.submittedBy,originalSubmittedAt:e.loadedReport?.createdAt}),yield n.dismiss(),yield(yield e.alertController.create({header:"Success",message:"Entry has been deleted and backed up successfully.",buttons:[{text:"OK",handler:()=>{e.router.navigate(["/health"])}}]})).present()}catch(o){yield n.dismiss(),console.error("Error deleting entry:",o),yield(yield e.alertController.create({header:"Error",message:"Failed to delete entry. Please try again.",buttons:["OK"]})).present()}})()}loadProjectForContinuation(e){var n=this;return(0,m.A)(function*(){try{const a=(yield n.outplantingSyncService.getAllReports()).filter(d=>d.report.project_key===e||d.report.reportId===e);if(0===a.length)return void console.error("OutplantingPage: No reports found for project:",e);const l=a.reduce((d,p)=>(p.report.sequence_number||1)>(d.report.sequence_number||1)?p:d).report;console.log("OutplantingPage: Loading project for continuation:",l),n.currentProjectKey=e,n.currentSequenceNumber=(l.sequence_number||1)+1,n.parentReportId=l.reportId,n.isProjectOngoing=!1!==l.is_ongoing,n.lastReportData={individualsOutplanted:l.form.individualsOutplanted||n.mangroveSpecies.map(()=>null),averageHeight:l.form.averageHeight||n.mangroveSpecies.map(()=>null),mortality:l.form.mortality||n.mangroveSpecies.map(()=>null),signsOfReproduction:l.form.signsOfReproduction||n.mangroveSpecies.map(()=>({flowers:!1,fruits:!1})),notes:l.form.notes||"",date:l.form.date||""},n.outplantingForm.patchValue({siteLocation:l.form.siteLocation||"",date:n.getCurrentDate(),zoneNumber:l.form.zoneNumber||"",quadNumber:l.form.quadNumber||"",totalArea:l.form.totalArea||"",areaRestored:l.form.areaRestored||"",notes:""})}catch(o){console.error("OutplantingPage: Error loading project for continuation:",o)}})()}get lastIndividualsOutplantedTotal(){return this.lastReportData?.individualsOutplanted.reduce((e,n)=>e+(Number(n)||0),0)||0}get lastAverageHeightOverall(){if(!this.lastReportData)return"0.0";const e=this.lastReportData.averageHeight.filter(o=>Number(o)>0);return 0===e.length?"0.0":(e.reduce((o,a)=>o+(Number(a)||0),0)/e.length).toFixed(1)}get lastMortalityTotal(){return this.lastReportData?.mortality.reduce((e,n)=>e+(Number(n)||0),0)||0}get lastReproductionSpeciesCount(){return this.lastReportData?.signsOfReproduction?this.lastReportData.signsOfReproduction.filter(e=>!0===e.flowers||!0===e.fruits).length:0}static#t=i=()=>(this.\u0275fac=function(n){return new(n||c)(t.rXU(h.ok),t.rXU(g.hG),t.rXU(g.Xi),t.rXU(F.Ix),t.rXU(F.nX),t.rXU(g.W3),t.rXU(E.N),t.rXU(I.Q),t.rXU(N.H),t.rXU(D.C),t.rXU(z.k))},this.\u0275cmp=t.VBU({type:c,selectors:[["app-outplanting"]],standalone:!1,decls:133,vars:37,consts:[[1,"outplanting-green"],["slot","start"],["defaultHref","/health"],[1,"outplanting-green","compact-toolbar"],[1,"date-time-text"],[4,"ngIf"],[1,"outplanting-green","metadata-toolbar"],[1,"metadata-container"],[1,"metadata-item",3,"click"],["name","location",1,"metadata-icon"],[1,"metadata-label"],["name","alert-circle","class","status-icon required",4,"ngIf"],["class","metadata-item",3,"click",4,"ngIf"],["class","edit-location-link",3,"click",4,"ngIf"],["style","padding: 0 16px; font-size: 0.75rem; color: #e76f51;",4,"ngIf"],["color","light",3,"value"],[1,"progress-text"],[3,"ngSubmit","formGroup"],["class","edit-mode-banner",4,"ngIf"],["class","edit-mode-banner editing",4,"ngIf"],["class","status-card",4,"ngIf"],[1,"gps-card"],["lines","none",1,"gps-item",3,"click","button"],["slot","start",1,"gps-icon-container"],["name","navigate",3,"color"],[1,"gps-title"],["class","gps-hint",4,"ngIf"],["class","coordinates-text",4,"ngIf"],["class","gps-source-hint",4,"ngIf"],["position","stacked"],["formControlName","totalArea","type","text","placeholder","Optional"],["formControlName","areaRestored","type","text","placeholder","Optional"],[1,"outplanting-header"],["formArrayName","individualsOutplanted",1,"species-list"],["class","species-row",4,"ngFor","ngForOf"],[1,"total-row"],[1,"total-value-section"],["class","last-value",4,"ngIf"],["readonly","",1,"total-input",3,"value"],[1,"growth-header"],["formArrayName","averageHeight",1,"species-list"],["slot","end"],[1,"mortality-header"],["formArrayName","mortality",1,"species-list"],[1,"reproduction-header"],["formArrayName","signsOfReproduction",1,"species-list"],[1,"value-section"],["formControlName","notes","rows","4","placeholder","Enter any observations about growth patterns, environmental conditions, or issues encountered"],["class","form-buttons",4,"ngIf"],["class","button-container",4,"ngIf"],["name","alert-circle",1,"status-icon","required"],["name","grid",1,"metadata-icon"],[1,"edit-location-link",3,"click"],[2,"padding","0 16px","font-size","0.75rem","color","#e76f51"],[1,"edit-mode-banner"],["expand","block","color","warning",3,"click"],["name","create-outline","slot","start"],[1,"edit-mode-banner","editing"],["name","create-outline"],[1,"status-card"],["lines","none"],["name","leaf-outline","slot","start",1,"toggle-icon"],[2,"min-width","70%","margin-right","15px"],[2,"width","100%"],[2,"margin-top","12px"],[2,"display","flex","flex-direction","column","align-items","center","flex-shrink","0","margin-right","15px"],[2,"font-size","0.8rem","margin-bottom","4px"],[1,"restoration-toggle",2,"--handle-border-radius","50%","--track-border-radius","15px","width","50px",3,"ngModelChange","ngModel","ngModelOptions"],["class","status-note warning",4,"ngIf"],[1,"status-note","warning"],["name","information-circle-outline"],[1,"gps-hint"],["name","location","size","small"],[1,"coordinates-text"],["name","pin","size","small"],[1,"gps-source-hint"],["name","information-circle","size","small"],[1,"species-row"],[1,"species-info"],["name","information-circle-outline","color","medium",1,"info-icon",3,"click"],[1,"tally-control"],["size","small","fill","clear",3,"click",4,"ngIf"],["type","number","min","0","class","tally-input","placeholder","0",3,"formControlName",4,"ngIf"],[1,"last-value"],[1,"last-label"],[1,"last-number"],["size","small","fill","clear",3,"click"],["name","remove"],["type","number","min","0","placeholder","0",1,"tally-input",3,"formControlName"],["name","add"],[1,"value-section","height-section"],["type","number","step","0.1","min","0","placeholder","0.0",1,"height-input-simple",3,"ionChange","formControl","readonly"],[3,"formGroupName"],[1,"value-section","reproduction-section"],["class","last-value reproduction-last",4,"ngIf"],[1,"reproduction-checkboxes"],[1,"checkbox-group"],["formControlName","flowers"],["formControlName","fruits"],[1,"last-value","reproduction-last"],[1,"last-reproduction"],[1,"form-buttons"],["expand","block","type","submit",1,"submit-button",3,"disabled"],["name","checkmark-circle","slot","start"],["expand","block","fill","outline","color","medium",1,"save-draft-button",3,"click"],["name","save-outline","slot","start"],["expand","block","fill","outline",1,"discard-button",3,"click"],["name","trash-outline","slot","start"],[1,"button-container"],["expand","block","color","danger",1,"delete-button",3,"click"]],template:function(n,o){if(1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-back-button",2),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"Outplanting Monitoring"),t.k0s()(),t.j41(6,"ion-toolbar",3)(7,"ion-text",4),t.EFF(8),t.DNE(9,$,2,1,"span",5),t.k0s()(),t.j41(10,"ion-toolbar",6)(11,"div",7)(12,"div",8),t.bIt("click",function(){return!o.viewMode&&o.editLocation()}),t.nrm(13,"ion-icon",9),t.j41(14,"span",10),t.EFF(15),t.k0s(),t.DNE(16,T,1,0,"ion-icon",11),t.k0s(),t.DNE(17,A,4,1,"div",12)(18,V,2,0,"span",13),t.k0s(),t.DNE(19,X,2,0,"ion-error",14),t.k0s(),t.j41(20,"ion-toolbar",3),t.nrm(21,"ion-progress-bar",15),t.j41(22,"ion-text",16),t.EFF(23),t.k0s()()(),t.j41(24,"ion-content")(25,"form",17),t.bIt("ngSubmit",function(){return o.onSubmit()}),t.DNE(26,Y,4,0,"div",18)(27,L,4,0,"div",19)(28,H,20,8,"ion-card",20),t.j41(29,"ion-card",21)(30,"ion-card-header",0)(31,"ion-card-title"),t.EFF(32,"GPS Coordinates"),t.k0s()(),t.j41(33,"ion-card-content")(34,"ion-item",22),t.bIt("click",function(){return!o.viewMode&&o.getGPSCoordinates()}),t.j41(35,"div",23),t.nrm(36,"ion-icon",24),t.k0s(),t.j41(37,"ion-label")(38,"h3",25),t.EFF(39),t.k0s(),t.DNE(40,q,3,0,"p",26)(41,Z,3,2,"p",27)(42,J,3,0,"p",28),t.k0s()()()(),t.j41(43,"ion-card")(44,"ion-card-header",0)(45,"ion-card-title"),t.EFF(46,"Site Information"),t.k0s()(),t.j41(47,"ion-card-content")(48,"ion-item")(49,"ion-label",29),t.EFF(50,"Total Area of Restoration Site (m\xb2)"),t.k0s(),t.nrm(51,"ion-input",30),t.k0s(),t.j41(52,"ion-item")(53,"ion-label",29),t.EFF(54,"Area Restored (m\xb2)"),t.k0s(),t.nrm(55,"ion-input",31),t.k0s()()(),t.j41(56,"ion-card")(57,"ion-card-header",32)(58,"ion-card-title"),t.EFF(59,"Outplanting"),t.k0s(),t.j41(60,"ion-card-subtitle"),t.EFF(61,"Number of Individuals Outplanted per Species"),t.k0s()(),t.j41(62,"ion-card-content")(63,"div",33),t.DNE(64,nt,17,7,"div",34),t.k0s(),t.j41(65,"ion-item",35)(66,"ion-label")(67,"strong"),t.EFF(68,"Total"),t.k0s()(),t.j41(69,"div",36),t.DNE(70,ot,5,1,"div",37),t.nrm(71,"ion-input",38),t.k0s()()()(),t.j41(72,"ion-card")(73,"ion-card-header",39)(74,"ion-card-title"),t.EFF(75,"Growth Monitoring"),t.k0s(),t.j41(76,"ion-card-subtitle"),t.EFF(77,"Average Height per Species (cm)"),t.k0s()(),t.j41(78,"ion-card-content")(79,"div",40),t.DNE(80,at,15,5,"div",34),t.k0s(),t.j41(81,"ion-item",35)(82,"ion-label")(83,"strong"),t.EFF(84,"Average Overall"),t.k0s()(),t.j41(85,"div",36),t.DNE(86,rt,5,1,"div",37),t.j41(87,"ion-input",38)(88,"span",41),t.EFF(89,"cm"),t.k0s()()()()()(),t.j41(90,"ion-card")(91,"ion-card-header",42)(92,"ion-card-title"),t.EFF(93,"Mortality per Batch"),t.k0s(),t.j41(94,"ion-card-subtitle"),t.EFF(95,"Number of Dead/Failed Individuals"),t.k0s()(),t.j41(96,"ion-card-content")(97,"div",43),t.DNE(98,ut,16,7,"div",34),t.k0s(),t.j41(99,"ion-item",35)(100,"ion-label")(101,"strong"),t.EFF(102,"Total"),t.k0s()(),t.j41(103,"div",36),t.DNE(104,pt,5,1,"div",37),t.nrm(105,"ion-input",38),t.k0s()()()(),t.j41(106,"ion-card")(107,"ion-card-header",44)(108,"ion-card-title"),t.EFF(109,"Signs of Reproduction"),t.k0s(),t.j41(110,"ion-card-subtitle"),t.EFF(111,"Check if flowers or fruits are present"),t.k0s()(),t.j41(112,"ion-card-content")(113,"div",45),t.DNE(114,ft,21,4,"div",34),t.k0s(),t.j41(115,"ion-item",35)(116,"ion-label")(117,"strong"),t.EFF(118,"Species with Reproduction"),t.k0s()(),t.j41(119,"div",46),t.DNE(120,_t,5,1,"div",37),t.nrm(121,"ion-input",38),t.k0s()()()(),t.j41(122,"ion-card")(123,"ion-card-header",0)(124,"ion-card-title"),t.EFF(125,"Additional Notes"),t.k0s()(),t.j41(126,"ion-card-content")(127,"ion-item")(128,"ion-label",29),t.EFF(129,"Observations"),t.k0s(),t.nrm(130,"ion-textarea",47),t.k0s()()(),t.DNE(131,ht,10,1,"div",48)(132,bt,4,0,"div",49),t.k0s()()),2&n){let a,s,l,d;t.R7$(8),t.SpI(" ",o.currentDateTime),t.R7$(),t.Y8G("ngIf",(o.viewMode||o.isEditMode)&&o.getEditedDateTime()),t.R7$(6),t.JRh((null==(a=o.outplantingForm.get("siteLocation"))?null:a.value)||"Add location"),t.R7$(),t.Y8G("ngIf",!(null!=(s=o.outplantingForm.get("siteLocation"))&&s.value||o.viewMode)),t.R7$(),t.Y8G("ngIf",(null==(l=o.outplantingForm.get("zoneNumber"))?null:l.value)&&o.locationHasZones()),t.R7$(),t.Y8G("ngIf",o.isEditMode&&o.currentUser&&o.currentUser.level>=4),t.R7$(),t.Y8G("ngIf",(null==(d=o.outplantingForm.get("siteLocation"))?null:d.hasError("required"))&&(null==(d=o.outplantingForm.get("siteLocation"))?null:d.touched)),t.R7$(2),t.Y8G("value",o.progress),t.R7$(2),t.SpI(" ",(100*o.progress).toFixed(0),"% Complete "),t.R7$(),t.AVh("view-mode",o.viewMode),t.R7$(),t.Y8G("formGroup",o.outplantingForm),t.R7$(),t.Y8G("ngIf",o.viewMode&&o.currentUser&&o.currentUser.level>=4),t.R7$(),t.Y8G("ngIf",o.isEditMode),t.R7$(),t.Y8G("ngIf",!o.viewMode),t.R7$(6),t.AVh("gps-captured",o.coordinates),t.Y8G("button",!o.viewMode),t.R7$(2),t.Y8G("color",o.coordinates?"success":"medium"),t.R7$(3),t.SpI(" ",o.coordinates?o.gpsFromLocation?"GPS Location from New Site":"GPS Location Captured":"Capture GPS Location"," "),t.R7$(),t.Y8G("ngIf",!o.coordinates),t.R7$(),t.Y8G("ngIf",o.coordinates),t.R7$(),t.Y8G("ngIf",o.coordinates&&o.gpsFromLocation),t.R7$(22),t.Y8G("ngForOf",o.mangroveSpecies),t.R7$(6),t.Y8G("ngIf",o.isUpdatingProject&&o.lastReportData),t.R7$(),t.Y8G("value",o.individualsOutplantedTotal),t.R7$(9),t.Y8G("ngForOf",o.mangroveSpecies),t.R7$(6),t.Y8G("ngIf",o.isUpdatingProject&&o.lastReportData),t.R7$(),t.Y8G("value",o.averageHeightOverall),t.R7$(11),t.Y8G("ngForOf",o.mangroveSpecies),t.R7$(6),t.Y8G("ngIf",o.isUpdatingProject&&o.lastReportData),t.R7$(),t.Y8G("value",o.mortalityTotal),t.R7$(9),t.Y8G("ngForOf",o.mangroveSpecies),t.R7$(6),t.Y8G("ngIf",o.isUpdatingProject&&o.lastReportData),t.R7$(),t.Y8G("value",o.reproductionCount),t.R7$(10),t.Y8G("ngIf",!o.viewMode),t.R7$(),t.Y8G("ngIf",o.viewMode&&(null==o.currentUser?null:o.currentUser.level)>=4)}},dependencies:[O.Sq,O.bT,h.qT,h.me,h.Q0,h.BC,h.cb,h.VZ,h.vS,h.l_,h.j4,h.JD,h.$R,h.v8,g.Jm,g.QW,g.b_,g.I9,g.ME,g.HW,g.tN,g.eY,g.W9,g.eU,g.iq,g.$w,g.uz,g.he,g.JI,g.FH,g.IO,g.nc,g.BC,g.BY,g.ai,g.hB,g.su,g.Gw,g.el,g.T6],styles:[".outplanting-green[_ngcontent-%COMP%]{--background: #52a676;color:#fff}.outplanting-green[_ngcontent-%COMP%]   ion-back-button[_ngcontent-%COMP%]{--color: white;transition:transform .2s}.outplanting-green[_ngcontent-%COMP%]   ion-back-button[_ngcontent-%COMP%]:hover{transform:translate(-4px)}.outplanting-green[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;text-align:center}.outplanting-green.compact-toolbar[_ngcontent-%COMP%]{--min-height: 28px;--padding-top: 5px;--padding-bottom: 5px}.edit-mode-banner[_ngcontent-%COMP%]{padding:.75rem 1rem;margin:.5rem;border-radius:.5rem}.edit-mode-banner[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: .5rem;font-weight:600}.edit-mode-banner.editing[_ngcontent-%COMP%]{background:#fff3cd;border:1px solid #ffc107;display:flex;align-items:center;gap:.5rem;color:#856404;font-weight:500}.edit-mode-banner.editing[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2rem}.date-time-text[_ngcontent-%COMP%]{display:block;text-align:center;color:#fffffff2;font-size:14px;padding:0;margin:3px 0;font-weight:400;letter-spacing:.3px;line-height:1.2}.metadata-toolbar[_ngcontent-%COMP%]{--min-height: 40px;--padding-top: 6px;--padding-bottom: 6px}.metadata-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:8px;padding:0 12px;flex-wrap:wrap}.metadata-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px;background:#ffffff26;border-radius:16px;padding:5px 10px;cursor:pointer;transition:all .2s ease;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2)}.metadata-item[_ngcontent-%COMP%]:active{transform:scale(.95);background:#ffffff40}.metadata-icon[_ngcontent-%COMP%]{font-size:14px;color:#ffffffe6;min-width:14px}.metadata-label[_ngcontent-%COMP%]{color:#fff;font-size:12px;font-weight:500;letter-spacing:.2px;white-space:nowrap;max-width:120px;overflow:hidden;text-overflow:ellipsis}.edit-location-link[_ngcontent-%COMP%]{color:#ffffffe6;font-size:11px;text-decoration:underline;cursor:pointer;margin-left:8px;padding:4px 8px}.edit-location-link[_ngcontent-%COMP%]:active{opacity:.7}.status-icon[_ngcontent-%COMP%]{font-size:14px;margin-left:2px}.status-icon.success[_ngcontent-%COMP%]{color:#52a676}.status-icon.required[_ngcontent-%COMP%]{color:#ffd93d;animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.6}}.progress-text[_ngcontent-%COMP%]{display:block;text-align:center;color:#fff;font-size:13px;padding:0;margin:0 0 4px;font-weight:400;line-height:1}ion-card[_ngcontent-%COMP%]{margin:16px;border-radius:12px;box-shadow:0 2px 8px #0000001a}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{border-radius:12px 12px 0 0;padding:16px}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:#fff}ion-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#fffffff2;font-size:.875rem;margin-top:4px}ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{background:#fff;padding:16px}.outplanting-header[_ngcontent-%COMP%]{--background: #D4A73C !important;--background-opacity: 1}.outplanting-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%], .outplanting-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#333}.growth-header[_ngcontent-%COMP%]{--background: #4fb3bf !important;--background-opacity: 1}.growth-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%], .growth-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#fff}.mortality-header[_ngcontent-%COMP%]{--background: #e76f51 !important;--background-opacity: 1}.mortality-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%], .mortality-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#333}.reproduction-header[_ngcontent-%COMP%]{--background: #4dbba7 !important;--background-opacity: 1}.reproduction-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%], .reproduction-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#333}.gps-card[_ngcontent-%COMP%]{margin:16px;border-radius:12px;box-shadow:0 2px 8px #0000001a;overflow:hidden}.gps-card[_ngcontent-%COMP%]   .gps-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;--background: #f8f9fa;--border-radius: 8px;margin:0;border-radius:8px;transition:all .2s ease}.gps-card[_ngcontent-%COMP%]   .gps-item[_ngcontent-%COMP%]:hover:not(.item-disabled){--background: #e9ecef;transform:translateY(-1px);box-shadow:0 4px 12px #0000001a}.gps-card[_ngcontent-%COMP%]   .gps-item.gps-captured[_ngcontent-%COMP%]{--background: #e8f5e9;border:1px solid #4caf50}.gps-card[_ngcontent-%COMP%]   .gps-item[_ngcontent-%COMP%]   .gps-icon-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%;background:#ffffffe6;margin:12px;box-shadow:0 2px 4px #0000001a}.gps-card[_ngcontent-%COMP%]   .gps-item[_ngcontent-%COMP%]   .gps-icon-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.gps-card[_ngcontent-%COMP%]   .gps-item[_ngcontent-%COMP%]   .gps-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#333;margin-bottom:4px}.gps-card[_ngcontent-%COMP%]   .gps-item[_ngcontent-%COMP%]   .gps-hint[_ngcontent-%COMP%]{display:flex;align-items:center;color:#666;font-size:.9rem}.gps-card[_ngcontent-%COMP%]   .gps-item[_ngcontent-%COMP%]   .gps-hint[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:6px;color:#999}.gps-card[_ngcontent-%COMP%]   .gps-item[_ngcontent-%COMP%]   .coordinates-text[_ngcontent-%COMP%]{display:flex;align-items:center;color:#52a676!important;font-weight:600;font-family:SF Mono,Monaco,Inconsolata,Roboto Mono,monospace;font-size:.9rem}.gps-card[_ngcontent-%COMP%]   .gps-item[_ngcontent-%COMP%]   .coordinates-text[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:6px;color:#52a676}.gps-card[_ngcontent-%COMP%]   .gps-item[_ngcontent-%COMP%]   .gps-source-hint[_ngcontent-%COMP%]{display:flex;align-items:center;color:#666;font-size:.8rem;font-style:italic;margin-top:4px}.gps-card[_ngcontent-%COMP%]   .gps-item[_ngcontent-%COMP%]   .gps-source-hint[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:6px;color:#999}.coordinates-text[_ngcontent-%COMP%]{color:#2e7d32!important;font-weight:600;font-family:SF Mono,Monaco,Inconsolata,Roboto Mono,monospace}.species-list[_ngcontent-%COMP%]{margin-top:8px}.species-row[_ngcontent-%COMP%]{margin-bottom:8px}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;--background: #f9f9f9;border-radius:8px;margin-bottom:8px}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .species-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;flex:1;min-width:170px}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .height-input-simple[_ngcontent-%COMP%]{--padding-start: 8px;--padding-end: 8px;text-align:center;max-width:140px;font-weight:500;margin-left:auto}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .height-input-simple.item-interactive[_ngcontent-%COMP%]{--background: #f5f5f5;--border-color: #ddd;--border-radius: 8px}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .height-input-simple[readonly][_ngcontent-%COMP%]{--background: transparent;pointer-events:none}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .input-with-buttons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .input-with-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 8px;--padding-end: 8px;--padding-top: 8px;--padding-bottom: 8px;--border-radius: 50%;width:36px;height:36px;--background: #e8f5e9;--color: #2e7d32}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .input-with-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2rem}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .input-with-buttons[_ngcontent-%COMP%]   .height-input[_ngcontent-%COMP%]{--padding-start: 8px;--padding-end: 8px;text-align:center;max-width:100px;font-weight:500}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .input-with-buttons[_ngcontent-%COMP%]   .height-input.item-interactive[_ngcontent-%COMP%]{--background: #f5f5f5;--border-color: #ddd;--border-radius: 8px}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .input-with-buttons[_ngcontent-%COMP%]   .height-input[readonly][_ngcontent-%COMP%]{--background: transparent;pointer-events:none}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .input-with-buttons[_ngcontent-%COMP%]   .height-input[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, .species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .input-with-buttons[_ngcontent-%COMP%]   .height-input[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .input-with-buttons[_ngcontent-%COMP%]   .height-input[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{appearance:textfield;-moz-appearance:textfield}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:600;color:#0d3d2f;margin:0 0 4px;font-size:.95rem}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7c7a;font-size:.8rem;font-style:italic;margin:0}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{font-size:1.3rem;flex-shrink:0;margin-right:10px;cursor:pointer}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]:hover{opacity:.7}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-checkbox[_ngcontent-%COMP%]{--size: 24px;--border-radius: 4px;--checkbox-background-checked: #4fb3bf;--border-color-checked: #4fb3bf;--checkmark-color: white}.reproduction-checkboxes[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}.reproduction-checkboxes[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.reproduction-checkboxes[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:.9rem;color:#0d3d2f;margin:0}.reproduction-checkboxes[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   ion-checkbox[_ngcontent-%COMP%]{--size: 24px;--border-radius: 4px;--checkbox-background-checked: #4fb3bf;--border-color-checked: #4fb3bf;--checkmark-color: white}.tally-control[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px}.tally-control[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 4px;--padding-end: 4px;min-width:32px;height:32px;margin:0}.tally-control[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.tally-control[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{min-width:30px;text-align:center;font-weight:600;font-size:.95rem}.tally-control[_ngcontent-%COMP%]   .placeholder-value[_ngcontent-%COMP%]{color:#999;font-weight:400}.tally-control[_ngcontent-%COMP%]   .tally-input[_ngcontent-%COMP%]{width:50px;text-align:center;font-weight:600;font-size:.95rem;border:1px solid #ccc;border-radius:4px;padding:4px;appearance:textfield}.tally-control[_ngcontent-%COMP%]   .tally-input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .tally-control[_ngcontent-%COMP%]   .tally-input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.total-row[_ngcontent-%COMP%]{background:#e8f5f0!important;border-top:2px solid #52a676;margin-top:12px;padding:8px 0;--background: #e8f5f0}.total-row[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#52a676;font-size:1rem}.total-input[_ngcontent-%COMP%]{--padding-start: 12px;--padding-end: 12px;max-width:120px;text-align:center;font-weight:700;color:#52a676;border:2px solid #52a676;border-radius:6px;background:#fff;margin-left:8px}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;margin-bottom:12px}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-bottom:8px}ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%], ion-item[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{--padding-start: 12px;--padding-end: 12px;border:1px solid #ddd;border-radius:8px;margin-top:4px}ion-item[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{--padding-top: 12px;--padding-bottom: 12px}.form-buttons[_ngcontent-%COMP%]{padding:0 16px;margin-top:24px;margin-bottom:32px}.form-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-bottom:12px}.form-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:last-child{margin-bottom:0}.form-buttons[_ngcontent-%COMP%]   ion-button.save-draft-button[_ngcontent-%COMP%]{margin:10px 0 12px}.form-buttons[_ngcontent-%COMP%]   .save-draft-button[_ngcontent-%COMP%]{--border-radius: 8px;height:48px;font-size:1rem;font-weight:500;--background: rgba(107, 124, 122, .1);--border-color: #6b7c7a;--color: #6b7c7a;--background-hover: rgba(107, 124, 122, .2);--background-activated: rgba(107, 124, 122, .3)}.form-buttons[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]{margin:0;--border-radius: 8px;height:48px;font-size:1.125rem;font-weight:600;--background: #52a676;--background-hover: #458d63;--background-activated: #458d63}.form-buttons[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]:disabled{opacity:.5}.form-buttons[_ngcontent-%COMP%]   .discard-button[_ngcontent-%COMP%]{--border-radius: 8px;height:48px;font-size:1rem;font-weight:500;--color: #e76f51;--border-color: #e76f51;--border-width: 2px;--background-hover: rgba(231, 111, 81, .1);--background-activated: rgba(231, 111, 81, .2);--ripple-color: rgba(231, 111, 81, .3)}.form-buttons[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{margin-top:20px;--background: #d32f2f;--background-hover: #b71c1c;--background-activated: #b71c1c;font-weight:600;height:48px;font-size:1rem}.submit-button[_ngcontent-%COMP%]{margin:24px 16px 32px;--border-radius: 8px;height:48px;font-size:1.125rem;font-weight:600;--background: #52a676;--background-hover: #458d63;--background-activated: #458d63}.submit-button[_ngcontent-%COMP%]:disabled{opacity:.5}ion-error[_ngcontent-%COMP%]{color:#e76f51!important;font-size:.75rem!important;margin-top:4px;padding-left:16px}ion-item.item-disabled[_ngcontent-%COMP%], ion-item.item-interactive-disabled[_ngcontent-%COMP%]{opacity:1!important;--opacity: 1 !important}ion-item.item-disabled[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], ion-item.item-interactive-disabled[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{opacity:1!important;color:#000!important}  .item-disabled,   .item-interactive-disabled{opacity:1!important}  .item-disabled ion-label,   .item-disabled .label-text,   .item-disabled .native-input,   .item-disabled .select-text,   .item-disabled .select-icon,   .item-interactive-disabled ion-label,   .item-interactive-disabled .label-text,   .item-interactive-disabled .native-input,   .item-interactive-disabled .select-text,   .item-interactive-disabled .select-icon{opacity:1!important;color:#000!important}  ion-select.select-disabled{opacity:1!important}  ion-select.select-disabled .select-text,   ion-select.select-disabled .select-icon,   ion-select.select-disabled .select-placeholder{opacity:1!important;color:#000!important}  ion-toggle.toggle-disabled{opacity:1!important}  ion-checkbox.checkbox-disabled{opacity:1!important}  ion-input.input-disabled,   ion-textarea.textarea-disabled{opacity:1!important}  ion-input.input-disabled .native-input,   ion-input.input-disabled .native-textarea,   ion-textarea.textarea-disabled .native-input,   ion-textarea.textarea-disabled .native-textarea{opacity:1!important;color:#000!important;-webkit-text-fill-color:#000!important}  ion-content.view-mode ion-checkbox{pointer-events:none!important;cursor:default!important}  ion-content.view-mode .reproduction-checkboxes{pointer-events:none!important}.status-card[_ngcontent-%COMP%]{margin:16px;box-shadow:0 2px 8px #2d865926}.status-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{padding-bottom:8px}.status-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{color:#2d8659;font-size:1.1rem;font-weight:600}.status-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#666;font-size:.875rem;margin-top:4px}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{color:#2d8659;font-size:1.5rem;margin-right:8px}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.938rem;font-weight:500;color:#333;margin:0 0 4px}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.813rem;color:#666;margin:0}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-toggle[_ngcontent-%COMP%]{--handle-width: 26px;--handle-height: 26px;--handle-border-radius: 50%;--track-border-radius: 15px}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .status-note[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;margin-top:12px;padding:8px 12px;background:#f0f9f4;border-radius:8px;font-size:.813rem;color:#2d8659}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .status-note.warning[_ngcontent-%COMP%]{background:#fff3e0;color:#e76f51}.status-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .status-note[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.1rem;flex-shrink:0}ion-toggle.restoration-toggle[_ngcontent-%COMP%]{--track-background: #e0e0e0;--track-background-checked: #e0e0e0;--handle-background: #ffffff;--handle-background-checked: #2d8659;--handle-border-radius: 50% !important;--track-border-radius: 15px !important}ion-toggle.restoration-toggle[_ngcontent-%COMP%]::part(handle){border-radius:50%!important}ion-toggle.restoration-toggle[_ngcontent-%COMP%]::part(track){border-radius:15px!important}.value-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.value-section.height-section[_ngcontent-%COMP%], .value-section.reproduction-section[_ngcontent-%COMP%]{gap:8px}.total-value-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.last-value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 8px;background:#0000000d;border-radius:6px;min-width:60px}.last-value[_ngcontent-%COMP%]   .last-label[_ngcontent-%COMP%]{font-size:.7rem;color:#888;font-weight:500}.last-value[_ngcontent-%COMP%]   .last-number[_ngcontent-%COMP%]{font-size:.85rem;color:#666;font-weight:600}.last-value[_ngcontent-%COMP%]   .last-reproduction[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.last-value.reproduction-last[_ngcontent-%COMP%]{min-width:auto}@media (max-width: 768px){.total-input[_ngcontent-%COMP%]{max-width:100px;font-size:.9rem}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.85rem}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.75rem}ion-card[_ngcontent-%COMP%]{margin:12px}.status-card[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{font-size:.8rem!important}.status-card[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.9rem!important}.status-card[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem!important}.status-card[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{color:#888;font-size:.7rem!important;font-style:italic;margin-top:12px}.value-section[_ngcontent-%COMP%]{gap:8px}.last-value[_ngcontent-%COMP%]{min-width:50px;padding:3px 6px}.last-value[_ngcontent-%COMP%]   .last-label[_ngcontent-%COMP%]{font-size:.65rem}.last-value[_ngcontent-%COMP%]   .last-number[_ngcontent-%COMP%]{font-size:.8rem}}@media (max-width: 480px){ion-card[_ngcontent-%COMP%]{margin:8px}ion-card-content[_ngcontent-%COMP%]{padding:12px 8px!important}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 4px;--inner-padding-end: 4px}.species-info[_ngcontent-%COMP%]{min-width:100px!important;gap:4px!important}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.8rem}.species-row[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.7rem}.info-icon[_ngcontent-%COMP%]{font-size:1rem!important}.tally-control[_ngcontent-%COMP%]{gap:4px}.tally-control[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{min-width:28px;height:28px}.tally-control[_ngcontent-%COMP%]   .tally-input[_ngcontent-%COMP%]{width:40px;padding:2px;font-size:.85rem}.height-input-simple[_ngcontent-%COMP%]{max-width:100px!important;font-size:.85rem}.value-section[_ngcontent-%COMP%]{gap:6px}.last-value[_ngcontent-%COMP%]{min-width:50px;padding:2px 4px}.last-value[_ngcontent-%COMP%]   .last-label[_ngcontent-%COMP%]{font-size:.6rem}.last-value[_ngcontent-%COMP%]   .last-number[_ngcontent-%COMP%]{font-size:.75rem}.total-row[_ngcontent-%COMP%]{--padding-end: 10px}.total-row[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:.9rem}.total-input[_ngcontent-%COMP%]{max-width:90px!important}.reproduction-section[_ngcontent-%COMP%]{flex-wrap:wrap;gap:4px}.reproduction-checkboxes[_ngcontent-%COMP%]{gap:8px}.reproduction-checkboxes[_ngcontent-%COMP%]   ion-checkbox[_ngcontent-%COMP%]{--size: 18px}.reproduction-checkboxes[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:.75rem}}"]}))}return i(),c})(),Ct=(()=>{var i;class c{constructor(e){this.modalController=e,this.currentIndex=0,this.rotatedImages=new Set(["assets/mangroves/Red mangrove1.webp","assets/mangroves/Red mangrove2.webp","assets/mangroves/White mangrove2.webp","assets/mangroves/Black mangrove.webp","assets/mangroves/Oriental mangrove1.webp","assets/mangroves/Oriental mangrove2.webp","assets/mangroves/Puzzlenut mangrove.webp","assets/mangroves/Yellow mangrove1.webp","assets/mangroves/Yellow mangrove2.webp","assets/mangroves/Apple mangrove.webp"])}isCurrentImageRotated(){return this.rotatedImages.has(this.getCurrentImage())}getImages(){return Array.isArray(this.species.imagePath)?this.species.imagePath:[this.species.imagePath]}getCurrentImage(){return this.getImages()[this.currentIndex]||""}next(){const e=this.getImages();this.currentIndex=(this.currentIndex+1)%e.length}previous(){const e=this.getImages();this.currentIndex=(this.currentIndex-1+e.length)%e.length}goTo(e){this.currentIndex=e}dismiss(){this.modalController.dismiss()}static#t=i=()=>(this.\u0275fac=function(n){return new(n||c)(t.rXU(g.W3))},this.\u0275cmp=t.VBU({type:c,selectors:[["mangrove-info-modal"]],decls:18,vars:8,consts:[["slot","end"],[3,"click"],["name","close","slot","icon-only"],[1,"ion-padding"],[1,"popover-content"],[1,"common-name"],[1,"latin-name"],[1,"slideshow-container"],[1,"image-wrapper"],["appPinchZoom","",1,"mangrove-image",3,"src","alt"],["class","slideshow-controls",4,"ngIf"],[1,"slideshow-controls"],[1,"nav-button",3,"click"],["name","chevron-back"],[1,"slideshow-indicators"],["class","indicator-dot",3,"active","click",4,"ngFor","ngForOf"],["name","chevron-forward"],[1,"indicator-dot",3,"click"]],template:function(n,o){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3),t.k0s(),t.j41(4,"ion-buttons",0)(5,"ion-button",1),t.bIt("click",function(){return o.dismiss()}),t.nrm(6,"ion-icon",2),t.k0s()()()(),t.j41(7,"ion-content",3)(8,"div",4)(9,"p",5),t.EFF(10),t.k0s(),t.j41(11,"p",6)(12,"em"),t.EFF(13),t.k0s()(),t.j41(14,"div",7)(15,"div",8),t.nrm(16,"img",9),t.k0s(),t.DNE(17,Ot,7,1,"div",10),t.k0s()()()),2&n&&(t.R7$(3),t.JRh(o.species.scientificName),t.R7$(7),t.JRh(o.species.commonName),t.R7$(3),t.JRh(o.species.latinName),t.R7$(2),t.AVh("rotated-wrapper",o.isCurrentImageRotated()),t.R7$(),t.Y8G("src",o.getCurrentImage(),t.B4B)("alt",o.species.scientificName),t.R7$(),t.Y8G("ngIf",o.getImages().length>1))},dependencies:[g.bv,g.Jm,g.QW,g.W9,g.eU,g.iq,g.BC,g.ai,O.MD,O.Sq,O.bT,S.h],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: #52a676;--color: white}ion-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600}ion-button[_ngcontent-%COMP%]{--color: white}ion-content[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;--padding-top: 0;--padding-bottom: 0}.popover-content[_ngcontent-%COMP%]{text-align:center;height:100%;display:flex;flex-direction:column;justify-content:flex-start;padding-top:20px;min-height:0;overflow:hidden}.common-name[_ngcontent-%COMP%]{margin:16px 16px 8px;font-size:16px;color:#666;font-weight:500}.latin-name[_ngcontent-%COMP%]{margin:0 16px 16px;font-size:14px;color:#888}.slideshow-container[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;min-height:0;overflow:hidden}.image-wrapper[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;min-height:0;width:100%;overflow:hidden;position:relative}.mangrove-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain;image-orientation:none}@media screen and (max-width: 768px){.image-wrapper.rotated-wrapper[_ngcontent-%COMP%]{transform:rotate(-90deg);width:auto;height:100%}.mangrove-image[_ngcontent-%COMP%]{touch-action:none;user-select:none;-webkit-user-select:none}}@media screen and (min-width: 769px){.mangrove-image[_ngcontent-%COMP%]{margin-top:-20px;transition:transform .2s ease,filter .2s ease}.mangrove-image[_ngcontent-%COMP%]:hover{transform:scale(1.02);filter:brightness(1.1)}.mangrove-image[_ngcontent-%COMP%]:active{transform:scale(.98)}.image-wrapper.rotated-wrapper[_ngcontent-%COMP%]   .mangrove-image[_ngcontent-%COMP%]{transform:rotate(-90deg);max-width:none;max-height:none;height:100%;width:auto;position:absolute;margin-top:0}.image-wrapper.rotated-wrapper[_ngcontent-%COMP%]   .mangrove-image[_ngcontent-%COMP%]:hover{transform:rotate(-90deg) scale(1.02)}.image-wrapper.rotated-wrapper[_ngcontent-%COMP%]   .mangrove-image[_ngcontent-%COMP%]:active{transform:rotate(-90deg) scale(.98)}}.slideshow-controls[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:16px;padding:8px 0}.nav-button[_ngcontent-%COMP%]{background:#52a67626;border:none;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease}.nav-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#52a676}.nav-button[_ngcontent-%COMP%]:hover{background:#52a67640}.nav-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.slideshow-indicators[_ngcontent-%COMP%]{display:flex;gap:8px}.indicator-dot[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;background:#52a67640;cursor:pointer;transition:all .3s ease}.indicator-dot.active[_ngcontent-%COMP%]{background:#52a676;transform:scale(1.3)}.indicator-dot[_ngcontent-%COMP%]:hover{background:#52a67680}"]}))}return i(),c})();const Mt=[{path:"",component:Pt}];let xt=(()=>{var i;class c{static#t=i=()=>(this.\u0275fac=function(n){return new(n||c)},this.\u0275mod=t.$C({type:c}),this.\u0275inj=u.G2t({imports:[x.iI.forChild(Mt),x.iI]}))}return i(),c})(),yt=(()=>{var i;class c{static#t=i=()=>(this.\u0275fac=function(n){return new(n||c)},this.\u0275mod=t.$C({type:c}),this.\u0275inj=u.G2t({imports:[O.MD,h.YN,h.X1,g.bv,xt]}))}return i(),c})()}}]);