"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[609],{609(R,h,s){s.d(h,{MonitoringLogPageModule:()=>w});var d=s(2200),g=s(4341),l=s(7343),f=s(8132),u=s(467),e=s(3664),v=s(5921),M=s(8863),C=s(3205);function b(n,i){if(1&n&&(e.j41(0,"ion-select-option",17),e.EFF(1),e.k0s()),2&n){const r=i.$implicit;e.Y8G("value",r.value),e.R7$(),e.JRh(r.label)}}function P(n,i){1&n&&(e.j41(0,"div",18),e.nrm(1,"ion-spinner",19),e.j41(2,"p"),e.EFF(3,"Loading log entries..."),e.k0s()())}function x(n,i){1&n&&(e.j41(0,"div",20),e.nrm(1,"ion-icon",21),e.j41(2,"p"),e.EFF(3,"No log entries found."),e.k0s()())}function y(n,i){if(1&n&&(e.j41(0,"ion-badge",40),e.EFF(1),e.nI1(2,"titlecase"),e.k0s()),2&n){const r=e.XpG().$implicit,t=e.XpG(2);e.xc7("background",t.getFormTypeColor(r.formType)),e.R7$(),e.SpI(" ",e.bMT(2,3,r.formType)," ")}}function F(n,i){1&n&&(e.j41(0,"span",41),e.EFF(1,"-"),e.k0s())}function O(n,i){if(1&n&&(e.j41(0,"small"),e.EFF(1),e.k0s()),2&n){const r=e.XpG(2).$implicit;e.R7$(),e.SpI("by ",r.submittedBy)}}function E(n,i){if(1&n&&(e.j41(0,"small"),e.EFF(1),e.k0s()),2&n){const r=e.XpG(2).$implicit;e.R7$(),e.SpI(" [",r.reportId,"]")}}function k(n,i){if(1&n&&(e.j41(0,"div",42),e.DNE(1,O,2,1,"small",16)(2,E,2,1,"small",16),e.k0s()),2&n){const r=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",r.submittedBy),e.R7$(),e.Y8G("ngIf",r.reportId)}}function L(n,i){if(1&n&&(e.j41(0,"tr",26)(1,"td",27)(2,"div",28),e.EFF(3),e.k0s(),e.j41(4,"div",29),e.EFF(5),e.k0s()(),e.j41(6,"td")(7,"ion-badge",30),e.EFF(8),e.k0s()(),e.j41(9,"td",31)(10,"span",32),e.EFF(11),e.k0s()(),e.j41(12,"td",33)(13,"span",34),e.EFF(14),e.k0s()(),e.j41(15,"td"),e.DNE(16,y,3,5,"ion-badge",35)(17,F,2,0,"span",36),e.k0s(),e.j41(18,"td",37)(19,"div",38),e.EFF(20),e.k0s(),e.DNE(21,k,3,2,"div",39),e.k0s()()),2&n){const r=i.$implicit,t=e.XpG(2);e.R7$(3),e.JRh(r.date),e.R7$(2),e.JRh(r.time),e.R7$(2),e.xc7("background",t.getEventColor(r.eventType)),e.R7$(),e.SpI(" ",t.getEventLabel(r.eventType)," "),e.R7$(3),e.JRh(r.username),e.R7$(3),e.JRh(r.device||"-"),e.R7$(2),e.Y8G("ngIf",r.formType),e.R7$(),e.Y8G("ngIf",!r.formType),e.R7$(3),e.JRh(r.details||"-"),e.R7$(),e.Y8G("ngIf",r.reportId||r.submittedBy)}}function T(n,i){if(1&n&&(e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e.nrm(3,"ion-icon",22),e.EFF(4," Activity Log "),e.k0s()(),e.j41(5,"ion-card-content")(6,"div",23)(7,"table",24)(8,"thead")(9,"tr")(10,"th"),e.EFF(11,"Date & Time"),e.k0s(),e.j41(12,"th"),e.EFF(13,"Event"),e.k0s(),e.j41(14,"th"),e.EFF(15,"User"),e.k0s(),e.j41(16,"th"),e.EFF(17,"Device"),e.k0s(),e.j41(18,"th"),e.EFF(19,"Form Type"),e.k0s(),e.j41(20,"th"),e.EFF(21,"Details"),e.k0s()()(),e.j41(22,"tbody"),e.DNE(23,L,22,11,"tr",25),e.k0s()()()()()),2&n){const r=e.XpG();e.R7$(23),e.Y8G("ngForOf",r.filteredEntries)}}let m=(()=>{var n;class i{constructor(t,a,o){this.router=t,this.monitoringLogService=a,this.auth=o,this.entries=[],this.filteredEntries=[],this.currentUser=null,this.isLoading=!0,this.selectedEventType="all",this.searchText="",this.eventTypes=[{value:"all",label:"All Events"},{value:"login",label:"Login"},{value:"logout",label:"Logout"},{value:"draft_saved",label:"Draft Saved"},{value:"form_submitted",label:"Form Submitted"},{value:"form_edited",label:"Form Edited"},{value:"form_deleted",label:"Form Deleted"},{value:"species_added",label:"Species Added"},{value:"site_added",label:"Site Added"},{value:"level_request",label:"Level Request"},{value:"user_registered",label:"User Registered"}]}ngOnInit(){var t=this;return(0,u.A)(function*(){t.currentUser=t.auth.getCurrentUser(),!t.currentUser||t.currentUser.level<4?t.router.navigate(["/home"]):yield t.loadEntries()})()}ionViewWillEnter(){var t=this;return(0,u.A)(function*(){yield t.loadEntries()})()}loadEntries(){var t=this;return(0,u.A)(function*(){t.isLoading=!0;const a=yield t.monitoringLogService.getAllEntries();t.entries=a,t.applyFilters(),t.isLoading=!1})()}applyFilters(){let t=[...this.entries];if("all"!==this.selectedEventType&&(t=t.filter(a=>a.eventType===this.selectedEventType)),this.searchText.trim()){const a=this.searchText.trim().toLowerCase();t=t.filter(o=>o.username.toLowerCase().includes(a)||o.device&&o.device.toLowerCase().includes(a)||o.formType&&o.formType.toLowerCase().includes(a)||o.reportId&&o.reportId.toLowerCase().includes(a)||o.details&&o.details.toLowerCase().includes(a)||o.submittedBy&&o.submittedBy.toLowerCase().includes(a))}this.filteredEntries=t}onFilterChange(){this.applyFilters()}getEventLabel(t){switch(t){case"login":return"Login";case"logout":return"Logout";case"draft_saved":return"Draft Saved";case"form_submitted":return"Submitted";case"form_edited":return"Edited";case"form_deleted":return"Deleted";case"species_added":return"Species Added";case"site_added":return"Site Added";case"level_request":return"Level Request";case"user_registered":return"Registered";default:return t}}getEventColor(t){switch(t){case"login":return"#2d8659";case"logout":return"#e76f51";case"draft_saved":return"#4fb3bf";case"form_submitted":return"#52a676";case"form_edited":return"#0d3d2f";case"form_deleted":return"#c44536";case"species_added":return"#3a8f9f";case"site_added":return"#8b6914";case"level_request":return"#7b5ea7";case"user_registered":return"#2980b9";default:return"#6b7c7a"}}getFormTypeColor(t){switch(t?.toLowerCase()){case"health":return"#2d8659";case"flora-fauna":return"#52a676";case"pollution":return"#e76f51";case"disturbances":return"#c44536";case"biomass":return"#0d3d2f";case"outplanting":return"#4fb3bf";case"restoration":return"#3a8f9f";default:return"#6b7c7a"}}goBack(){this.router.navigate(["/data-analysis"])}static#e=n=()=>(this.\u0275fac=function(a){return new(a||i)(e.rXU(v.Ix),e.rXU(M.u),e.rXU(C.N))},this.\u0275cmp=e.VBU({type:i,selectors:[["app-monitoring-log"]],decls:32,vars:8,consts:[[1,"monitoring-log-bg",3,"fullscreen"],[1,"page-header","deep-green-gradient"],[1,"header-content"],["name","chevron-back",1,"back-icon",3,"click"],["name","book-outline",1,"page-icon"],[1,"header-text"],["name","filter-outline"],[1,"filter-row"],["lines","none",1,"filter-item"],["position","stacked"],["interface","popover",3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["lines","none",1,"filter-item","search-item"],["placeholder","Username, device, form type...",3,"ngModelChange","ionInput","ngModel"],["class","loading-container",4,"ngIf"],["class","empty-state",4,"ngIf"],[4,"ngIf"],[3,"value"],[1,"loading-container"],["name","crescent","color","primary"],[1,"empty-state"],["name","document-text-outline"],["name","list-outline"],[1,"table-container"],[1,"activity-log-table"],["class","log-row",4,"ngFor","ngForOf"],[1,"log-row"],[1,"date-time-cell"],[1,"date-time"],[1,"time"],[1,"event-badge"],[1,"user-cell"],[1,"username"],[1,"device-cell"],[1,"device"],["class","form-badge",3,"background",4,"ngIf"],["class","no-data",4,"ngIf"],[1,"details-cell"],[1,"details-text"],["class","report-id",4,"ngIf"],[1,"form-badge"],[1,"no-data"],[1,"report-id"]],template:function(a,o){1&a&&(e.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"ion-icon",3),e.bIt("click",function(){return o.goBack()}),e.k0s(),e.nrm(4,"ion-icon",4),e.j41(5,"div",5)(6,"h1"),e.EFF(7,"Monitoring Log"),e.k0s(),e.j41(8,"p"),e.EFF(9,"Application activity & events"),e.k0s()()()(),e.j41(10,"ion-list")(11,"ion-card")(12,"ion-card-header")(13,"ion-card-title"),e.nrm(14,"ion-icon",6),e.EFF(15," Filters "),e.k0s(),e.j41(16,"ion-card-subtitle"),e.EFF(17),e.k0s()(),e.j41(18,"ion-card-content")(19,"div",7)(20,"ion-item",8)(21,"ion-label",9),e.EFF(22,"Event Type"),e.k0s(),e.j41(23,"ion-select",10),e.mxI("ngModelChange",function(c){return e.DH7(o.selectedEventType,c)||(o.selectedEventType=c),c}),e.bIt("ionChange",function(){return o.onFilterChange()}),e.DNE(24,b,2,2,"ion-select-option",11),e.k0s()(),e.j41(25,"ion-item",12)(26,"ion-label",9),e.EFF(27,"Search"),e.k0s(),e.j41(28,"ion-input",13),e.mxI("ngModelChange",function(c){return e.DH7(o.searchText,c)||(o.searchText=c),c}),e.bIt("ionInput",function(){return o.onFilterChange()}),e.k0s()()()()(),e.DNE(29,P,4,0,"div",14)(30,x,4,0,"div",15)(31,T,24,1,"ion-card",16),e.k0s()()),2&a&&(e.Y8G("fullscreen",!0),e.R7$(17),e.SpI(" ",o.filteredEntries.length," entries found "),e.R7$(6),e.R50("ngModel",o.selectedEventType),e.R7$(),e.Y8G("ngForOf",o.eventTypes),e.R7$(4),e.R50("ngModel",o.searchText),e.R7$(),e.Y8G("ngIf",o.isLoading),e.R7$(),e.Y8G("ngIf",!o.isLoading&&0===o.filteredEntries.length),e.R7$(),e.Y8G("ngIf",!o.isLoading&&o.filteredEntries.length>0))},dependencies:[d.MD,d.Sq,d.bT,g.YN,g.BC,g.vS,l.bv,l.In,l.b_,l.I9,l.ME,l.HW,l.tN,l.W9,l.iq,l.$w,l.uz,l.he,l.nf,l.Nm,l.Ip,l.w2,l.Je,l.Gw,d.PV],styles:[".monitoring-log-bg[_ngcontent-%COMP%]{--background: #ffffff}.page-header[_ngcontent-%COMP%]{position:relative;padding:1.5rem;box-shadow:0 2px 8px #2d865926;color:#fff}.page-header.deep-green-gradient[_ngcontent-%COMP%]{background:#2d8659}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.75rem;position:relative}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .back-icon[_ngcontent-%COMP%]{font-size:1.75rem;cursor:pointer;transition:transform .2s;position:absolute;left:0}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .back-icon[_ngcontent-%COMP%]:hover{transform:translate(-4px)}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-icon[_ngcontent-%COMP%]{font-size:2rem}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;margin:0 0 .25rem}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem;margin:0;opacity:.9}.filter-row[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap;align-items:flex-end}.filter-item[_ngcontent-%COMP%]{--background: #f5f5f5;--border-radius: 8px;--padding-start: 12px;--padding-end: 12px;border-radius:8px;min-width:180px}.search-item[_ngcontent-%COMP%]{flex:1;min-width:250px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:#6b7c7a}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;color:#6b7c7a}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem}.table-container[_ngcontent-%COMP%]{overflow-x:auto;margin-top:10px}.activity-log-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px;background-color:#fff}.activity-log-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:12px 8px;text-align:left;font-weight:500;color:#333;border-bottom:2px solid #ddd;position:sticky;top:0;z-index:1}.activity-log-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 8px;border-bottom:1px solid #eee;vertical-align:top}.log-row[_ngcontent-%COMP%]:hover{background-color:#2d86590d}.date-time-cell[_ngcontent-%COMP%]{min-width:120px}.date-time[_ngcontent-%COMP%]{font-weight:500;color:#333;font-size:13px}.time[_ngcontent-%COMP%]{font-size:12px;color:#666;margin-top:2px}.event-badge[_ngcontent-%COMP%], .form-badge[_ngcontent-%COMP%]{font-size:11px;padding:4px 8px;border-radius:12px;color:#fff!important;font-weight:500;white-space:nowrap}.user-cell[_ngcontent-%COMP%]   .username[_ngcontent-%COMP%]{font-weight:500;font-size:13px;color:#333}.device-cell[_ngcontent-%COMP%]{min-width:80px;font-size:12px}.device-cell[_ngcontent-%COMP%]   .device[_ngcontent-%COMP%]{color:#555;font-size:12px}.details-cell[_ngcontent-%COMP%]{max-width:400px;min-width:200px}.details-cell[_ngcontent-%COMP%]   .details-text[_ngcontent-%COMP%]{font-size:13px;color:#333;margin-bottom:4px}.details-cell[_ngcontent-%COMP%]   .report-id[_ngcontent-%COMP%]{color:#666;font-size:11px;line-height:1.3}.no-data[_ngcontent-%COMP%]{color:#999;font-size:12px}@media (max-width: 768px){.activity-log-table[_ngcontent-%COMP%]{font-size:12px}.activity-log-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .activity-log-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 4px}.date-time-cell[_ngcontent-%COMP%]{min-width:100px}.details-cell[_ngcontent-%COMP%]{max-width:200px}.event-badge[_ngcontent-%COMP%], .form-badge[_ngcontent-%COMP%]{font-size:10px;padding:3px 6px}}@media (max-width: 576px){.activity-log-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4), .activity-log-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4){display:none}}"]}))}return n(),i})();var _=s(2615);const I=[{path:"",component:m}];let j=(()=>{var n;class i{static#e=n=()=>(this.\u0275fac=function(a){return new(a||i)},this.\u0275mod=e.$C({type:i}),this.\u0275inj=_.G2t({imports:[f.iI.forChild(I),f.iI]}))}return n(),i})(),w=(()=>{var n;class i{static#e=n=()=>(this.\u0275fac=function(a){return new(a||i)},this.\u0275mod=e.$C({type:i}),this.\u0275inj=_.G2t({imports:[d.MD,g.YN,l.bv,j,m]}))}return n(),i})()}}]);